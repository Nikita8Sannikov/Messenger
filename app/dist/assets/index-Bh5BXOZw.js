const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BX44sMl1.js","assets/mui-Bi46B-k9.js","assets/react-BcHnD46_.js","assets/index-BEY2Fyze.js","assets/zustand-BO2IUQGW.js","assets/i18n-8a0heCt_.js","assets/router-Cnd752VD.js","assets/axios-t--hEgTQ.js","assets/socket-BLRFddlS.js","assets/ru-CwUHeTgb.js","assets/material-Bh5zWams.css","assets/lib-DXytiZKz.js"])))=>i.map(i=>d[i]);
import{h as mn,j as Yt,E as fn,c as _n,r as E,B as Fo,a as xs,A as pn,M as Ro,b as Ao,T as Mo,d as Lo,e as Do,f as xo,P as Uo,C as Po,g as gn,S as Zo,i as $o,k as qo,l as jo,I as Bo,m as zo,n as vn,o as Us,p as ze,G as Go,L as Vo,q as Wo,s as Ho,t as Ko,u as Qo,K as Yo,v as Jo,w as Xo,x as ei,y as yn,z as ti,_ as si,D as or,F as ri,H as ni,J as oi,N as ii,O as ai,Q as ci,U as li,V as di,W as ui,X as hi,Y as mi,Z as ps,$ as fi}from"./mui-Bi46B-k9.js";import{b as _i,g as pi}from"./react-BcHnD46_.js";import{c as dt}from"./zustand-BO2IUQGW.js";import{i as g,a as gi}from"./i18n-8a0heCt_.js";import{u as Re,a as vi,m as gs,b as Pe,R as Je,N as ir,c as ar,B as yi}from"./router-Cnd752VD.js";import{a as Si}from"./axios-t--hEgTQ.js";import{l as bi}from"./socket-BLRFddlS.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const u of h.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerPolicy&&(h.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?h.credentials="include":i.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(i){if(i.ep)return;i.ep=!0;const h=t(i);fetch(i.href,h)}})();var Ue=Yt.Fragment,l=function(e,t,n){return mn.call(t,"css")?Yt.jsx(fn,_n(e,t),n):Yt.jsx(e,t,n)},F=function(e,t,n){return mn.call(t,"css")?Yt.jsxs(fn,_n(e,t),n):Yt.jsxs(e,t,n)},Ei=_i();const Se=E.memo(E.forwardRef(function({children:e,id:t,className:n="",component:i="div",noValidate:h,onSubmit:u},a){return l(Fo,{id:t,ref:a,className:n,component:i,noValidate:h,onSubmit:u,children:e})}));function Ci({children:r}){return l(Se,{className:"main-content",children:r})}function Ii(){return l("svg",{width:"136",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l("g",{clipPath:"url(#new_logo_vk_with_text__a)",children:F("g",{clipPath:"url(#new_logo_vk_with_text__b)",children:[l("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M67 12.5c0 3.34-2.43 5.5-5.88 5.5-3.45 0-5.88-2.16-5.88-5.5S57.67 7 61.12 7C64.57 7 67 9.16 67 12.5Zm-9.22 0c0 2.07 1.35 3.5 3.34 3.5s3.34-1.43 3.34-3.5-1.35-3.45-3.34-3.45-3.34 1.38-3.34 3.45Zm-17.03-.21c.95-.44 1.56-1.18 1.56-2.33 0-1.73-1.58-2.96-3.87-2.96h-5.27v11h5.5c2.37 0 4.02-1.29 4.02-3.05 0-1.33-.87-2.32-1.94-2.66ZM35.6 9.01h2.83c.85 0 1.44.5 1.44 1.2s-.6 1.2-1.44 1.2h-2.83V9ZM38.67 16h-3.06V13.3h3.06c.96 0 1.59.55 1.59 1.36 0 .8-.63 1.33-1.59 1.33ZM51.84 18h3.19l-5.06-5.71L54.61 7h-2.9l-3.68 4.27h-.6V7H45v11h2.44v-4.38h.59l3.8 4.38ZM76.47 7v4.34h-4.93V7H69.1v11h2.43v-4.44h4.93V18h2.43V7h-2.43ZM86.9 18h-2.44V9.22h-3.8V7H90.7v2.22h-3.8V18Zm9.7-11c-2.14 0-4.02.89-4.57 2.8l2.24.37a2.38 2.38 0 0 1 2.2-1.25c1.33 0 2.12.9 2.22 2.33h-2.37c-3.23 0-4.84 1.42-4.84 3.45 0 2.05 1.59 3.3 3.83 3.3 1.8 0 3-.82 3.53-1.73l.5 1.73h1.8v-6.18c0-3.19-1.73-4.82-4.54-4.82Zm-.72 9.16c-1.19 0-1.95-.61-1.95-1.57 0-.84.62-1.43 2.48-1.43h2.3c0 1.8-1.14 3-2.83 3ZM113.73 18h-3.2l-3.8-4.38h-.6V18h-2.42V7h2.43v4.27h.59L110.4 7h2.9l-4.63 5.29 5.05 5.71Zm4.27 0h2.44V9.22h3.8V7H114.2v2.22h3.8V18Zm12.3-11c3.33 0 5.7 2.2 5.7 5.37 0 .3-.02.55-.04.79h-8.84c.23 1.69 1.46 2.83 3.32 2.83 1.29 0 2.3-.55 2.83-1.33l2.29.38c-.83 2.1-2.98 2.96-5.27 2.96-3.34 0-5.71-2.18-5.71-5.5s2.37-5.5 5.71-5.5Zm3.06 4.25A3.06 3.06 0 0 0 130.29 9a3 3 0 0 0-3.02 2.25h6.09Z",fill:"currentColor"}),l("path",{d:"M11.5 24h1c5.44 0 8.15 0 9.83-1.68C24 20.64 24 17.92 24 12.5v-1.02c0-5.4 0-8.12-1.67-9.8C20.65 0 17.93 0 12.5 0h-1C6.06 0 3.35 0 1.67 1.68 0 3.36 0 6.08 0 11.5v1.02c0 5.4 0 8.12 1.68 9.8C3.36 24 6.08 24 11.5 24Z",fill:"#07F"}),l("path",{d:"M12.77 17.29c-5.47 0-8.59-3.75-8.72-9.99h2.74c.09 4.58 2.11 6.52 3.71 6.92V7.3h2.58v3.95c1.58-.17 3.24-1.97 3.8-3.95h2.58a7.62 7.62 0 0 1-3.51 4.98 7.9 7.9 0 0 1 4.11 5.01h-2.84a4.94 4.94 0 0 0-4.14-3.57v3.57h-.31Z",fill:"#fff"})]})})})}var Y=(r=>(r.notExists="*",r.main="/",r.profile="/profile",r.profileUser="/profile/:userId?",r.edit="/edit",r.messages="/messages",r.friends="/friends",r.friendsUser="/friends/:userId?",r.photos="/photos",r.photosUser="/photos/:userId?",r.calls="/calls",r.signUp="/sign-up",r.signIn="/sign-in",r.resetPassword="/reset-password",r.error="/error",r.help="/help",r.aboutUs="/about-us",r))(Y||{}),Rs=(r=>(r[r.MAIN=0]="MAIN",r[r.CONTACTS=1]="CONTACTS",r))(Rs||{}),Kt=(r=>(r.ERR_NETWORK="ERR_NETWORK",r.ERR_TIMEOUT="ERR_TIMEOUT",r.ERR_BAD_REQUEST="ERR_BAD_REQUEST",r.ERR_CANCELED="ERR_CANCELED",r))(Kt||{}),rt=(r=>(r.DEBUG="",r.INFO="INFO",r.WARN="WARN",r.ERROR="ERROR",r))(rt||{});const cr={redirectTo:Y.signIn,onlineUsers:new Map},lt=dt(r=>({...cr,redirectTo:null,setRedirectTo:e=>r({redirectTo:e}),addOnlineUsers:e=>r(t=>{const n=new Map(t.onlineUsers);return n.set(e.id,e),{onlineUsers:n}}),setOnlineUsers:e=>r(()=>{const t=new Map;return e.forEach(n=>t.set(n.id,n)),{onlineUsers:t}}),deleteOnlineUser:e=>r(t=>{const n=new Map(t.onlineUsers);return n.delete(e),{onlineUsers:n}}),reset:()=>r({...cr})})),Ti={vertical:"bottom",horizontal:"right"},Ni=E.memo(function({userId:e,children:t,className:n="",...i}){const h=lt(u=>u.onlineUsers.has(e));return l(xs,{...i,className:`avatar-badge ${h?"avatar-badge__active":""} ${n}`,overlap:"circular",anchorOrigin:Ti,variant:"dot",children:t})});var ft={},fe={},lr;function ki(){if(lr)return fe;lr=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.FileVarieties=fe.MessageReadStatus=fe.MessageTypes=fe.FriendsTab=fe.SocketActions=fe.HTTPErrorTypes=fe.HTTPStatuses=fe.ApiRoutes=void 0;var r;(function(o){o.checkHealth="/check-health",o.soundNotifications="/sound-notifications",o.deleteAccount="/delete-account",o.signUp="/sign-up",o.signIn="/sign-in",o.logout="/logout",o.getMe="/get-me",o.getUser="/get-user",o.editInfo="/edit-info",o.uploadAvatar="/upload-avatar",o.changeAvatar="/change-avatar",o.getPhotos="/get-photos",o.savePhotos="/save-photos",o.deletePhoto="/delete-photo",o.saveFiles="/save-files",o.openFile="/open-file",o.downloadFile="/download-file",o.deleteFiles="/delete-files",o.getAllCounts="/get-all-counts",o.getMyFriends="/get-my-friends",o.checkOnlineUser="/check-online-user",o.getFollowers="/get-followers",o.getBlockedFriends="/get-blocked-friends",o.getCommonFriends="/get-common-friends",o.getFriendInfo="/get-friend-info",o.getPossibleFriends="/get-possible-friends",o.followFriend="/follow-friend",o.getIncomingRequests="/get-incoming-requests",o.getOutgoingRequests="/get-outgoing-requests",o.unfollow="/unfollow",o.addFriend="/add-friend",o.leftInFollowers="/left-in-followers",o.acceptFriendRequest="/accept-friend-request",o.deleteFriend="/delete-friend",o.getFriendsNotification="/get-friends-notification",o.blockFriend="/block-friend",o.unblockFriend="/unblock-friend",o.checkBlockStatus="/check-block-status",o.getDialogs="/get-dialogs",o.deleteChat="/delete-chat",o.getMessages="/get-messages",o.saveMessage="/save-message",o.updateMessage="/update-message",o.deleteMessage="/delete-message",o.readMessage="/read-message",o.getChatId="/get-chat-id",o.getMessageNotification="/get-message-notification",o.getChatInfo="/get-chat-info",o.getUsersInChat="/get-users-in-chat",o.getLastSeen="/get-last-seen",o.getChatSoundStatus="/get-chat-sound-status",o.setChatSoundStatus="/set-chat-sound-status"})(r||(fe.ApiRoutes=r={}));var e;(function(o){o[o.OK=200]="OK",o[o.Created=201]="Created",o[o.NoContent=204]="NoContent",o[o.PermanentRedirect=308]="PermanentRedirect",o[o.BadRequest=400]="BadRequest",o[o.Unauthorized=401]="Unauthorized",o[o.Forbidden=403]="Forbidden",o[o.NotFound=404]="NotFound",o[o.Conflict=409]="Conflict",o[o.PayloadTooLarge=413]="PayloadTooLarge",o[o.TooManyRequests=429]="TooManyRequests",o[o.ServerError=500]="ServerError",o[o.ServiceUnavailable=503]="ServiceUnavailable"})(e||(fe.HTTPStatuses=e={}));var t;(function(o){o[o.SIGN_UP=1]="SIGN_UP",o[o.SIGN_IN=2]="SIGN_IN",o[o.EDIT_INFO=3]="EDIT_INFO"})(t||(fe.HTTPErrorTypes=t={}));var n;(function(o){o.GET_ALL_USERS="GET_ALL_USERS",o.GET_NEW_USER="GET_NEW_USER",o.USER_DISCONNECT="USER_DISCONNECT",o.LOG_OUT="LOG_OUT",o.ACCEPT_FRIEND="ACCEPT_FRIEND",o.FOLLOW_FRIEND="FOLLOW_FRIEND",o.ADD_OUTGOING_REQUEST="ADD_OUTGOING_REQUEST",o.UNFOLLOW_FRIEND="UNFOLLOW_FRIEND",o.REMOVE_OUTGOING_REQUEST="REMOVE_OUTGOING_REQUEST",o.ADD_TO_FRIEND="ADD_TO_FRIEND",o.REMOVE_FOLLOWER="REMOVE_FOLLOWER",o.ADD_FRIEND_REQUEST="ADD_FRIEND_REQUEST",o.REMOVE_FRIEND_REQUEST="REMOVE_FRIEND_REQUEST",o.REJECT_FRIEND_REQUEST="REJECT_FRIEND_REQUEST",o.ADD_TO_FOLLOWER="ADD_TO_FOLLOWER",o.DELETE_FRIEND="DELETE_FRIEND",o.DELETING_FRIEND="DELETING_FRIEND",o.BLOCK_FRIEND="BLOCK_FRIEND",o.BLOCKING_FRIEND="BLOCKING_FRIEND",o.UNBLOCK_FRIEND="UNBLOCK_FRIEND",o.UNBLOCKING_FRIEND="UNBLOCKING_FRIEND",o.MESSAGE="MESSAGE",o.SEND_MESSAGE="SEND_MESSAGE",o.EDIT_MESSAGE="EDIT_MESSAGE",o.SET_TEMP_CHAT="SET_TEMP_CHAT",o.GET_NEW_MESSAGE_ON_SERVER="GET_NEW_MESSAGE_ON_SERVER",o.ADD_NEW_MESSAGE="ADD_NEW_MESSAGE",o.NOTIFY_WRITE="NOTIFY_WRITE",o.CHANGE_READ_STATUS="CHANGE_READ_STATUS",o.ACCEPT_CHANGE_READ_STATUS="ACCEPT_CHANGE_READ_STATUS",o.DELETE_MESSAGE="DELETE_MESSAGE",o.DELETE_CHAT="DELETE_CHAT",o.SOCKET_CHANNEL_ERROR="SOCKET_CHANNEL_ERROR"})(n||(fe.SocketActions=n={}));var i;(function(o){o[o.ALL=0]="ALL",o[o.MY=1]="MY",o[o.ONLINE=2]="ONLINE",o[o.FOLLOWERS=3]="FOLLOWERS",o[o.OUTGOING_REQUESTS=4]="OUTGOING_REQUESTS",o[o.INCOMING_REQUESTS=5]="INCOMING_REQUESTS",o[o.SEARCH=6]="SEARCH",o[o.BLOCKED=7]="BLOCKED",o[o.COMMON=8]="COMMON"})(i||(fe.FriendsTab=i={}));var h;(function(o){o[o.MESSAGE=1]="MESSAGE",o[o.WITH_FILE=2]="WITH_FILE",o[o.VOICE=3]="VOICE",o[o.CALL=4]="CALL",o[o.FEW_FILES=5]="FEW_FILES"})(h||(fe.MessageTypes=h={}));var u;(function(o){o[o.NOT_READ=0]="NOT_READ",o[o.READ=1]="READ"})(u||(fe.MessageReadStatus=u={}));var a;return function(o){o.IMAGES="IMAGES",o.FILES="FILES"}(a||(fe.FileVarieties=a={})),fe}var vs={},dr;function wi(){return dr||(dr=1,Object.defineProperty(vs,"__esModule",{value:!0})),vs}var ur;function Oi(){return ur||(ur=1,function(r){var e=ft&&ft.__createBinding||(Object.create?function(n,i,h,u){u===void 0&&(u=h);var a=Object.getOwnPropertyDescriptor(i,h);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[h]}}),Object.defineProperty(n,u,a)}:function(n,i,h,u){u===void 0&&(u=h),n[u]=i[h]}),t=ft&&ft.__exportStar||function(n,i){for(var h in n)h!=="default"&&!Object.prototype.hasOwnProperty.call(i,h)&&e(i,n,h)};Object.defineProperty(r,"__esModule",{value:!0}),t(ki(),r),t(wi(),r)}(ft)),ft}var p=Oi();const Fi={"sign-in.sign_in":"Sign In","sign-in.login":"Email or phone","sign-in.password":"Password","sign-in.remember_me":"Remember me","sign-in.enter":"Enter","sign-in.forgot_password":"Forgot your password?","sign-in.register":"No account? Register!","sign-in.error.incorrect_login_or_password":"The username or password is incorrect.","sign-up.sign_up":"Sign Up","sign-up.enter":"Do you already have an account? Sign in","sign-up.back":"Back","sign-up.further":"Further","sign-up.register":"Register","sign-up.main_step":"Main data","sign-up.choose_avatar_step":"Choose avatar","sign-up.error.step_unknowed":"An error occurred when generating the content for the step {{step}}.","images-carousel-module.you":"You","images-carousel-module.further":"Further","images-carousel-module.back":"Back","profile-module.friends":"Friends","profile-module.friends_online":"Online friends","profile-module.no_online_friends":"At the moment, the list of online friends is empty.","profile-module.no_friends":"The friends list is empty at the moment.","profile-module.change":"Change","profile-module.edit":"Edit","profile-module.birthday":"Birthday","profile-module.city":"City","profile-module.work":"Place of work","profile-module.friends_count_0":"friend","profile-module.friends_count_1":"friends","profile-module.friends_count_2":"friends","profile-module.subscribers_count_0":"subscriber","profile-module.subscribers_count_1":"subscribers","profile-module.subscribers_count_2":"subscribers","profile-module.photos_count_0":"photo","profile-module.photos_count_1":"photos","profile-module.photos_count_2":"photos","profile-module.audios_count_0":"audio","profile-module.audios_count_1":"audios","profile-module.audios_count_2":"audios","profile-module.videos_count_0":"video","profile-module.videos_count_1":"videos","profile-module.videos_count_2":"videos","profile-module.not_complete":"Not complete","profile-module.my_photos":"My photos ","profile-module.photos":"Photos","profile-module.watch_all":"Watch all","profile-module.no_photos":"No photos","profile-module.add_more":"Add more","profile-module.how_like_avatar":"how about an avatar like this?","profile-module.choose_another_photo":"Choose another photo","sign-up-module.password_incorrect":"The passwords you entered don't match","sign-up-module.short_password":"The field must be at least 3 characters long.","sign-up-module.incorrect_email":"Incorrect email format (example: test01@gmail.com )","sign-up-module.phone_length":"The phone number must be {{length}} characters long.","sign-up-module.name":"Name","sign-up-module.surName":"Surname","sign-up-module.email":"Email","sign-up-module.phone":"Phone","sign-up-module.search":"Search","sign-up-module.no_coincidences":"There are no coincidences","sign-up-module.phone_number":"Phone * ","sign-up-module.password":"Password","sign-up-module.repeat_password":"Repeat the password","photos-module.empty":"There are no photos yet.","photos-module.add_more":"Add photos","core.profiles-controller.error.profile_exists":"Profile with id: {{id}} already exists.","core.profiles-controller.error.profile_not_exists":"Profile with id: {{id}} not exists.","core.profiles-controller.error.my_profile_not_exists":"My profile not exists.","core.socket.error.user_not_exists":"User not exists.","core.socket.error.connect_error":"The socket connection error [isSocketActive={{isSocketActive}}]: {{message}}.","core.socket.error.reconnect_failed":"Couldn't reconnect to the server.","core.socket.error.emit":"Error when processing an event on the server [type: {{type}}]: {{message}}.","core.socket.error.emit_event_on_the_server":"[{{timestamp}}] | An error occurred on the server when processing this event: {{message}}.","core.request.unknown_status":"Unknown request status: {{status}}.","core.catch-errors.error":"Error.","core.catch-errors.error.network":"Error when receiving a response from the server. The server is most likely unavailable at the moment. Check your internet connection.","core.catch-errors.error.timeout":"There are problems with the database or the response time has exceeded 15 seconds.","core.catch-errors.error.bad_request":"The error occurred when trying to make a request to the server. The server is most likely unavailable at the moment. Check your internet connection.","core.catch-errors.error.canceled":"The request has been cancelled.","core.catch-errors.error.unknown":"Unknown error.","core.socket.connection_established":"The socket connection to the server is established [socket.id={{socketId}}].","core.socket.connection_successfully_recovered":"The socket connection to the server has been successfully recovered [socket.id={{socketId}}].","core.socket.online_users":"Online users: ","core.socket.new_user_connected":"New user connected: ","core.socket.user_disconnected":"User disconnected: ","core.socket.emit_handled":"The event has been processed on the server [type={{type}}, timestamp={{timestamp}}].","header.settings":"Settings","header.help":"Help","header.logout":"Log out","menu.profile":"My profile","menu.messanger":"Messanger","menu.friends":"Friends","menu.photos":"Photos","menu.to-developers":"To developers","modals.save":"Save","modals.cancel":"Cancel","modals.copy_successfull":"The text has been successfully copied to the clipboard!","modals.copy_the_message_and_send_to_email":"Please copy the error text and email it to the developers: {{email}}.","modals.download":"Download the log file","modals.reset_page":"Reset page","modals.settings":"App settings","modals.soundEnabled":"All sound notifications","modals.messageSound":"Sound notifications when receiving a message","modals.friendRequestSound":"Sound notifucations when receiving a friend's request","modals.delete-account-title":"Deleting your profile.","modals.delete-account-text":"Please note that deleting your profile will delete all your data from the database. You can create a new profile at any time, but all the data that has been deleted will be lost.","modals.delete-account":"Delete profile","modals.error.copy":"Error when copying text to clipboard: ","modals.error.server":"Oops! An error occurred in the server operation.","ui.copyright":"Copyright ©","ui.product_name":" VK-CLON ","ui.sure_delete_photo":"Do you really want to delete this photo?","ui.sure_delete_account":"Do you really want to delete your account?","ui.delete":"Delete","utils.required_field":"Required field","utils.not_correct_format":"Incorrect format","utils.byte":"byte","utils.months.jan":"jan","utils.months.feb":"feb","utils.months.mar":"mar","utils.months.apr":"apr","utils.months.may":"may","utils.months.june":"june","utils.months.july":"july","utils.months.aug":"aug","utils.months.sep":"sep","utils.months.oct":"oct","utils.months.nov":"nov","utils.months.dec":"dec","utils.months.january":"january","utils.months.february":"february","utils.months.march":"march","utils.months.april":"april","utils.months.august":"august","utils.months.september":"september","utils.months.october":"october","utils.months.november":"november","utils.months.december":"december","utils.yesterday":"yesterday ","edit.main":"Main","edit.contacts":"Contacts","edit.changes_save":"Changes saved","edit.show_data":"new data will be shown on your page.","edit.save":"Save","edit_tabs.name":"Name","edit_tabs.surname":"Surname","edit_tabs.sex":"Sex","edit_tabs.select_sex.label_not_specified":"Not specified","edit_tabs.select_sex.label_male":"Male","edit_tabs.select_sex.label_female":"Female","edit_tabs.work":"Work","edit_tabs.birthday":"Birthday","edit_tabs.birthday_date":"Enter date","edit_tabs.city":"City","edit_tabs.phone":"Mobile phone","edit_tabs.email":"Email","friends-module.error.unknown_tab":"Unknown tab type: {{tab}}.","friends-module.all_friends":"All Friends","friends-module.friend_requests":"Friend Requests","friends-module.outgoing_requests":"Outgoing Requests","friends-module.search":"Search","friends-module.possible_friends":"Suggested Friends","friends-module.add_to_friends":"Add to Friends","friends-module.no_other_users":"There are no other users in the system at the moment.","friends-module.my_friends":"My Friends","friends-module.online_friends":"Online Friends","friends-module.followers":"Followers","friends-module.blocked":"Blocked","friends-module.common_friends":"Common Friends","friends-module.search_placeholder":"Search","friends-module.actions.remove_friend":"Remove from Friends","friends-module.actions.block":"Block","friends-module.actions.write_message":"Write message","friends-module.actions.add_friend":"Add to friends","friends-module.actions.accept":"Accept","friends-module.actions.decline":"Decline","friends-module.actions.unfollow":"Unfollow","friends-module.actions.unblock":"Unblock","friends-module.actions.find_friends":"Find friends","friends-module.empty.my_friends":"The friends list is empty at the moment.","friends-module.empty.online_friends":"The online friends list is empty at the moment.","friends-module.empty.followers":"The followers list is empty at the moment.","friends-module.empty.blocked":"The blocked users list is empty at the moment.","friends-module.empty.outgoing_requests":"There are no outgoing friend requests at the moment.","friends-module.empty.incoming_requests":"There are no incoming friend requests at the moment.","friends-module.empty.possible_friends":"The suggested friends list is empty at the moment.","friends-module.empty.common_friends":"The common friends list is empty at the moment."},Ri={"sign-in.sign_in":"Вход","sign-in.login":"Почта или телефон","sign-in.password":"Пароль","sign-in.remember_me":"Запомнить меня","sign-in.enter":"Войти","sign-in.forgot_password":"Забыли пароль?","sign-in.register":"Нет аккаунта? Зарегистрируйтесь!","sign-in.error.incorrect_login_or_password":"Не верно указан логин или пароль.","sign-up.sign_up":"Регистрация","sign-up.enter":"Уже есть аккаунт? Войдите","sign-up.back":"Назад","sign-up.further":"Далее","sign-up.register":"Зарегистрироваться","sign-up.main_step":"Основные данные","sign-up.choose_avatar_step":"Выбор аватара","sign-up.error.step_unknowed":"Возникла ошибка при генерации контента для шага {{step}}.","images-carousel-module.you":"Вы","images-carousel-module.further":"Далее","images-carousel-module.back":"Назад","profile-module.friends":"Друзья","profile-module.friends_online":"Друзья онлайн","profile-module.no_online_friends":"На данный момент список онлайн друзей пуст.","profile-module.no_friends":"На данный момент список друзей пуст.","profile-module.change":"Изменить","profile-module.edit":"Редактировать","profile-module.birthday":"День рождения","profile-module.city":"Город","profile-module.work":"Место работы","profile-module.friends_count_0":"друг","profile-module.friends_count_1":"друга","profile-module.friends_count_2":"друзей","profile-module.subscribers_count_0":"подписчик","profile-module.subscribers_count_1":"подписчика","profile-module.subscribers_count_2":"подписчиков","profile-module.photos_count_0":"фотография","profile-module.photos_count_1":"фотографии","profile-module.photos_count_2":"фотографий","profile-module.audios_count_0":"аудиозапись","profile-module.audios_count_1":"аудиозаписи","profile-module.audios_count_2":"аудиозаписей","profile-module.videos_count_0":"видеозапись","profile-module.videos_count_1":"видеозаписи","profile-module.videos_count_2":"видеозаписей","profile-module.not_complete":"Не заполнено","profile-module.my_photos":"Мои фотографии ","profile-module.photos":"Фотографии","profile-module.watch_all":"Посмотреть все","profile-module.no_photos":"Нет фотографий","profile-module.add_more":"Добавить еще","profile-module.how_like_avatar":"как на счет такого аватара?","profile-module.choose_another_photo":"Выбрать другое фото","sign-up-module.password_incorrect":"Введенные пароли не совпадают","sign-up-module.short_password":"Длина поля должна быть не менее 3 символов","sign-up-module.incorrect_email":"Не верный формат электронной почты (пример: test01@gmail.com)","sign-up-module.phone_length":"Длина номера телефона должна быть {{length}} символов","sign-up-module.name":"Имя","sign-up-module.surName":"Фамилия","sign-up-module.email":"Электронная почта","sign-up-module.phone":"Телефон","sign-up-module.search":"Поиск","sign-up-module.no_coincidences":"Совпадений нет","sign-up-module.phone_number":"Телефон * ","sign-up-module.password":"Пароль","sign-up-module.repeat_password":"Повторите пароль","photos-module.empty":"Фотографий пока нет.","photos-module.add_more":"Добавить фотографии","core.profiles-controller.error.profile_exists":"Профиль с id: {{id}} уже существует.","core.profiles-controller.error.profile_not_exists":"Профиля с id: {{id}} не существует.","core.profiles-controller.error.my_profile_not_exists":"Мой профиль не существует.","core.socket.error.user_not_exists":"Объект пользователя не существует.","core.socket.error.connect_error":"Ошибка сокет-соединения [isSocketActive={{isSocketActive}}]: {{message}}.","core.socket.error.reconnect_failed":"Не удалось переподключиться к серверу.","core.socket.error.emit":"Ошибка при обработке события на сервере [type: {{type}}]: {{message}}.","core.socket.error.emit_event_on_the_server":"[{{timestamp}}] | При обработке данного события на сервере возникла ошибка: {{message}}.","core.request.unknown_status":"Неизвестный статус запроса: {{status}}.","core.catch-errors.error":"Ошибка","core.catch-errors.error.network":"Ошибка при получении ответа от сервера. Скорее всего сервер недоступен в данный момент. Проверьте интернет соединение.","core.catch-errors.error.timeout":"Возникли проблемы с базой данных или время ожидания ответа превысило 15 секунд.","core.catch-errors.error.bad_request":"Ошибка возникла при попытке дать запрос к серверу. Скорее всего сервер недоступен в данный момент. Проверьте интернет соединение.","core.catch-errors.error.canceled":"Запрос был отменен.","core.catch-errors.error.unknown":"Неизвестная ошибка.","core.socket.connection_established":"Сокет-соединение с сервером установлено [socket.id={{socketId}}].","core.socket.connection_successfully_recovered":"Сокет-соединение с сервером успешно восстановлено [socket.id={{socketId}}].","core.socket.online_users":"Пользователи онлайн: ","core.socket.new_user_connected":"Новый пользователь подключился: ","core.socket.user_disconnected":"Пользователь отключился: ","core.socket.emit_handled":"Событие обработано на сервере [type={{type}}, timestamp={{timestamp}}].","header.settings":"Настройки","header.help":"Помощь","header.logout":"Выйти","menu.profile":"Моя страница","menu.messanger":"Мессенджер","menu.friends":"Друзья","menu.photos":"Фотографии","menu.to-developers":"Разработчикам","modals.save":"Сохранить","modals.cancel":"Отмена","modals.copy_successfull":"Текст успешно скопирован в буфер обмена!","modals.copy_the_message_and_send_to_email":"Пожалуйста, скопируйте текст ошибки и отправьте её на почту разработчикам: {{email}}.","modals.download":"Скачать лог файл","modals.reset_page":"Обновить страницу","modals.settings":"Настройки приложения","modals.soundEnabled":"Все звуковые уведомления","modals.messageSound":"Звуковые уведомления при получении сообщений","modals.friendRequestSound":"Звуковые уведомления при получении заявок в друзья","modals.delete-account-title":"Удаление своего профиля.","modals.delete-account-text":"Обратите Ваше внимание на то, что удаление своего профиля приведёт к удалению всех Ваших данных из базы данных. Вы можете создать новый профиль в любой момент, но все данные, которые были удалены, будут утеряны.","modals.delete-account":"Удалить профиль","modals.error.copy":"Ошибка при копировании текста в буфер обмена: ","modals.error.server":"Упс! Возникла ошибка в работе сервера.","ui.copyright":"Copyright ©","ui.product_name":" ВК-КЛОН ","ui.sure_delete_photo":"Вы действительно хотите удалить эту фотографию?","ui.sure_delete_account":"Вы действительно хотите удалить свой профиль?","ui.delete":"Удалить","utils.required_field":"Заполните поле","utils.not_correct_format":"Неверный формат","utils.byte":"байт","utils.months.jan":"янв","utils.months.feb":"фев","utils.months.mar":"мар","utils.months.apr":"апр","utils.months.may":"мая","utils.months.june":"июня","utils.months.july":"июля","utils.months.aug":"авг","utils.months.sep":"сент","utils.months.oct":"окт","utils.months.nov":"нояб","utils.months.dec":"дек","utils.months.january":"января","utils.months.february":"февраля","utils.months.march":"марта","utils.months.april":"апреля","utils.months.august":"августа","utils.months.september":"сентября","utils.months.october":"октября","utils.months.november":"ноября","utils.months.december":"декабря","utils.yesterday":"вчера ","edit.main":"Основное","edit.contacts":"Контакты","edit.changes_save":"Изменения сохранены","edit.show_data":"новые данные будут отражены на Вашей странице.","edit.save":"Сохранить","edit_tabs.name":"Имя","edit_tabs.surname":"Фамилия","edit_tabs.sex":"Пол","edit_tabs.select_sex.label_not_specified":"Не указано","edit_tabs.select_sex.label_male":"Мужской","edit_tabs.select_sex.label_female":"Женский","edit_tabs.work":"Место работы","edit_tabs.birthday":"День рождения","edit_tabs.birthday_date":"Укажите дату","edit_tabs.city":"Город","edit_tabs.phone":"Мобильный телефон","edit_tabs.email":"Электронная почта","friends-module.error.unknown_tab":"Неизвестный тип вкладки: {{tab}}.","friends-module.all_friends":"Все друзья","friends-module.friend_requests":"Заявки в друзья","friends-module.outgoing_requests":"Исходящие заявки","friends-module.search":"Поиск","friends-module.possible_friends":"Возможные друзья","friends-module.add_to_friends":"Добавить в друзья","friends-module.no_other_users":"На данный момент в системе нет других пользователей.","friends-module.my_friends":"Мои друзья","friends-module.online_friends":"Друзья онлайн","friends-module.followers":"Подписчики","friends-module.blocked":"Заблокированные","friends-module.common_friends":"Общие друзья","friends-module.search_placeholder":"Поиск","friends-module.actions.remove_friend":"Удалить из друзей","friends-module.actions.block":"Заблокировать","friends-module.actions.write_message":"Написать сообщение","friends-module.actions.add_friend":"Добавить в друзья","friends-module.actions.accept":"Принять","friends-module.actions.decline":"Отклонить","friends-module.actions.unfollow":"Отписаться","friends-module.actions.unblock":"Разблокировать","friends-module.actions.find_friends":"Найти друзей","friends-module.empty.my_friends":"На данный момент список друзей пуст.","friends-module.empty.online_friends":"На данный момент список онлайн друзей пуст.","friends-module.empty.followers":"На данный момент список подписчиков пуст.","friends-module.empty.blocked":"На данный момент список заблокированных друзей пуст.","friends-module.empty.outgoing_requests":"На данный момент исходящих заявок в друзья нет.","friends-module.empty.incoming_requests":"На данный момент входящих заявок в друзья нет.","friends-module.empty.possible_friends":"На данный момент список возможных друзей пуст.","friends-module.empty.common_friends":"На данный момент список общих друзей пуст."};g.use(gi).init({lng:navigator.language||"en",fallbackLng:"ru",preload:["ru","en"],interpolation:{escapeValue:!1},resources:{ru:{translation:Ri},en:{translation:Fi}}});const Ai="/",As="/api",Mi="/",Li="skryabin.aleksey99@gmail.com",Di="utf8",xi=parseInt("15000"),Ui=parseInt("5"),Pi=parseInt("5000"),Zi=parseInt("10000"),$i=parseInt("10000"),qi="client-logs.txt",is="/assets/images/noPhoto.jpg",nt=g.t("utils.required_field"),ji=g.t("utils.not_correct_format"),hr=500,Bi=5e3,zi=1e4,mr="avatarUrl",Ms=25,Sn=25,Gi="SOCKET_MIDDLEWARE_ERROR",bn=600,En=[p.FriendsTab.MY,p.FriendsTab.ONLINE],Ls={LOAD_MORE:100,SEARCH:300};function Cn(r){const[e,t]=E.useState(is);return E.useEffect(()=>{t(r?`${As}${r}`:is)},[r]),e}function ut(){return E.useContext(Wn)}function Te(r){return ut().getProfile(r)}const Vi="APP",$t=[];class ge{constructor(e){this._prefix=e}get debug(){return this._getDebugger()}get info(){return this._getDebugger(rt.INFO)}get warn(){return this._getDebugger(rt.WARN)}get error(){return this._getDebugger(rt.ERROR)}_getDebugger(e=rt.DEBUG){const t=e&&`:${e}`,n=this._prefix?`:${this._prefix}`:"";return i=>{switch($t.length>$i&&($t.length=0),e){case rt.DEBUG:break;case rt.INFO:break;case rt.WARN:console.warn(i);break;case rt.ERROR:console.error(i);break}const h=new Date().toISOString().replace(/[:.]/g,"-");$t.push(`[${h}] ${Vi}${t}${n} | ${i}`)}}static init(e=""){return new ge(e)}downloadToFile(){if($t.length){const e=new Blob([$t.join(`
`)],{type:"text/plain"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=qi,t.click(),URL.revokeObjectURL(t.href)}}}const Wi=(r,e)=>{const t=[2,0,1,1,1,2];return e[r%100>4&&r%100<20?2:t[r%10<5?r%10:5]]},bt=(r,e)=>e?`${r}/${encodeURIComponent(e)}`:r,Hi=E.memo(function({id:e,src:t,alt:n,userId:i,className:h="",children:u}){const a=Cn(t),o=Re(),v=Te(),I=()=>{v.userService.id!==i&&o(bt(Y.profile,i))};return l(Ni,{userId:i,children:l(pn,{src:a,alt:n,id:e,className:`avatar ${h}`,onClick:I,children:u})})}),In=E.memo(function({className:e="",...t}){return l(Hi,{...t,id:"user-avatar",className:`user-avatar ${e}`})}),Tn=E.memo(function({id:e,children:t,anchorEl:n,anchorOrigin:i,open:h,autoFocus:u=!1,onClose:a}){return l(Ro,{id:e,anchorEl:n,anchorOrigin:i,open:h,autoFocus:u,onClose:a,children:t})}),Ge=E.memo(function({children:e,onClick:t,value:n,className:i}){return l(Ao,{className:i,value:n,onClick:t,children:e})}),Ie=E.memo(function({children:e,variant:t="body1",className:n,id:i,component:h="p"}){return l(Mo,{variant:t,className:n,id:i,component:h,children:e})}),Ki=ge.init("store.UI"),fr={error:null,snackbarError:null,confirmModal:null,settingsModal:!1,saveSettingsModal:!1},X=dt(r=>({...fr,setError:e=>(e&&Ki.error(e),r({error:e})),setSnackbarError:e=>r({snackbarError:e}),setConfirmModal:e=>r({confirmModal:e}),setSettingsModal:e=>r({settingsModal:e}),setSaveSettingsModal:e=>r({saveSettingsModal:e}),reset:()=>r({...fr})})),_r={user:null,isUserLoading:!1,userDetails:null,editUserDetails:null,myAvatar:null},me=dt(r=>({..._r,isUserLoading:!0,setUser:e=>r({user:e}),setLoadingUser:e=>r({isUserLoading:e}),setUserDetails:({userDetails:e,editUserDetails:t})=>r({userDetails:e,editUserDetails:t}),setMyAvatar:e=>r({myAvatar:e}),reset:()=>r({..._r})})),Qi={vertical:"top",horizontal:"left"},Yi=1;function Ji(){const r=ut(),e=Re(),[t,n]=E.useState(void 0),i=me(y=>y.myAvatar),h=y=>{y.stopPropagation(),n(y.currentTarget)},u=()=>{v(),X.getState().setSettingsModal(!0)},a=y=>{t&&v(),e(y)},o=y=>{y.button===Yi&&window.open(Ai)},v=()=>n(void 0),I=()=>{v(),r.mainApi.logout()};return l("header",{className:"header",children:l("div",{className:"header-container",children:F("div",{className:"header-container__toolbar",children:[l("div",{className:"header-container__toolbar__logo",onClick:()=>a(Y.profile),onMouseDown:o,children:l(Ii,{})}),F("div",{className:"header-container__toolbar__avatar",children:[l("div",{onClickCapture:h,children:l(In,{userId:i.userId,src:i.src,alt:i.alt})}),F(Tn,{anchorEl:t,anchorOrigin:Qi,open:!!t,autoFocus:!1,onClose:v,children:[l(Ge,{onClick:u,children:l(Ie,{variant:"body2",children:g.t("header.settings")})}),l(Ge,{onClick:()=>a(Y.help),children:l(Ie,{variant:"body2",children:g.t("header.help")})}),l(Ge,{onClick:I,children:l(Ie,{variant:"body2",children:g.t("header.logout")})})]})]})]})})})}const pr=E.memo(function({content:e=null,className:t="",...n}){return l(xs,{...n,className:`notification-badge ${t}`,color:"default",badgeContent:e})}),Xi=E.memo(function({children:e,className:t,...n}){return l(Lo,{...n,className:`menu__list ${t}`,children:e})}),gr={mainTab:p.FriendsTab.ALL,contentTab:p.FriendsTab.MY,friendsNotification:0,searchFriends:[],countSearchFriends:0,hasMoreSearchFriends:!1,isLoadingPossibleFriends:!1,isLoadingFollowAction:!1,searchPossibleFriends:"",incomingRequests:[],countIncomingRequests:0,hasMoreIncomingRequests:!1,isLoadingIncomingRequests:!1,isLoadingLeftInFollowersAction:!1,isLoadingAcceptAction:!1,searchIncomingRequests:"",outgoingRequests:[],countOutgoingRequests:0,hasMoreOutgoingRequests:!1,isLoadingOutgoingRequests:!1,isLoadingUnfollowAction:!1,searchOutgoingRequests:"",myFriends:[],countMyFriends:0,hasMoreMyFriends:!1,isLoadingMyFriends:!1,isLoadingDeleteFriendAction:!1,isLoadingBlockFriendAction:!1,searchMyFriends:"",onlineFriends:[],countOnlineFriends:0,hasMoreOnlineFriends:!1,isLoadingOnlineFriends:!1,searchOnlineFriends:"",followers:[],countFollowers:0,hasMoreFollowers:!1,isLoadingFollowers:!1,isLoadingAddFriendAction:!1,searchFollowers:"",blockedFriends:[],countBlockedFriends:0,hasMoreBlockedFriends:!1,isLoadingBlockedFriends:!1,isLoadingUnblockAction:!1,searchBlockedFriends:"",commonFriends:[],isLoadingCommonFriends:!1,searchCommonFriends:"",countCommonFriends:0,hasMoreCommonFriends:!1},A=dt(r=>({...gr,setMainTab:e=>r({mainTab:e}),setContentTab:e=>r({contentTab:e}),setFriendsNotification:e=>r({friendsNotification:e}),setAllCounts:e=>r({countSearchFriends:e.countSearchFriends,countIncomingRequests:e.countIncomingRequests,countOutgoingRequests:e.countOutgoingRequests,countMyFriends:e.countMyFriends,countFollowers:e.countFollowers,countBlockedFriends:e.countBlockedFriends,countCommonFriends:e.countCommonFriends}),setPossibleFriends:({items:e,count:t,hasMore:n})=>r({searchFriends:e,countSearchFriends:t,hasMoreSearchFriends:n}),setIsLoadingPossibleFriends:e=>r({isLoadingPossibleFriends:e}),setIsLoadingFollowAction:e=>r({isLoadingFollowAction:e}),setSearchPossibleFriends:e=>r({searchPossibleFriends:e}),setIncomingRequests:({items:e,count:t,hasMore:n})=>r({incomingRequests:e,countIncomingRequests:t,hasMoreIncomingRequests:n}),setIsLoadingIncomingRequests:e=>r({isLoadingIncomingRequests:e}),setIsLoadingLeftInFollowersAction:e=>r({isLoadingLeftInFollowersAction:e}),setIsLoadingAcceptAction:e=>r({isLoadingAcceptAction:e}),setSearchIncomingRequests:e=>r({searchIncomingRequests:e}),addFriendsNotification:()=>r(e=>({friendsNotification:e.friendsNotification+1})),removeFriendsNotification:()=>r(e=>({friendsNotification:e.friendsNotification?e.friendsNotification-1:e.friendsNotification})),setOutgoingRequests:({items:e,count:t,hasMore:n})=>r({outgoingRequests:e,countOutgoingRequests:t,hasMoreOutgoingRequests:n}),setIsLoadingOutgoingRequests:e=>r({isLoadingOutgoingRequests:e}),setIsLoadingUnfollowAction:e=>r({isLoadingUnfollowAction:e}),setSearchOutgoingRequests:e=>r({searchOutgoingRequests:e}),setFollowers:({items:e,count:t,hasMore:n})=>r({followers:e,countFollowers:t,hasMoreFollowers:n}),setIsLoadingFollowers:e=>r({isLoadingFollowers:e}),setIsLoadingAddFriendAction:e=>r({isLoadingAddFriendAction:e}),setSearchFollowers:e=>r({searchFollowers:e}),setMyFriends:({items:e,count:t,hasMore:n})=>r({myFriends:e,countMyFriends:t,hasMoreMyFriends:n}),setIsLoadingMyFriends:e=>r({isLoadingMyFriends:e}),setIsLoadingDeleteFriendAction:e=>r({isLoadingDeleteFriendAction:e}),setIsLoadingBlockFriendAction:e=>r({isLoadingBlockFriendAction:e}),setSearchMyFriends:e=>r({searchMyFriends:e}),setBlockedFriends:({items:e,count:t,hasMore:n})=>r({blockedFriends:e,countBlockedFriends:t,hasMoreBlockedFriends:n}),setIsLoadingBlockFriends:e=>r({isLoadingBlockedFriends:e}),setIsLoadingUnblockAction:e=>r({isLoadingUnblockAction:e}),setSearchBlockedFriends:e=>r({searchBlockedFriends:e}),setCommonFriends:({items:e,count:t,hasMore:n})=>r({commonFriends:e,countCommonFriends:t,hasMoreCommonFriends:n}),setIsLoadingCommonFriends:e=>r({isLoadingCommonFriends:e}),setSearchCommonFriends:e=>r({searchCommonFriends:e}),setOnlineFriends:({items:e,count:t,hasMore:n})=>r({onlineFriends:e,countOnlineFriends:t,hasMoreOnlineFriends:n}),setIsLoadingOnlineFriends:e=>r({isLoadingOnlineFriends:e}),setSearchOnlineFriends:e=>r({searchOnlineFriends:e}),reset:()=>r({...gr})}));function ea(){const r=A(n=>n.friendsNotification),{mainApi:e}=ut(),t=Re();return E.useEffect(()=>{e.getFriendsNotification(),e.getMessageNotification()},[]),F("div",{className:"menu",children:[l("nav",{className:"menu__nav",children:F(Xi,{children:[F(Ge,{className:"menu__nav__item",onClick:()=>t(Y.profile),"data-testid":"menu-profile",children:[l(Do,{color:"primary"}),l("div",{className:"menu__nav__item__title",children:g.t("menu.profile")})]}),F(Ge,{className:"menu__nav__item",onClick:()=>t(Y.messages),"data-testid":"menu-friends",children:[l(xo,{color:"primary"}),l("div",{className:"menu__nav__item__title",children:g.t("menu.messanger")}),l(pr,{content:0})]}),F(Ge,{className:"menu__nav__item",onClick:()=>t(Y.friends),"data-testid":"menu-messenger",children:[l(Uo,{color:"primary"}),l("div",{className:"menu__nav__item__title",children:g.t("menu.friends")}),l(pr,{content:r})]}),F(Ge,{className:"menu__nav__item",onClick:()=>t(Y.photos),children:[l(Po,{color:"primary"}),l("div",{className:"menu__nav__item__title",children:g.t("menu.photos")})]})]})}),l("div",{className:"menu__down-info",children:g.t("menu.to-developers")})]})}const ta=E.memo(function({show:e,children:t,status:n="success",className:i="",severity:h,onExited:u}){const a=E.useRef(null);E.useEffect(()=>(u&&e&&o(),e||v(),()=>{v()}),[e]);const o=()=>{v(),a.current=setTimeout(()=>{u()},Bi)},v=()=>{a.current&&(clearTimeout(a.current),a.current=null)};return l(Zo,{in:e,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:hr,exit:hr},children:l(gn,{color:n,className:i,severity:h,children:t})})}),ot=E.memo(function({children:e,className:t,variant:n,loading:i,disabled:h,href:u,color:a,onClick:o,size:v,type:I,fullWidth:y,startIcon:b}){return l($o,{className:t,variant:n,loading:i,disabled:h,href:u,color:a,onClick:C=>o?.(C),type:I,size:v,fullWidth:y,startIcon:b,children:e})}),Ke=E.memo(function({children:e,className:t,elevation:n,square:i}){return l(qo,{className:t,elevation:n,square:i,children:e})}),Oe=E.memo(function({id:e,name:t,type:n,margin:i,variant:h,label:u,autoComplete:a,required:o,fullWidth:v,value:I,autoFocus:y,error:b,helperText:C,onChange:O,className:T}){return l(jo,{"data-testid":"text-field",id:e,name:t,type:n,margin:i,variant:h,label:u,autoComplete:a,required:o,fullWidth:v,value:I,autoFocus:y,error:b,helperText:C,onChange:O,className:T})}),sa=E.memo(function({formValues:e,formErrors:t,onChange:n}){return F(Ue,{children:[l(Oe,{id:"city",name:"city",margin:"normal",variant:"outlined",label:g.t("edit_tabs.city"),autoComplete:g.t("edit_tabs.city"),fullWidth:!0,value:e.city,autoFocus:!0,onChange:i=>n("city",i.target.value)}),l(Oe,{id:"phone",name:"phone",margin:"normal",variant:"outlined",label:g.t("edit_tabs.phone"),autoComplete:g.t("edit_tabs.phone"),fullWidth:!0,value:e.phone,required:!0,error:!!(t&&t.phone),helperText:t&&t.phone?t&&t.phone:null,onChange:i=>n("phone",i.target.value)}),l(Oe,{id:"email",name:"email",margin:"normal",variant:"outlined",label:g.t("edit_tabs.email"),autoComplete:g.t("edit_tabs.email"),fullWidth:!0,value:e.email,required:!0,error:!!(t&&t.email),helperText:t&&t.email?t&&t.email:null,onChange:i=>n("email",i.target.value)})]})}),ra=E.memo(function({children:e,labelId:t,id:n,value:i,text:h,className:u,onChange:a}){return F("div",{className:"select","data-testid":"select",children:[l(Bo,{className:"select__label",id:t,children:h}),l(zo,{labelId:t,id:n,value:i,onChange:a,className:`select__input ${u}`,children:e})]})});var os={exports:{}},na=os.exports,vr;function oa(){return vr||(vr=1,function(r,e){(function(t,n){r.exports=n()})(na,function(){var t=1e3,n=6e4,i=36e5,h="millisecond",u="second",a="minute",o="hour",v="day",I="week",y="month",b="quarter",C="year",O="date",T="Invalid Date",N=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,M=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(z){var x=["th","st","nd","rd"],L=z%100;return"["+z+(x[(L-20)%10]||x[L]||x[0])+"]"}},U=function(z,x,L){var Z=String(z);return!Z||Z.length>=x?z:""+Array(x+1-Z.length).join(L)+z},V={s:U,z:function(z){var x=-z.utcOffset(),L=Math.abs(x),Z=Math.floor(L/60),D=L%60;return(x<=0?"+":"-")+U(Z,2,"0")+":"+U(D,2,"0")},m:function z(x,L){if(x.date()<L.date())return-z(L,x);var Z=12*(L.year()-x.year())+(L.month()-x.month()),D=x.clone().add(Z,y),Q=L-D<0,H=x.clone().add(Z+(Q?-1:1),y);return+(-(Z+(L-D)/(Q?D-H:H-D))||0)},a:function(z){return z<0?Math.ceil(z)||0:Math.floor(z)},p:function(z){return{M:y,y:C,w:I,d:v,D:O,h:o,m:a,s:u,ms:h,Q:b}[z]||String(z||"").toLowerCase().replace(/s$/,"")},u:function(z){return z===void 0}},B="en",q={};q[B]=w;var ne="$isDayjsObject",de=function(z){return z instanceof be||!(!z||!z[ne])},P=function z(x,L,Z){var D;if(!x)return B;if(typeof x=="string"){var Q=x.toLowerCase();q[Q]&&(D=Q),L&&(q[Q]=L,D=Q);var H=x.split("-");if(!D&&H.length>1)return z(H[0])}else{var J=x.name;q[J]=x,D=J}return!Z&&D&&(B=D),D||!Z&&B},K=function(z,x){if(de(z))return z.clone();var L=typeof x=="object"?x:{};return L.date=z,L.args=arguments,new be(L)},W=V;W.l=P,W.i=de,W.w=function(z,x){return K(z,{locale:x.$L,utc:x.$u,x:x.$x,$offset:x.$offset})};var be=function(){function z(L){this.$L=P(L.locale,null,!0),this.parse(L),this.$x=this.$x||L.x||{},this[ne]=!0}var x=z.prototype;return x.parse=function(L){this.$d=function(Z){var D=Z.date,Q=Z.utc;if(D===null)return new Date(NaN);if(W.u(D))return new Date;if(D instanceof Date)return new Date(D);if(typeof D=="string"&&!/Z$/i.test(D)){var H=D.match(N);if(H){var J=H[2]-1||0,ce=(H[7]||"0").substring(0,3);return Q?new Date(Date.UTC(H[1],J,H[3]||1,H[4]||0,H[5]||0,H[6]||0,ce)):new Date(H[1],J,H[3]||1,H[4]||0,H[5]||0,H[6]||0,ce)}}return new Date(D)}(L),this.init()},x.init=function(){var L=this.$d;this.$y=L.getFullYear(),this.$M=L.getMonth(),this.$D=L.getDate(),this.$W=L.getDay(),this.$H=L.getHours(),this.$m=L.getMinutes(),this.$s=L.getSeconds(),this.$ms=L.getMilliseconds()},x.$utils=function(){return W},x.isValid=function(){return this.$d.toString()!==T},x.isSame=function(L,Z){var D=K(L);return this.startOf(Z)<=D&&D<=this.endOf(Z)},x.isAfter=function(L,Z){return K(L)<this.startOf(Z)},x.isBefore=function(L,Z){return this.endOf(Z)<K(L)},x.$g=function(L,Z,D){return W.u(L)?this[Z]:this.set(D,L)},x.unix=function(){return Math.floor(this.valueOf()/1e3)},x.valueOf=function(){return this.$d.getTime()},x.startOf=function(L,Z){var D=this,Q=!!W.u(Z)||Z,H=W.p(L),J=function(ke,he){var ve=W.w(D.$u?Date.UTC(D.$y,he,ke):new Date(D.$y,he,ke),D);return Q?ve:ve.endOf(v)},ce=function(ke,he){return W.w(D.toDate()[ke].apply(D.toDate("s"),(Q?[0,0,0,0]:[23,59,59,999]).slice(he)),D)},re=this.$W,se=this.$M,ue=this.$D,Ne="set"+(this.$u?"UTC":"");switch(H){case C:return Q?J(1,0):J(31,11);case y:return Q?J(1,se):J(0,se+1);case I:var Le=this.$locale().weekStart||0,Ze=(re<Le?re+7:re)-Le;return J(Q?ue-Ze:ue+(6-Ze),se);case v:case O:return ce(Ne+"Hours",0);case o:return ce(Ne+"Minutes",1);case a:return ce(Ne+"Seconds",2);case u:return ce(Ne+"Milliseconds",3);default:return this.clone()}},x.endOf=function(L){return this.startOf(L,!1)},x.$set=function(L,Z){var D,Q=W.p(L),H="set"+(this.$u?"UTC":""),J=(D={},D[v]=H+"Date",D[O]=H+"Date",D[y]=H+"Month",D[C]=H+"FullYear",D[o]=H+"Hours",D[a]=H+"Minutes",D[u]=H+"Seconds",D[h]=H+"Milliseconds",D)[Q],ce=Q===v?this.$D+(Z-this.$W):Z;if(Q===y||Q===C){var re=this.clone().set(O,1);re.$d[J](ce),re.init(),this.$d=re.set(O,Math.min(this.$D,re.daysInMonth())).$d}else J&&this.$d[J](ce);return this.init(),this},x.set=function(L,Z){return this.clone().$set(L,Z)},x.get=function(L){return this[W.p(L)]()},x.add=function(L,Z){var D,Q=this;L=Number(L);var H=W.p(Z),J=function(se){var ue=K(Q);return W.w(ue.date(ue.date()+Math.round(se*L)),Q)};if(H===y)return this.set(y,this.$M+L);if(H===C)return this.set(C,this.$y+L);if(H===v)return J(1);if(H===I)return J(7);var ce=(D={},D[a]=n,D[o]=i,D[u]=t,D)[H]||1,re=this.$d.getTime()+L*ce;return W.w(re,this)},x.subtract=function(L,Z){return this.add(-1*L,Z)},x.format=function(L){var Z=this,D=this.$locale();if(!this.isValid())return D.invalidDate||T;var Q=L||"YYYY-MM-DDTHH:mm:ssZ",H=W.z(this),J=this.$H,ce=this.$m,re=this.$M,se=D.weekdays,ue=D.months,Ne=D.meridiem,Le=function(he,ve,Ee,Qe){return he&&(he[ve]||he(Z,Q))||Ee[ve].slice(0,Qe)},Ze=function(he){return W.s(J%12||12,he,"0")},ke=Ne||function(he,ve,Ee){var Qe=he<12?"AM":"PM";return Ee?Qe.toLowerCase():Qe};return Q.replace(M,function(he,ve){return ve||function(Ee){switch(Ee){case"YY":return String(Z.$y).slice(-2);case"YYYY":return W.s(Z.$y,4,"0");case"M":return re+1;case"MM":return W.s(re+1,2,"0");case"MMM":return Le(D.monthsShort,re,ue,3);case"MMMM":return Le(ue,re);case"D":return Z.$D;case"DD":return W.s(Z.$D,2,"0");case"d":return String(Z.$W);case"dd":return Le(D.weekdaysMin,Z.$W,se,2);case"ddd":return Le(D.weekdaysShort,Z.$W,se,3);case"dddd":return se[Z.$W];case"H":return String(J);case"HH":return W.s(J,2,"0");case"h":return Ze(1);case"hh":return Ze(2);case"a":return ke(J,ce,!0);case"A":return ke(J,ce,!1);case"m":return String(ce);case"mm":return W.s(ce,2,"0");case"s":return String(Z.$s);case"ss":return W.s(Z.$s,2,"0");case"SSS":return W.s(Z.$ms,3,"0");case"Z":return H}return null}(he)||H.replace(":","")})},x.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},x.diff=function(L,Z,D){var Q,H=this,J=W.p(Z),ce=K(L),re=(ce.utcOffset()-this.utcOffset())*n,se=this-ce,ue=function(){return W.m(H,ce)};switch(J){case C:Q=ue()/12;break;case y:Q=ue();break;case b:Q=ue()/3;break;case I:Q=(se-re)/6048e5;break;case v:Q=(se-re)/864e5;break;case o:Q=se/i;break;case a:Q=se/n;break;case u:Q=se/t;break;default:Q=se}return D?Q:W.a(Q)},x.daysInMonth=function(){return this.endOf(y).$D},x.$locale=function(){return q[this.$L]},x.locale=function(L,Z){if(!L)return this.$L;var D=this.clone(),Q=P(L,Z,!0);return Q&&(D.$L=Q),D},x.clone=function(){return W.w(this.$d,this)},x.toDate=function(){return new Date(this.valueOf())},x.toJSON=function(){return this.isValid()?this.toISOString():null},x.toISOString=function(){return this.$d.toISOString()},x.toString=function(){return this.$d.toUTCString()},z}(),ht=be.prototype;return K.prototype=ht,[["$ms",h],["$s",u],["$m",a],["$H",o],["$W",v],["$M",y],["$y",C],["$D",O]].forEach(function(z){ht[z[1]]=function(x){return this.$g(x,z[0],z[1])}}),K.extend=function(z,x){return z.$i||(z(x,be,K),z.$i=!0),K},K.locale=P,K.isDayjs=de,K.unix=function(z){return K(1e3*z)},K.en=q[B],K.Ls=q,K.p={},K})}(os)),os.exports}var ia=oa();const aa=pi(ia),ca="modulepreload",la=function(r){return"/"+r},yr={},Qt=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let u=function(v){return Promise.all(v.map(I=>Promise.resolve(I).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=u(t.map(v=>{if(v=la(v),v in yr)return;yr[v]=!0;const I=v.endsWith(".css"),y=I?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${y}`))return;const b=document.createElement("link");if(b.rel=I?"stylesheet":ca,I||(b.as="script"),b.crossOrigin="",b.href=v,o&&b.setAttribute("nonce",o),document.head.appendChild(b),I)return new Promise((C,O)=>{b.addEventListener("load",C),b.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${v}`)))})}))}function h(u){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=u,window.dispatchEvent(a),!a.defaultPrevented)throw u}return i.then(u=>{for(const a of u||[])a.status==="rejected"&&h(a.reason);return e().catch(h)})};function Ae({size:r=40}){return l("div",{"data-testid":"spinner",className:"spinner",children:l(vn,{size:r})})}const Nn=E.memo(function({className:e}){return l("div",{className:e,children:l(Ae,{})})}),da=E.lazy(async()=>{const[{DatePicker:r,LocalizationProvider:e},t]=await Promise.all([Qt(()=>import("./index-BX44sMl1.js"),__vite__mapDeps([0,1,2])),Qt(()=>import("./index-BEY2Fyze.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))]);return await Qt(()=>import("./ru-CwUHeTgb.js").then(n=>n.r),__vite__mapDeps([9,2])),{default:({label:n,value:i,placeholder:h,onChange:u})=>l(e,{dateAdapter:t.AdapterDayjs,adapterLocale:"ru",children:l(r,{disableFuture:!0,label:n,value:i,onChange:u,slotProps:{textField:{fullWidth:!0,inputProps:{placeholder:h}}}})})}}),ua=E.memo(function(e){return l(E.Suspense,{fallback:l(Nn,{className:"date-picker__loading"}),children:l(da,{...e})})});new Date().toUTCString();const ha=ge.init("utils/date"),ma=[g.t("utils.months.jan"),g.t("utils.months.feb"),g.t("utils.months.mar"),g.t("utils.months.apr"),g.t("utils.months.may"),g.t("utils.months.june"),g.t("utils.months.july"),g.t("utils.months.aug"),g.t("utils.months.sep"),g.t("utils.months.oct"),g.t("utils.months.nov"),g.t("utils.months.dec")];g.t("utils.months.january"),g.t("utils.months.february"),g.t("utils.months.march"),g.t("utils.months.april"),g.t("utils.months.may"),g.t("utils.months.june"),g.t("utils.months.july"),g.t("utils.months.august"),g.t("utils.months.september"),g.t("utils.months.october"),g.t("utils.months.november"),g.t("utils.months.december");const fa=r=>(ha.debug(`getMonthName [month=${r}]`)," "+ma[r]),_a=r=>r?r.format("YYYY-MM-DD"):null,pa=E.memo(function({formValues:e,onChangeField:t}){return l(ua,{label:g.t("edit_tabs.birthday"),value:aa(e.birthday),placeholder:g.t("edit_tabs.birthday_date"),onChange:n=>{t("birthday",_a(n))}})}),ga=E.memo(function({formValues:e,formErrors:t,onChange:n}){return F(Ue,{children:[l(Oe,{id:"name",name:"name",margin:"normal",variant:"outlined",label:g.t("edit_tabs.name"),autoComplete:g.t("edit_tabs.name"),fullWidth:!0,value:e.name,required:!0,autoFocus:!0,error:!!t?.name,helperText:t&&t.name?t.name:null,onChange:i=>n("name",i.target.value)}),l(Oe,{id:"surName",name:"surName",margin:"normal",variant:"outlined",label:g.t("edit_tabs.surname"),autoComplete:g.t("edit_tabs.surname"),fullWidth:!0,value:e.surName,required:!0,error:!!t?.surName,helperText:t&&t.surName?t.surName:null,onChange:i=>n("surName",i.target.value)}),l(Se,{className:"edit-container__sex-select",children:F(ra,{labelId:"sex-input",id:"sex-select",text:g.t("edit_tabs.sex"),value:e.sex||"notSelected",onChange:i=>n("sex",i.target.value==="notSelected"?null:i.target.value),children:[l(Ge,{value:"notSelected",children:g.t("edit_tabs.select_sex.label_not_specified")}),l(Ge,{value:"male",children:g.t("edit_tabs.select_sex.label_male")}),l(Ge,{value:"female",children:g.t("edit_tabs.select_sex.label_female")})]})}),l(pa,{formValues:e,onChangeField:n}),l(Oe,{id:"work",name:"work",margin:"normal",variant:"outlined",label:g.t("edit_tabs.work"),autoComplete:g.t("edit_tabs.work"),fullWidth:!0,value:e.work,className:"edit-container__work",onChange:i=>n("work",i.target.value)})]})}),va={[Rs.MAIN]:ga,[Rs.CONTACTS]:sa},ya=E.memo(function({tab:e,formValues:t,formErrors:n,onChange:i}){const h=va[e];return l("div",{role:"tabpanel",id:`vertical-tabpanel-${e}`,"aria-labelledby":`vertical-tab-${e}`,children:l(h,{formValues:t,formErrors:n,onChange:i})})}),Sr={showEditAlert:!1,isEditLoading:!1,editErrors:void 0,isDeleteAvatarLoading:!1,isDeleteAccountLoading:!1,isPrepareAnotherUser:!0},pe=dt(r=>({...Sr,setShowEditAlert:e=>r({showEditAlert:e}),setEditLoading:e=>r({isEditLoading:e}),setEditErrors:e=>r({editErrors:e}),setDeleteAvatarLoading:e=>r({isDeleteAvatarLoading:e}),setDeleteAccountLoading:e=>r({isDeleteAccountLoading:e}),setPrepareAnotherUser:e=>r({isPrepareAnotherUser:e}),reset:()=>r({...Sr})})),Sa=["name","surName","phone","email"];function ba(){const r=pe(P=>P.showEditAlert),e=pe(P=>P.isEditLoading),t=pe(P=>P.editErrors),n=me(P=>P.user.firstName),i=me(P=>P.user.thirdName),h=me(P=>P.user.email),u=me(P=>P.user.phone),a=me(P=>P.editUserDetails.birthday),o=me(P=>P.editUserDetails.city),v=me(P=>P.editUserDetails.work),I=me(P=>P.editUserDetails.sex),[y,b]=E.useState(0),[C,O]=E.useState({name:n,surName:i,phone:u,email:h,sex:I,birthday:a,work:v,city:o}),[T,N]=E.useState({}),[M,w]=E.useState(!1),U=Te();E.useEffect(()=>()=>{r&&de()},[r]),E.useEffect(()=>{t&&V(t)},[t]),E.useEffect(()=>{w(e||!!(T&&Object.values(T).some(Boolean)))},[e,C]);const V=({field:P,fields:K})=>{let W={};if(K&&K.length)for(const be of K)W={...W,[be]:nt};P&&(W={[P]:ji}),N({...T,...W})},B=(P,K)=>{b(K),pe.getState().setShowEditAlert(!1)},q=(P,K)=>{O({...C,[P]:K}),Sa.includes(P)&&N({[P]:K?"":nt})},ne=async P=>{P.preventDefault();const K=Object.fromEntries(Object.entries(C).map(([W,be])=>[W,be===""?null:be]));U.editInfo(K),de()},de=()=>{pe.getState().setShowEditAlert(!1)};return F(Ke,{className:"edit-container",children:[F(Us,{orientation:"vertical",value:y,onChange:B,"aria-label":"Edit tabs",className:"edit-container__tabs",children:[l(ze,{label:g.t("edit.main"),id:"main","aria-controls":"main",disabled:e,className:"edit-container__tab-name"}),l(ze,{label:g.t("edit.contacts"),id:"contacts","aria-controls":"contacts",disabled:e,className:"edit-container__tab-name"})]}),l("div",{className:"edit-container__module",children:F(Se,{component:"form",noValidate:!0,onSubmit:ne,className:"edit-container__module__form",children:[l(ya,{tab:y,formValues:C,formErrors:T,onChange:q}),l(ot,{fullWidth:!0,type:"submit",variant:"contained",className:"edit-container__module__form__loading-button",loading:e,disabled:M,children:g.t("edit.save")}),l(ta,{show:r,onExited:de,children:F(Ue,{children:[l("b",{children:g.t("edit.changes_save")})," - ",g.t("edit.show_data")]})})]})})]})}const cs=E.memo(function({userId:e,src:t,alt:n}){return l(In,{userId:e,src:t,alt:n,className:"big-avatar"})}),te=E.memo(function({children:e,container:t,spacing:n=2,xs:i,sm:h,md:u,className:a="grid-item-style",component:o="div",elevation:v,square:I,direction:y=void 0}){return l(Go,{container:t,spacing:n,size:{xs:i,sm:h,md:u},className:a,component:o,elevation:v,square:I,direction:y,children:e})}),wt=E.memo(function({href:e,children:t,onClick:n,...i}){return l(Vo,{...i,href:e,onClick:u=>{u.preventDefault(),n&&n()},"data-testid":"link",children:t})});function Ps(){const r=vi();return(gs(Y.profileUser,r.pathname)||gs(Y.photosUser,r.pathname)||gs(Y.friendsUser,r.pathname))?.params.userId}function Zs(){const r=Ps(),e=pe(i=>i.isPrepareAnotherUser),t=ut(),n=t.existProfile(r);return E.useEffect(()=>{r&&!n?(e||pe.getState().setPrepareAnotherUser(!0),t.mainApi.getAnotherUser(r)):n&&pe.getState().setPrepareAnotherUser(!1)},[r,n]),{isLoading:e,isExistProfile:n}}function Me(r){return Te(r).userService}const Ea=E.memo(function({classNameInput:e,classNameIcon:t,placeholder:n,value:i,haveBorder:h=!1,onChange:u}){return F("div",{className:`input-search ${h?"input-search__field-with-border":""}`,children:[l(Wo,{className:`input-search__icon ${t??""}`}),l(Ho,{id:"standard-input",autoFocus:!0,placeholder:n,fullWidth:!0,size:"medium",className:`input-search__field ${e??""}`,value:i,onChange:a=>u(a.target.value)}),i&&l(Ko,{className:"input-search__close-icon",onClick:()=>u("")})]})}),$s=E.memo(function({className:e,children:t,...n}){return l(Qo,{className:e,...n,children:t})}),kn=E.memo(function({...e}){return l(ot,{...e,className:"upper-button",children:l(Yo,{})})});function Ca(r){return l(ot,{...r,size:"medium"})}function oe(r){return{id:r.id,avatarUrl:r.avatarUrl||"",avatarCreateDate:r.avatarCreateDate||"",fullName:r.firstName+" "+r.thirdName,createdAt:r.createdAt||""}}const Ia=r=>{switch(r){case p.FriendsTab.MY:return g.t("friends-module.empty.my_friends");case p.FriendsTab.ONLINE:return g.t("friends-module.empty.online_friends");case p.FriendsTab.FOLLOWERS:return g.t("friends-module.empty.followers");case p.FriendsTab.BLOCKED:return g.t("friends-module.empty.blocked");case p.FriendsTab.OUTGOING_REQUESTS:return g.t("friends-module.empty.outgoing_requests");case p.FriendsTab.INCOMING_REQUESTS:return g.t("friends-module.empty.incoming_requests");case p.FriendsTab.SEARCH:return g.t("friends-module.empty.possible_friends");case p.FriendsTab.COMMON:return g.t("friends-module.empty.common_friends");default:return X.getState().setError(g.t("friends-module.error.unknown_tab",{tab:r})),g.t("friends-module.empty.my_friends")}};function Ta(){const{userId:r}=Pe(),e=Te(r),t=A(u=>u.mainTab===p.FriendsTab.ALL?u.contentTab:u.mainTab),n=E.useMemo(()=>En.includes(t)&&e.isMe,[t,e]),i=E.useCallback(()=>Ia(t),[t]),h=()=>{A.getState().setMainTab(p.FriendsTab.SEARCH)};return F("div",{className:"empty-friends",children:[l("div",{className:"opacity-text",children:i()}),n?l(Ca,{variant:"outlined",className:"empty-friends__search",onClick:h,children:g.t("friends-module.actions.find_friends")}):null]})}const qs=E.memo(function({className:e,children:t,...n}){return l(Jo,{className:e,...n,children:t})}),js=E.memo(function({className:e,children:t,...n}){return l(Xo,{className:e,...n,children:t})}),wn=E.memo(function({className:e,primary:t,secondary:n,...i}){return l(ei,{className:e,primary:t,secondary:n,...i})}),Na=E.memo(function({id:e,anchorEl:t,anchorOrigin:n,open:i,onClose:h,items:u}){const a=o=>{o.onClick(),h()};return l(Tn,{id:e,anchorEl:t,anchorOrigin:n,open:i,onClose:h,children:u.map((o,v)=>l(Ge,{onClick:()=>a(o),className:"menu-item",children:F(Ie,{className:o.className,children:[o.icon??null,o.title]})},`${v}-${o.title}`))})});function we(r){return l(ot,{...r,size:"small"})}const ka=E.memo(function({friend:e}){const[t]=E.useState(!1),n=A(C=>C.mainTab===p.FriendsTab.ALL?C.contentTab:C.mainTab),i=A(C=>C.isLoadingLeftInFollowersAction),h=A(C=>C.isLoadingUnfollowAction),u=A(C=>C.isLoadingAddFriendAction),a=A(C=>C.isLoadingAcceptAction),o=A(C=>C.isLoadingFollowAction),v=A(C=>C.isLoadingDeleteFriendAction),I=A(C=>C.isLoadingBlockFriendAction),y=A(C=>C.isLoadingUnblockAction),b=Me().friendsService;switch(n){case p.FriendsTab.MY:case p.FriendsTab.ONLINE:return l("span",{className:"friend-actions__write-message",onClick:C=>b.writeMessage(e.id),children:t||v||I?l("div",{className:"friend-actions__write-message__loading",children:l(Ae,{size:24})}):g.t("friends-module.actions.write_message")});case p.FriendsTab.FOLLOWERS:return l(we,{variant:"outlined",className:"friend-actions__action",color:"success",disabled:u,onClick:C=>b.addFriend(e.id),children:g.t("friends-module.actions.add_friend")});case p.FriendsTab.INCOMING_REQUESTS:return F("span",{className:"friend-actions__accept",children:[l(we,{variant:"outlined",className:"friend-actions__action",color:"success",disabled:a,onClick:C=>b.accept(e.id),children:g.t("friends-module.actions.accept")}),l(we,{variant:"outlined",className:"friend-actions__action",color:"error",disabled:i,onClick:C=>b.leftInFollowers(e.id),children:g.t("friends-module.actions.decline")})]});case p.FriendsTab.OUTGOING_REQUESTS:return l(we,{variant:"outlined",className:"friend-actions__action",color:"error",disabled:h,onClick:C=>b.unfollow(e.id),children:g.t("friends-module.actions.unfollow")});case p.FriendsTab.SEARCH:return l(we,{variant:"outlined",className:"friend-actions__action",color:"success",startIcon:l(yn,{className:"friend-actions__add-icon"}),disabled:o,onClick:C=>b.followFriend(e.id),children:g.t("friends-module.actions.add_friend")});case p.FriendsTab.BLOCKED:return l(we,{variant:"outlined",className:"friend-actions__action",color:"success",disabled:y,onClick:C=>b.unblock(e.id),children:g.t("friends-module.actions.unblock")});default:return X.getState().setError(g.t("friends-module.error.unknown_tab",{tab:n})),null}}),wa=E.memo(function({friend:e}){const[t,n]=E.useState(null),i=A(y=>y.mainTab===p.FriendsTab.ALL?y.contentTab:y.mainTab),{userId:h}=Pe(),u=Te(h),a=Me().friendsService,o=E.useMemo(()=>En.includes(i)&&u.isMe,[i,u]),v=y=>`popover-list-item-${y}`,I=y=>[{title:g.t("friends-module.actions.remove_friend"),onClick:()=>a.deleteFriend(y)},{title:g.t("friends-module.actions.block"),onClick:()=>a.blockFriend(y)}];return F(qs,{className:"friend-item",children:[l(js,{className:"friend-item__avatar",children:l(cs,{userId:e.id,src:e.avatarUrl,alt:e.fullName})}),l(wn,{className:"friend-item__info",primary:e.fullName,disableTypography:!0,secondary:u.isMe?l(ka,{friend:e}):null}),o?F(Ue,{children:[l(ti,{className:"friend-item__more","aria-describedby":v(e.id),onClick:y=>n({el:y.currentTarget,id:e.id})}),l(Na,{id:v(e.id),anchorEl:t?.el,anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t?.id===e.id,onClose:()=>n(null),items:I(e.id)})]}):null]},e.id)});var br=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function Oa(r,e){return!!(r===e||br(r)&&br(e))}function Fa(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!Oa(r[t],e[t]))return!1;return!0}function ys(r,e){e===void 0&&(e=Fa);var t,n=[],i,h=!1;function u(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return h&&t===this&&e(a,n)||(i=r.apply(this,a),h=!0,t=this,n=a),i}return u}var Ra=typeof performance=="object"&&typeof performance.now=="function",Er=Ra?function(){return performance.now()}:function(){return Date.now()};function Cr(r){cancelAnimationFrame(r.id)}function Aa(r,e){var t=Er();function n(){Er()-t>=e?r.call(null):i.id=requestAnimationFrame(n)}var i={id:requestAnimationFrame(n)};return i}var Ss=-1;function Ir(r){if(r===void 0&&(r=!1),Ss===-1||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",document.body.appendChild(e),Ss=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Ss}var Nt=null;function Tr(r){if(r===void 0&&(r=!1),Nt===null||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";var n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?Nt="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?Nt="negative":Nt="positive-ascending"),document.body.removeChild(e),Nt}return Nt}var Ma=150,La=function(e,t){return e};function Da(r){var e,t=r.getItemOffset,n=r.getEstimatedTotalSize,i=r.getItemSize,h=r.getOffsetForIndexAndAlignment,u=r.getStartIndexForOffset,a=r.getStopIndexForStartIndex,o=r.initInstanceProps,v=r.shouldResetStyleCacheOnItemSizeChange,I=r.validateProps;return e=function(y){si(b,y);function b(O){var T;return T=y.call(this,O)||this,T._instanceProps=o(T.props,or(T)),T._outerRef=void 0,T._resetIsScrollingTimeoutId=null,T.state={instance:or(T),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof T.props.initialScrollOffset=="number"?T.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},T._callOnItemsRendered=void 0,T._callOnItemsRendered=ys(function(N,M,w,U){return T.props.onItemsRendered({overscanStartIndex:N,overscanStopIndex:M,visibleStartIndex:w,visibleStopIndex:U})}),T._callOnScroll=void 0,T._callOnScroll=ys(function(N,M,w){return T.props.onScroll({scrollDirection:N,scrollOffset:M,scrollUpdateWasRequested:w})}),T._getItemStyle=void 0,T._getItemStyle=function(N){var M=T.props,w=M.direction,U=M.itemSize,V=M.layout,B=T._getItemStyleCache(v&&U,v&&V,v&&w),q;if(B.hasOwnProperty(N))q=B[N];else{var ne=t(T.props,N,T._instanceProps),de=i(T.props,N,T._instanceProps),P=w==="horizontal"||V==="horizontal",K=w==="rtl",W=P?ne:0;B[N]=q={position:"absolute",left:K?void 0:W,right:K?W:void 0,top:P?0:ne,height:P?"100%":de,width:P?de:"100%"}}return q},T._getItemStyleCache=void 0,T._getItemStyleCache=ys(function(N,M,w){return{}}),T._onScrollHorizontal=function(N){var M=N.currentTarget,w=M.clientWidth,U=M.scrollLeft,V=M.scrollWidth;T.setState(function(B){if(B.scrollOffset===U)return null;var q=T.props.direction,ne=U;if(q==="rtl")switch(Tr()){case"negative":ne=-U;break;case"positive-descending":ne=V-w-U;break}return ne=Math.max(0,Math.min(ne,V-w)),{isScrolling:!0,scrollDirection:B.scrollOffset<ne?"forward":"backward",scrollOffset:ne,scrollUpdateWasRequested:!1}},T._resetIsScrollingDebounced)},T._onScrollVertical=function(N){var M=N.currentTarget,w=M.clientHeight,U=M.scrollHeight,V=M.scrollTop;T.setState(function(B){if(B.scrollOffset===V)return null;var q=Math.max(0,Math.min(V,U-w));return{isScrolling:!0,scrollDirection:B.scrollOffset<q?"forward":"backward",scrollOffset:q,scrollUpdateWasRequested:!1}},T._resetIsScrollingDebounced)},T._outerRefSetter=function(N){var M=T.props.outerRef;T._outerRef=N,typeof M=="function"?M(N):M!=null&&typeof M=="object"&&M.hasOwnProperty("current")&&(M.current=N)},T._resetIsScrollingDebounced=function(){T._resetIsScrollingTimeoutId!==null&&Cr(T._resetIsScrollingTimeoutId),T._resetIsScrollingTimeoutId=Aa(T._resetIsScrolling,Ma)},T._resetIsScrolling=function(){T._resetIsScrollingTimeoutId=null,T.setState({isScrolling:!1},function(){T._getItemStyleCache(-1,null)})},T}b.getDerivedStateFromProps=function(T,N){return xa(T,N),I(T),null};var C=b.prototype;return C.scrollTo=function(T){T=Math.max(0,T),this.setState(function(N){return N.scrollOffset===T?null:{scrollDirection:N.scrollOffset<T?"forward":"backward",scrollOffset:T,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},C.scrollToItem=function(T,N){N===void 0&&(N="auto");var M=this.props,w=M.itemCount,U=M.layout,V=this.state.scrollOffset;T=Math.max(0,Math.min(T,w-1));var B=0;if(this._outerRef){var q=this._outerRef;U==="vertical"?B=q.scrollWidth>q.clientWidth?Ir():0:B=q.scrollHeight>q.clientHeight?Ir():0}this.scrollTo(h(this.props,T,N,V,this._instanceProps,B))},C.componentDidMount=function(){var T=this.props,N=T.direction,M=T.initialScrollOffset,w=T.layout;if(typeof M=="number"&&this._outerRef!=null){var U=this._outerRef;N==="horizontal"||w==="horizontal"?U.scrollLeft=M:U.scrollTop=M}this._callPropsCallbacks()},C.componentDidUpdate=function(){var T=this.props,N=T.direction,M=T.layout,w=this.state,U=w.scrollOffset,V=w.scrollUpdateWasRequested;if(V&&this._outerRef!=null){var B=this._outerRef;if(N==="horizontal"||M==="horizontal")if(N==="rtl")switch(Tr()){case"negative":B.scrollLeft=-U;break;case"positive-ascending":B.scrollLeft=U;break;default:var q=B.clientWidth,ne=B.scrollWidth;B.scrollLeft=ne-q-U;break}else B.scrollLeft=U;else B.scrollTop=U}this._callPropsCallbacks()},C.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Cr(this._resetIsScrollingTimeoutId)},C.render=function(){var T=this.props,N=T.children,M=T.className,w=T.direction,U=T.height,V=T.innerRef,B=T.innerElementType,q=T.innerTagName,ne=T.itemCount,de=T.itemData,P=T.itemKey,K=P===void 0?La:P,W=T.layout,be=T.outerElementType,ht=T.outerTagName,z=T.style,x=T.useIsScrolling,L=T.width,Z=this.state.isScrolling,D=w==="horizontal"||W==="horizontal",Q=D?this._onScrollHorizontal:this._onScrollVertical,H=this._getRangeToRender(),J=H[0],ce=H[1],re=[];if(ne>0)for(var se=J;se<=ce;se++)re.push(E.createElement(N,{data:de,key:K(se,de),index:se,isScrolling:x?Z:void 0,style:this._getItemStyle(se)}));var ue=n(this.props,this._instanceProps);return E.createElement(be||ht||"div",{className:M,onScroll:Q,ref:this._outerRefSetter,style:ri({position:"relative",height:U,width:L,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:w},z)},E.createElement(B||q||"div",{children:re,ref:V,style:{height:D?"100%":ue,pointerEvents:Z?"none":void 0,width:D?ue:"100%"}}))},C._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var T=this.props.itemCount;if(T>0){var N=this._getRangeToRender(),M=N[0],w=N[1],U=N[2],V=N[3];this._callOnItemsRendered(M,w,U,V)}}if(typeof this.props.onScroll=="function"){var B=this.state,q=B.scrollDirection,ne=B.scrollOffset,de=B.scrollUpdateWasRequested;this._callOnScroll(q,ne,de)}},C._getRangeToRender=function(){var T=this.props,N=T.itemCount,M=T.overscanCount,w=this.state,U=w.isScrolling,V=w.scrollDirection,B=w.scrollOffset;if(N===0)return[0,0,0,0];var q=u(this.props,B,this._instanceProps),ne=a(this.props,q,B,this._instanceProps),de=!U||V==="backward"?Math.max(1,M):1,P=!U||V==="forward"?Math.max(1,M):1;return[Math.max(0,q-de),Math.max(0,Math.min(N-1,ne+P)),q,ne]},b}(E.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var xa=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},Ua=Da({getItemOffset:function(e,t){var n=e.itemSize;return t*n},getItemSize:function(e,t){var n=e.itemSize;return n},getEstimatedTotalSize:function(e){var t=e.itemCount,n=e.itemSize;return n*t},getOffsetForIndexAndAlignment:function(e,t,n,i,h,u){var a=e.direction,o=e.height,v=e.itemCount,I=e.itemSize,y=e.layout,b=e.width,C=a==="horizontal"||y==="horizontal",O=C?b:o,T=Math.max(0,v*I-O),N=Math.min(T,t*I),M=Math.max(0,t*I-O+I+u);switch(n==="smart"&&(i>=M-O&&i<=N+O?n="auto":n="center"),n){case"start":return N;case"end":return M;case"center":{var w=Math.round(M+(N-M)/2);return w<Math.ceil(O/2)?0:w>T+Math.floor(O/2)?T:w}case"auto":default:return i>=M&&i<=N?i:i<M?M:N}},getStartIndexForOffset:function(e,t){var n=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(n-1,Math.floor(t/i)))},getStopIndexForStartIndex:function(e,t,n){var i=e.direction,h=e.height,u=e.itemCount,a=e.itemSize,o=e.layout,v=e.width,I=i==="horizontal"||o==="horizontal",y=t*a,b=I?v:h,C=Math.ceil((b+n-y)/a);return Math.max(0,Math.min(u-1,t+C-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function Pa(r){var e=r.lastRenderedStartIndex,t=r.lastRenderedStopIndex,n=r.startIndex,i=r.stopIndex;return!(n>t||i<e)}function Za(r){for(var e=r.isItemLoaded,t=r.itemCount,n=r.minimumBatchSize,i=r.startIndex,h=r.stopIndex,u=[],a=null,o=null,v=i;v<=h;v++){var I=e(v);I?o!==null&&(u.push(a,o),a=o=null):(o=v,a===null&&(a=v))}if(o!==null){for(var y=Math.min(Math.max(o,a+n-1),t-1),b=o+1;b<=y&&!e(b);b++)o=b;u.push(a,o)}if(u.length)for(;u[1]-u[0]+1<n&&u[0]>0;){var C=u[0]-1;if(!e(C))u[0]=C;else break}return u}var $a=function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")},qa=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),ja=function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)},Nr=function(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r},Ba=function(r){ja(e,r);function e(){var t,n,i,h;$a(this,e);for(var u=arguments.length,a=Array(u),o=0;o<u;o++)a[o]=arguments[o];return h=(n=(i=Nr(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),i),i._lastRenderedStartIndex=-1,i._lastRenderedStopIndex=-1,i._memoizedUnloadedRanges=[],i._onItemsRendered=function(v){var I=v.visibleStartIndex,y=v.visibleStopIndex;i._lastRenderedStartIndex=I,i._lastRenderedStopIndex=y,i._ensureRowsLoaded(I,y)},i._setRef=function(v){i._listRef=v},n),Nr(i,h)}return qa(e,[{key:"resetloadMoreItemsCache",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this._memoizedUnloadedRanges=[],n&&this._ensureRowsLoaded(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var n=this.props.children;return n({onItemsRendered:this._onItemsRendered,ref:this._setRef})}},{key:"_ensureRowsLoaded",value:function(n,i){var h=this.props,u=h.isItemLoaded,a=h.itemCount,o=h.minimumBatchSize,v=o===void 0?10:o,I=h.threshold,y=I===void 0?15:I,b=Za({isItemLoaded:u,itemCount:a,minimumBatchSize:v,startIndex:Math.max(0,n-y),stopIndex:Math.min(a-1,i+y)});(this._memoizedUnloadedRanges.length!==b.length||this._memoizedUnloadedRanges.some(function(C,O){return b[O]!==C}))&&(this._memoizedUnloadedRanges=b,this._loadUnloadedRanges(b))}},{key:"_loadUnloadedRanges",value:function(n){for(var i=this,h=this.props.loadMoreItems||this.props.loadMoreRows,u=function(v){var I=n[v],y=n[v+1],b=h(I,y);b?.then(function(){if(Pa({lastRenderedStartIndex:i._lastRenderedStartIndex,lastRenderedStopIndex:i._lastRenderedStopIndex,startIndex:I,stopIndex:y})){if(i._listRef==null)return;typeof i._listRef.resetAfterIndex=="function"?i._listRef.resetAfterIndex(I,!0):(typeof i._listRef._getItemStyleCache=="function"&&i._listRef._getItemStyleCache(-1),i._listRef.forceUpdate())}})},a=0;a<n.length;a+=2)u(a)}}]),e}(E.PureComponent);function za(r){const[e,t]=E.useState({width:0,height:0}),n=E.useCallback(()=>{if(r&&"current"in r&&r.current){const{width:i,height:h}=r.current.getBoundingClientRect();t({width:i,height:h})}},[r]);return E.useEffect(()=>{if(!r||!("current"in r)||!r.current)return;n();const i=new ResizeObserver(()=>{n()});return i.observe(r.current),()=>{i.disconnect()}},[r,n]),e}const Ga=E.memo(function({index:e,style:t,data:n,options:i,renderCb:h}){const{cols:u,gap:a,itemHeight:o}=i,{items:v,itemWidth:I,hasMore:y}=n,b=e*u,C=v.slice(b,b+u);return!C.length&&y?l("div",{className:"list__loading-row",style:t,children:l(Ae,{})}):l("div",{className:"list__row",style:{...t,gap:a},children:C.map(O=>h({item:O,itemWidth:I,itemHeight:o}))})}),On=E.forwardRef(function(e,t){const{virtualRef:n,items:i,options:h,hasMore:u,emptyText:a,isLoading:o,limit:v,loadMore:I,renderCb:y,onScroll:b}=e,{cols:C,gap:O,itemHeight:T}=h,N=E.useRef(null),{width:M,height:w}=za(t),U=E.useRef(i.length);E.useEffect(()=>{const P=Math.floor(w/(T+O)),K=Math.ceil(i.length/C),W=P>=K,be=i.length<U.current;(W||be)&&u&&!o&&I(),U.current=i.length},[i.length,w,i.length,u,o]),E.useImperativeHandle(n,()=>({scrollTop:(P="smooth")=>{N.current?.scrollTo({top:0,behavior:P})}}),[]);const V=E.useMemo(()=>Math.ceil(i.length/C)+(u?1:0),[i.length,u]),B=E.useMemo(()=>(M-(C-1)*O)/C,[M]),q=E.useCallback(P=>P<Math.ceil(i.length/C),[i.length]),ne=E.useCallback(P=>{const K=i[P*C];return K?`row-${K.id}`:`loading-${P}`},[i]),de=E.useCallback(({index:P,style:K,data:W})=>l(Ga,{index:P,style:K,data:W,options:{cols:C,gap:O,itemHeight:T},renderCb:y}),[]);return o&&(!i||!i.length)?l("div",{className:"virtual-list__loading",children:l(Ae,{})}):!i||!i.length?l("div",{className:"virtual-list__no-content opacity-text",children:a}):l(Ba,{isItemLoaded:q,itemCount:V,loadMoreItems:I,threshold:2,minimumBatchSize:v,children:({onItemsRendered:P,ref:K})=>l(Ua,{ref:K,outerRef:N,height:w,width:M,itemCount:V,itemSize:T+O,overscanCount:2,onItemsRendered:P,itemKey:ne,itemData:{items:i,itemWidth:B,hasMore:u},onScroll:b,children:de})})}),Va=100,Wa=1,Ha=8,Ka=[],Qa=!1,Ya=!1,Ja="";function Xa({virtualRef:r}){const[e,t]=E.useState(!1),n=E.useRef(null),i=A(N=>N.mainTab===p.FriendsTab.ALL?N.contentTab:N.mainTab),h=A(N=>{switch(i){case p.FriendsTab.MY:return N.myFriends;case p.FriendsTab.ONLINE:return N.onlineFriends;case p.FriendsTab.FOLLOWERS:return N.followers;case p.FriendsTab.BLOCKED:return N.blockedFriends;case p.FriendsTab.OUTGOING_REQUESTS:return N.outgoingRequests;case p.FriendsTab.INCOMING_REQUESTS:return N.incomingRequests;case p.FriendsTab.SEARCH:return N.searchFriends;case p.FriendsTab.COMMON:return N.commonFriends;default:return Ka}}),u=A(N=>{switch(i){case p.FriendsTab.MY:return N.isLoadingMyFriends;case p.FriendsTab.ONLINE:return N.isLoadingOnlineFriends;case p.FriendsTab.FOLLOWERS:return N.isLoadingFollowers;case p.FriendsTab.BLOCKED:return N.isLoadingBlockedFriends;case p.FriendsTab.OUTGOING_REQUESTS:return N.isLoadingOutgoingRequests;case p.FriendsTab.INCOMING_REQUESTS:return N.isLoadingIncomingRequests;case p.FriendsTab.SEARCH:return N.isLoadingPossibleFriends;case p.FriendsTab.COMMON:return N.isLoadingCommonFriends;default:return Qa}}),a=A(N=>{switch(i){case p.FriendsTab.MY:return N.hasMoreMyFriends;case p.FriendsTab.ONLINE:return N.hasMoreOnlineFriends;case p.FriendsTab.FOLLOWERS:return N.hasMoreFollowers;case p.FriendsTab.BLOCKED:return N.hasMoreBlockedFriends;case p.FriendsTab.OUTGOING_REQUESTS:return N.hasMoreOutgoingRequests;case p.FriendsTab.INCOMING_REQUESTS:return N.hasMoreIncomingRequests;case p.FriendsTab.SEARCH:return N.hasMoreSearchFriends;case p.FriendsTab.COMMON:return N.hasMoreCommonFriends;default:return Ya}}),o=A(N=>{switch(i){case p.FriendsTab.MY:return N.searchMyFriends;case p.FriendsTab.ONLINE:return N.searchOnlineFriends;case p.FriendsTab.FOLLOWERS:return N.searchFollowers;case p.FriendsTab.BLOCKED:return N.searchBlockedFriends;case p.FriendsTab.OUTGOING_REQUESTS:return N.searchOutgoingRequests;case p.FriendsTab.INCOMING_REQUESTS:return N.searchIncomingRequests;case p.FriendsTab.SEARCH:return N.searchPossibleFriends;case p.FriendsTab.COMMON:return N.searchCommonFriends;default:return Ja}}),{userId:v}=Pe(),I=Me(v).friendsService;E.useEffect(()=>{Object.values(p.FriendsTab).includes(i)||X.getState().setError(g.t("friends-module.error.unknown_tab",{tab:i}))},[i]);const y=E.useCallback(()=>!a||u?Promise.resolve():new Promise(N=>{I.loadMore(i,()=>N())}),[a,u,i]),b=E.useCallback(({scrollOffset:N})=>{t(N>bn)},[]),C=()=>{r.current?.scrollTop("smooth")},O=E.useCallback(({item:N})=>l(wa,{friend:N},N.id+"item"),[]),T=N=>{C(),I.search(i,N)};return F("div",{className:"friends-list",children:[l(Ea,{haveBorder:!0,placeholder:g.t("friends-module.search_placeholder"),value:o,onChange:T}),(!h||!h.length)&&!u?l(Ta,{}):l($s,{className:"friends-list__container",disablePadding:!0,children:F(Se,{ref:n,className:"friends-list__container__list",children:[l(On,{ref:n,virtualRef:r,items:h,options:{cols:Wa,gap:Ha,itemHeight:Va},hasMore:a,isLoading:u,limit:Sn,loadMore:y,renderCb:O,onScroll:b}),e?l(kn,{onClick:C}):null]})})]})}function ec({virtualRef:r}){const e=A(C=>C.mainTab===p.FriendsTab.ALL),t=A(C=>C.mainTab===p.FriendsTab.ALL?C.contentTab:C.mainTab),n=A(C=>C.countMyFriends),i=A(C=>C.countOnlineFriends),h=A(C=>C.countFollowers),u=A(C=>C.countBlockedFriends),a=A(C=>C.countCommonFriends),{userId:o}=Pe(),v=Te(o),I=Me(o).friendsService,y=v.isMe?`${g.t("friends-module.my_friends")} ${n}`:`${g.t("friends-module.all_friends")} ${n}`;return E.useEffect(()=>{I.getFriends(t)},[t]),F("div",{className:"content",children:[e?F(Us,{centered:!1,value:t,onChange:(C,O)=>{r.current?.scrollTop("instant"),A.getState().setContentTab(O)},"aria-label":"content-tabs",children:[l(ze,{label:y,value:p.FriendsTab.MY,id:"my-friends","aria-controls":"my-friends",className:"content__tab label-tab"},p.FriendsTab.MY),l(ze,{label:`${g.t("friends-module.online_friends")} ${i}`,value:p.FriendsTab.ONLINE,id:"online-friends","aria-controls":"online-friends",className:"content__tab label-tab"},p.FriendsTab.ONLINE),l(ze,{label:`${g.t("friends-module.followers")} ${h}`,value:p.FriendsTab.FOLLOWERS,id:"followers","aria-controls":"followers",className:"content__tab label-tab"},p.FriendsTab.FOLLOWERS),v.isMe?l(ze,{label:`${g.t("friends-module.blocked")} ${u}`,value:p.FriendsTab.BLOCKED,id:"blocked","aria-controls":"blocked",className:"content__tab label-tab"},p.FriendsTab.BLOCKED):l(ze,{label:`${g.t("friends-module.common_friends")} ${a}`,value:p.FriendsTab.COMMON,id:"common","aria-controls":"common",className:"content__tab label-tab"},p.FriendsTab.COMMON)]}):null,l(Xa,{virtualRef:r})]})}const tc=E.memo(function({virtualRef:e}){const t=Me().friendsService,n=A(o=>o.searchFriends),i=A(o=>o.isLoadingPossibleFriends),h=A(o=>o.isLoadingFollowAction);E.useEffect(()=>{t.getFriends(p.FriendsTab.SEARCH)},[]);const u=o=>{t.followFriend(o)};return F(Ue,{children:[l("div",{className:"block-title",onClick:()=>{e.current?.scrollTop("instant"),A.getState().setMainTab(p.FriendsTab.SEARCH)},children:g.t("friends-module.possible_friends")}),l("div",{className:"possible-container__block",children:i&&(!n||!n.length)?l("div",{className:"possible-container__loading",children:l(Ae,{})}):n&&n.length?l($s,{className:"possible-container__list",children:n.slice(0,5).map(o=>F(qs,{className:"possible-container__item",disablePadding:!0,children:[l(js,{className:"possible-container__item-avatar",children:l(cs,{userId:o.id,src:o.avatarUrl,alt:o.fullName})}),l(wn,{className:"possible-container__item-block",primary:o.fullName,secondary:F("span",{className:"possible-container__action",onClick:v=>u(o.id),children:[l(yn,{className:"possible-container__action-icon"}),l("span",{className:"possible-container__action-text",children:h?l(vn,{}):g.t("friends-module.add_to_friends")})]})})]},o.id))}):l("div",{className:"opacity-text",children:g.t("friends-module.no_other_users")})})]})}),sc=E.memo(function({virtualRef:e}){const t=A(I=>I.mainTab),n=A(I=>I.friendsNotification),i=A(I=>I.countOutgoingRequests),h=A(I=>I.countIncomingRequests),u=A(I=>I.countSearchFriends),a=Me().friendsService,o=n?l(xs,{color:"primary",badgeContent:" ",variant:"dot",children:g.t("friends-module.friend_requests")}):`${g.t("friends-module.friend_requests")} ${h}`;return F(Us,{orientation:"vertical",centered:!1,value:t,onChange:(I,y)=>{e.current?.scrollTop("instant"),A.getState().setMainTab(y),a.search(p.FriendsTab.SEARCH,"")},"aria-label":"main-tabs",children:[l(ze,{label:g.t("friends-module.all_friends"),value:p.FriendsTab.ALL,id:"all-friends","aria-controls":"all-friends",className:"main-tabs__tab label-tab"},p.FriendsTab.ALL),l(ze,{label:o,value:p.FriendsTab.INCOMING_REQUESTS,id:"incoming-requests","aria-controls":"incoming-requests",className:"main-tabs__tab label-tab"},p.FriendsTab.INCOMING_REQUESTS),l(ze,{label:`${g.t("friends-module.outgoing_requests")} ${i}`,value:p.FriendsTab.OUTGOING_REQUESTS,id:"outgoing-requests","aria-controls":"outgoing-requests",className:"main-tabs__tab label-tab"},p.FriendsTab.OUTGOING_REQUESTS),l(ze,{label:`${g.t("friends-module.search")} ${u}`,value:p.FriendsTab.SEARCH,id:"search","aria-controls":"search",className:"main-tabs__tab label-tab"},p.FriendsTab.SEARCH)]})});function rc(){const r=E.useRef(null),{userId:e}=Pe(),t=Re(),{isLoading:n,isExistProfile:i}=Zs(),h=A(I=>I.mainTab),u=Te(n||!i?void 0:e),a=Me(n||!i?void 0:e),o=a.friendsService;E.useEffect(()=>{o.getFriends(p.FriendsTab.MY)},[e]);const v=()=>{t(bt(Y.profile,e))};return n||!i?l("div",{className:"user-profile-page-spinner",children:l(Ae,{})}):F(te,{container:!0,spacing:2,className:"friends-container",children:[l(te,{xs:8,className:"friends-container__content",children:l(Ke,{className:"paper-block friends-container__content__wrapper",children:l(ec,{virtualRef:r})})}),l(te,{xs:4,direction:"column",spacing:2,children:F(te,{container:!0,spacing:2,children:[l(te,{children:l(Ke,{className:"paper-block",children:u.isMe?l(sc,{virtualRef:r}):F("div",{className:"friends-container__another-user",children:[l(cs,{userId:a.id,src:a.avatarUrl,alt:a.fullName}),F("div",{className:"friends-container__another-user__info",children:[a.fullName,l(wt,{variant:"body2",onClick:v,underline:"hover",className:"friends-container__another-user__info__link",children:"Перейти к странице"})]})]})})}),h===p.FriendsTab.SEARCH||!u.isMe?null:l(te,{className:"friends-container__possible-friends",children:l(Ke,{className:"paper-block",children:l(tc,{virtualRef:r})})})]})})]})}const Bs=E.memo(function({id:e,text:t,loading:n,multiple:i=!1,onChange:h}){const u=E.useRef(null);return F("label",{htmlFor:e,className:"input-label",onClick:()=>{u.current?.click()},children:[l("input",{ref:u,id:e,type:"file",accept:"image/*",hidden:!0,multiple:i,onChange:h}),l(we,{variant:"outlined",className:"input-label__button",loading:n,disabled:n,children:l(Ie,{variant:"caption",className:"input-label__button__text",children:t})})]})});function Fn({className:r,onClick:e,size:t=24}){const n=typeof t=="number"?`${t}px`:t;return l("svg",{"data-testid":"close-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:n,height:n,className:r,onClick:e,children:l("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}const Jt=E.memo(function({src:e,alt:t,showDeleteIcon:n=!0,isLazy:i=!1,clickHandler:h,deleteHandler:u}){const[a,o]=E.useState(!1),[v,I]=E.useState(!1),{userId:y}=Pe(),b=Cn(e),C=Te(y);return E.useEffect(()=>{C.isMe||o(!0)},[y]),F("div",{className:"photo",onClick:()=>{h&&h()},onMouseEnter:()=>{!a&&n&&e&&e!==is&&I(!0)},onMouseLeave:()=>{!a&&n&&e&&e!==is&&I(!1)},children:[v?l("div",{className:"photo__close-icon",onClick:w=>{v&&u&&(X.getState().setConfirmModal({text:g.t("ui.sure_delete_photo"),btnActionTitle:g.t("ui.delete"),cb:u}),w.stopPropagation())},children:l(Fn,{size:"16"})}):null,l("img",{src:b,alt:t,className:"photo__image",loading:i?"lazy":"eager"})]})}),kr={isPhotosLoading:!1,isAddPhotosLoading:!1,photos:[],count:0,hasMore:!0},Ce=dt(r=>({...kr,setPhotosLoading:e=>r({isPhotosLoading:e}),setAddPhotosLoading:e=>r({isAddPhotosLoading:e}),syncPhotos:({photos:e,count:t,hasMore:n})=>r({photos:e,count:t,hasMore:n}),reset:()=>r({...kr})})),nc=250,oc=3,ic=8;function ac(){const[r,e]=E.useState(!1),t=E.useRef(null),n=E.useRef(null),{isLoading:i,isExistProfile:h}=Zs(),{userId:u}=Pe(),a=Ce(w=>w.photos),o=Ce(w=>w.isPhotosLoading),v=Ce(w=>w.hasMore),I=Ce(w=>w.isAddPhotosLoading),y=Te(i||!h?void 0:u),b=Me(i||!h?void 0:u).photosService;E.useEffect(()=>{Ce.getState().reset()},[u]);const C=E.useCallback(()=>!v||o?Promise.resolve():new Promise(w=>{b.getAllPhotos(w)}),[v,o,b,u]),O=E.useCallback(({scrollOffset:w})=>{e(w>bn)},[]),T=()=>{n.current?.scrollTop()},N=E.useCallback(({item:w,itemWidth:U,itemHeight:V})=>l("div",{className:"photos__container__item",style:{width:U,height:V},children:l(Jt,{src:`${w.path}?w=${U*2}`,alt:w.id,isLazy:!0,clickHandler:()=>b.onClickPhoto(w.id),deleteHandler:()=>b.deletePhoto({photoId:w.id,imageUrl:w.path,isAvatar:!1})})},w.id),[b]),M=w=>{const U=w.target.files;if(U&&U.length){const V=new FormData;Array.from(U).forEach(q=>{V.append("photo",q)}),b.addPhotos(V)}};return i||!h?l("div",{className:"user-profile-page-spinner",children:l(Ae,{})}):l(Ke,{className:"photos paper-block",children:F(Se,{ref:t,className:"photos__container",children:[y.isMe?l(Bs,{id:"photos-add-new-photos",text:g.t("photos-module.add_more"),loading:I,multiple:!0,onChange:M}):null,l(On,{ref:t,virtualRef:n,items:a,options:{cols:oc,gap:ic,itemHeight:nc},hasMore:v,emptyText:g.t("photos-module.empty"),isLoading:o,limit:Ms,loadMore:C,renderCb:N,onScroll:O}),r?l(kn,{onClick:T}):null]})})}const Rn=E.memo(function({labelText:e,loading:t,mustAuth:n=!1,onChange:i,setLoading:h}){const{mainApi:u}=ut(),a=v=>{const I=v.target;if(I&&I.files){const y=I.files[0];y&&(I.value="",o(y))}},o=v=>{const I=new FormData;I.append("avatar",v),u.uploadAvatarAuth(n?p.ApiRoutes.changeAvatar:p.ApiRoutes.uploadAvatar,I,h,y=>{i(y)})};return l(Bs,{id:`change-avatar-${e}`,text:e,loading:t,onChange:a})});function cc(){const{userId:r}=Pe(),e=pe(a=>a.isDeleteAvatarLoading),t=Te(r),n=()=>{t.onClickAvatar()},i=a=>{pe.getState().setDeleteAvatarLoading(a)},h=a=>{t.onSetAvatar(a)},u=()=>{t.onDeleteAvatar()};return l(te,{className:"main-photo",children:F(Ke,{className:`main-photo__container paper-block ${t.isMe?"":"main-photo__container__another-user"}`,children:[l(Jt,{src:t.userService.avatarUrl,alt:"user-avatar",clickHandler:n,deleteHandler:u}),t.isMe?l("div",{className:"main-photo__container__edit-button",children:l(Rn,{labelText:g.t("profile-module.change"),loading:e,mustAuth:!0,onChange:h,setLoading:i})}):null]})})}function lc(r){return Me(r).detailsService}function dc(){const r=me(O=>O.user.fullName),e=me(O=>O.userDetails.birthday),t=me(O=>O.userDetails.city),n=me(O=>O.userDetails.work),i=A(O=>O.countMyFriends),h=A(O=>O.countFollowers),u=Re(),{userId:a}=Pe(),o=Ce(O=>O.count),v=Ce(O=>O.isPhotosLoading),I=Te(a),y=lc(a);E.useEffect(()=>{I.userService.syncInfo()},[a]);const b=O=>{A.getState().setMainTab(p.FriendsTab.ALL),A.getState().setContentTab(O),u(bt(Y.friends,a))},C=()=>{u(bt(Y.photos,a))};return l(te,{children:F(Ke,{className:"info-container paper-block",children:[l("div",{className:"info-container__main-info",children:l("div",{className:"info-container__username",children:r})}),F("div",{className:"info-container__short-info-block",children:[I.isMe?l("div",{className:"info-container__short-info-block__edit",onClick:()=>u(Y.edit),children:g.t("profile-module.edit")}):null,F("div",{className:"info-container__short-info-block__row",children:[F("div",{className:"info-container__short-info-block__row__title",children:[g.t("profile-module.birthday"),":"]}),l("span",{className:"info-container__short-info-block__row__value",children:e})]}),F("div",{className:"info-container__short-info-block__row",children:[F("div",{className:"info-container__short-info-block__row__title",children:[g.t("profile-module.city"),":"]}),l("span",{className:"info-container__short-info-block__row__value",children:t})]}),F("div",{className:"info-container__short-info-block__row",children:[F("div",{className:"info-container__short-info-block__row__title",children:[g.t("profile-module.work"),":"]}),l("span",{className:"info-container__short-info-block__row__value",children:n})]})]}),F("div",{className:"info-container__counts-block",children:[F("div",{className:"info-container__counts-block__count",onClick:()=>b(p.FriendsTab.MY),children:[l("span",{className:"info-container__counts-block__count__value",children:i})," ",y.getFriendsText(i)]}),F("div",{className:"info-container__counts-block__count",onClick:()=>b(p.FriendsTab.FOLLOWERS),children:[l("span",{className:"info-container__counts-block__count__value",children:h})," ",y.getSubscribersText(h)]}),l("div",{className:"info-container__counts-block__count",onClick:C,children:v?l(Ae,{}):F(Ue,{children:[l("span",{className:"info-container__counts-block__count__value",children:o})," ",y.getPhotosText(o)]})}),F("div",{className:"info-container__counts-block__count",children:[l("span",{className:"info-container__counts-block__count__value",children:"0"})," ",y.getAudiosText(0)]}),F("div",{className:"info-container__counts-block__count",children:[l("span",{className:"info-container__counts-block__count__value",children:"0"})," ",y.getVideosText(0)]})]})]})})}const zs=E.memo(function({text:e}){return l("div",{"data-testid":"no-data",className:"opacity-text no-items",children:e})});function uc(){const{userId:r}=Pe(),e=Re(),t=Ce(b=>b.isPhotosLoading),n=Ce(b=>b.isAddPhotosLoading),i=Ce(b=>b.photos),h=Ce(b=>b.count),u=Te(r),a=Me(r).photosService;E.useEffect(()=>{a.getAllPhotos()},[r]);const o=()=>{e(bt(Y.photos,r))},v=b=>{a.onClickPhoto(b)},I=async b=>{const C=b.target.files;if(C&&C.length){const O=new FormData;Array.from(C).forEach(N=>{O.append("photo",N)}),a.addPhotos(O)}},y=b=>{a.deletePhoto({photoId:b.id,imageUrl:b.path,isAvatar:!1},!0)};return l(te,{children:F(Ke,{className:"photo-container paper-block",children:[F("div",{className:"photo-container__title",children:[F("div",{className:"block-title photo-container__title__text",children:[u.isMe?g.t("profile-module.my_photos"):g.t("profile-module.photos"),l("span",{className:"counter",children:h})]}),l(wt,{variant:"body2",onClick:o,underline:"hover",className:"photo-container__title__link",children:g.t("profile-module.watch_all")})]}),t?l(Ae,{}):i&&i.length?l("div",{className:"photo-container__photos",children:i.slice(0,3).map((b,C)=>l("div",{className:"photo-container__photos__wrapper",children:l(Jt,{src:b.path,alt:u.userService.fullName+" "+C,clickHandler:()=>v(b.id),deleteHandler:()=>y(b)},b.id)},b.id))}):l(zs,{text:g.t("profile-module.no_photos")}),u.isMe?l(Bs,{id:"profile-add-new-photos",text:g.t("profile-module.add_more"),loading:n,multiple:!0,onChange:I}):null]})})}const An=E.memo(function({state:e,isLoading:t=!1,children:n,onClickBlock:i}){return l(te,{children:F(Ke,{className:"friends-container paper-block",children:[F("div",{className:"block-title",onClick:i,children:[e.title," ",l("span",{className:"counter",children:e.count})]}),t?l(Ae,{}):e.friends&&e.friends.length?l($s,{className:"friends-container__top-friends__list",children:e.friends.slice(0,6).map(h=>F(qs,{className:"friends-container__top-friends__item",children:[l(js,{className:"friends-container__top-friends__item__avatar-block",children:l(cs,{userId:h.id,src:h.avatarUrl,alt:h.fullName})}),h.fullName.split(" ")[0]]},h.id))}):n]})})}),hc=E.memo(function(){const e=A(o=>o.myFriends),t=A(o=>o.countMyFriends),n=A(o=>o.isLoadingMyFriends),{userId:i}=Pe(),h=Re(),u=Te(i);E.useEffect(()=>{u.getFriendsAndFollowers()},[]);const a=()=>{A.getState().setMainTab(p.FriendsTab.ALL),A.getState().setContentTab(p.FriendsTab.MY),h(bt(Y.friends,i))};return l(An,{state:{title:g.t("profile-module.friends"),count:t,friends:e},isLoading:n,onClickBlock:a,children:l(zs,{text:g.t("profile-module.no_friends")})})}),mc=E.memo(function(){const e=A(u=>u.onlineFriends),{userId:t}=Pe(),n=Re(),i=Te(t);E.useEffect(()=>{i.getOnlineFriends()},[]);const h=()=>{A.getState().setMainTab(p.FriendsTab.ALL),A.getState().setContentTab(p.FriendsTab.ONLINE),n(bt(Y.friends,t))};return l(An,{state:{title:g.t("profile-module.friends_online"),count:e.length,friends:e},onClickBlock:h,children:l(zs,{text:g.t("profile-module.no_online_friends")})})});function fc(){const{isLoading:r,isExistProfile:e}=Zs();return r||!e?l("div",{className:"user-profile-page-spinner",children:l(Ae,{})}):F(te,{container:!0,spacing:2,children:[l(te,{xs:4,className:"profile__left-side",children:F(te,{container:!0,spacing:2,children:[l(cc,{}),l(hc,{}),l(mc,{})]})}),l(te,{xs:8,children:F(te,{container:!0,spacing:2,children:[l(dc,{}),l(uc,{})]})})]})}function Mn({className:r,onClick:e,size:t=24}){const n=typeof t=="number"?`${t}px`:t;return l("svg",{"data-testid":"lock-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:n,height:n,className:r,onClick:e,children:l("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2M9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9zm9 14H6V10h12zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2",fill:"currentColor",stroke:"currentColor",strokeWidth:"0",strokeLinecap:"round",strokeLinejoin:"round"})})}const Ln=E.memo(function({children:e,className:t=""}){return l(pn,{id:"system-avatar",className:`system-avatar ${t}`,alt:"system-avatar",children:e})}),_c=E.memo(function({value:e,id:t,color:n,className:i="",onChange:h}){return l(ni,{value:e,color:n,id:t,className:i,onChange:h})});function Dn(){const r=Re();return F("div",{className:"copyright","data-testid":"copyright",children:[g.t("ui.copyright"),l(wt,{href:Y.aboutUs,variant:"body2",onClick:()=>r(Y.aboutUs),children:g.t("ui.product_name")}),new Date().getFullYear(),"."]})}const wr={signUpErrors:null,signInErrors:!1,signInLoading:!1,signUpLoading:!1,chooseAvatarLoading:!1},Fe=dt(r=>({...wr,setSignUpErrors:e=>r({signUpErrors:e}),setSignInErrors:e=>r({signInErrors:e}),setSignInLoading:e=>r({signInLoading:e}),setSignUpLoading:e=>r({signUpLoading:e}),setChooseAvatarLoading:e=>r({chooseAvatarLoading:e}),reset:()=>r({...wr})})),pc="_mainGrid_iivsr_1",gc="_background_iivsr_5",vc="_signInForm_iivsr_17",yc="_layoutInput_iivsr_23",Sc="_signInForm__checkbox_iivsr_27",bc="_signInForm__checkbox__label_iivsr_31",Ec="_loadingButton_iivsr_40",Cc="_signInNoAccount__grid_iivsr_44",Ic="_signInHelp__grid_iivsr_47",Tc="_secondaryButton_iivsr_53",Nc="_register_iivsr_54",xe={mainGrid:pc,background:gc,signInForm:vc,layoutInput:yc,signInForm__checkbox:Sc,signInForm__checkbox__label:bc,loadingButton:Ec,signInNoAccount__grid:Cc,signInHelp__grid:Ic,secondaryButton:Tc,register:Nc},Or={values:{login:"",password:"",rememberMe:!1},errors:{login:"",password:"",rememberMe:""}};function kc(){const[r,e]=E.useState(!0),[t,n]=E.useState(!1),[i,h]=E.useState(Or),u=Fe(O=>O.signInErrors),a=Fe(O=>O.signInLoading),o=ut(),v=Re();E.useEffect(()=>{o.lifeTimeExpire()},[]),E.useEffect(()=>{u&&I()},[u]),E.useEffect(()=>{e(y())},[a,i]);const I=()=>{n(!0),h({...i,errors:{...i.errors,login:g.t("sign-in.error.incorrect_login_or_password"),password:g.t("sign-in.error.incorrect_login_or_password")}})},y=()=>a||!i.values.login||!i.values.password||Object.values(i.errors).some(Boolean),b=(O,T)=>{h({values:{...i.values,[O]:T},errors:t?{...Or.errors}:{...i.errors,[O]:T||O==="rememberMe"?"":nt}}),Fe.getState().setSignInErrors(!1),n(!1)},C=async O=>{O.preventDefault(),r||o.mainApi.signIn(i.values)};return F(te,{container:!0,component:"main",className:xe.mainGrid,children:[l(te,{className:xe.background,xs:0,sm:4,md:7}),l(te,{xs:12,sm:8,md:5,component:Ke,elevation:6,square:!0,children:F(Se,{className:xe.signInForm,children:[l(Ln,{children:l(Mn,{size:25})}),l(Ie,{component:"h1",variant:"h5",children:g.t("sign-in.sign_in")}),F(Se,{noValidate:!0,component:"form",onSubmit:C,className:xe.layoutInput,children:[l(Oe,{id:"login",name:"login",margin:"normal",variant:"outlined",label:g.t("sign-in.login"),autoComplete:g.t("sign-in.login"),required:!0,fullWidth:!0,autoFocus:!0,error:!!i.errors.login,helperText:i.errors.login?i.errors.login:null,onChange:O=>b("login",O.target.value)}),l(Oe,{id:"password",name:"password",type:"password",margin:"normal",variant:"outlined",label:g.t("sign-in.password"),autoComplete:g.t("sign-in.password"),required:!0,fullWidth:!0,error:!!i.errors.password,helperText:i.errors.password?i.errors.password:null,onChange:O=>b("password",O.target.value)}),F(Se,{className:xe.signInForm__checkbox,children:[l(_c,{value:!1,id:"rememberMe",color:"primary",onChange:O=>b("rememberMe",O.target.checked)}),l("label",{className:xe.signInForm__checkbox__label,htmlFor:"rememberMe",children:g.t("sign-in.remember_me")})]}),l(ot,{fullWidth:!0,type:"submit",variant:"contained",className:xe.loadingButton,loading:a,disabled:r,children:g.t("sign-in.enter")}),F(te,{container:!0,className:xe.signInHelp__grid,children:[l(te,{xs:6,className:xe.signInForget__grid,children:l(wt,{component:"p",variant:"body2",className:xe.secondaryButton,onClick:()=>v(Y.resetPassword),children:g.t("sign-in.forgot_password")})}),l(te,{xs:6,className:xe.signInNoAccount__grid,children:l(wt,{component:"p",variant:"body2",className:xe.register,onClick:()=>v(Y.signUp),children:g.t("sign-in.register")})})]})]}),l(Dn,{})]})})]})}const wc=E.memo(function({steps:e,activeStep:t}){return l(ai,{"data-testid":"stepper",activeStep:t,children:e.map(n=>l(oi,{"data-testid":"step",children:l(ii,{children:n})},n))})}),Oc=E.memo(function({username:e,avatarUrl:t,onChange:n,onChangeAvatar:i}){const[h,u]=E.useState(""),a=Fe(y=>y.chooseAvatarLoading);E.useEffect(()=>{e&&u(e.split(" ").map(y=>y[0]).join(""))},[e]);const o=()=>{n(mr,"")},v=y=>{i(mr,y)},I=y=>{Fe.getState().setChooseAvatarLoading(y)};return l(Se,{id:"choose-avatar",className:"choose-avatar",children:F(te,{container:!0,spacing:2,className:"choose-avatar__container",children:[l(te,{xs:8,children:F(Ie,{className:"choose-avatar__container__main-text",children:[e,", ",g.t("profile-module.how_like_avatar")]})}),l(te,{xs:8,className:"choose-avatar__container__avatar-wrapper",children:a?l(Ae,{}):t?l("div",{className:"choose-avatar__container__avatar",children:l(Jt,{src:t,alt:"user-avatar",deleteHandler:o,showDeleteIcon:!1})}):l("div",{className:"choose-avatar__container__avatar-without-user",children:h})}),l(te,{xs:8,className:"choose-avatar__container__change-photo",children:l(Rn,{labelText:g.t("profile-module.choose_another_photo"),loading:a,onChange:v,setLoading:I})})]})})}),Fc=r=>r.match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),Rc=E.lazy(()=>(Qt(()=>Promise.resolve({}),__vite__mapDeps([10])),Qt(()=>import("./lib-DXytiZKz.js").then(r=>r.l),__vite__mapDeps([11,2])))),Ac=E.memo(function({formValues:e,setFormValues:t,onChange:n}){const i=v=>{t({values:{...e.values,passwordConfirm:v.target.value},errors:{...e.errors,password:v.target.value&&v.target.value===e.values.password?"":v.target.value!==e.values.password?g.t("sign-up-module.password_incorrect"):nt,passwordConfirm:v.target.value&&v.target.value===e.values.password?"":v.target.value!==e.values.password?g.t("sign-up-module.password_incorrect"):nt}})},h=v=>v?v.length<3?g.t("sign-up-module.short_password"):"":nt,u=v=>v?Fc(v)?"":g.t("sign-up-module.incorrect_email"):nt,a=(v,I)=>{if(v){const y=v.match(/\d/g),b=I.format.match(/\./g)?.length;return y&&y.length&&y.length!==b?g.t("sign-up-module.phone_length",{length:b}):""}return nt},o=v=>v?v===e.values.passwordConfirm?"":g.t("sign-up-module.password_incorrect"):nt;return l(Se,{className:"sign-up-form",children:F(te,{container:!0,spacing:2,children:[l(te,{xs:12,sm:6,children:l(Oe,{id:"firstName",name:"firstName",margin:"normal",variant:"outlined",label:g.t("sign-up-module.name"),autoComplete:g.t("sign-up-module.name"),required:!0,fullWidth:!0,autoFocus:!0,error:!!e.errors.firstName,helperText:e.errors.firstName?e.errors.firstName:null,value:e.values.firstName,onChange:v=>n("firstName",v.target.value,h)})}),l(te,{xs:12,sm:6,children:l(Oe,{id:"thirdName",name:"thirdName",margin:"normal",variant:"outlined",label:g.t("sign-up-module.surName"),autoComplete:g.t("sign-up-module.surName"),required:!0,fullWidth:!0,error:!!e.errors.thirdName,helperText:e.errors.thirdName?e.errors.thirdName:null,value:e.values.thirdName,onChange:v=>n("thirdName",v.target.value,h)})}),l(te,{xs:12,children:l(Oe,{id:"email",name:"email",margin:"normal",type:"email",variant:"outlined",label:g.t("sign-up-module.email"),autoComplete:g.t("sign-up-module.email"),required:!0,fullWidth:!0,error:!!e.errors.email,helperText:e.errors.email?e.errors.email:null,value:e.values.email,onChange:v=>n("email",v.target.value,u)})}),F(te,{xs:12,children:[l(E.Suspense,{fallback:l(Nn,{className:"sign-up-form__phone-input__loading"}),children:l(Rc,{country:"ru",inputProps:{id:"phone",name:g.t("sign-up-module.phone"),type:"tel",required:!0},placeholder:g.t("sign-up-module.phone"),searchPlaceholder:g.t("sign-up-module.search"),searchNotFound:g.t("sign-up-module.no_coincidences"),containerClass:`phone-input ${e.errors.phone?"phone-input__error":""}`,specialLabel:g.t("sign-up-module.phone_number"),value:e.values.phone,onChange:(v,I)=>n("phone",v,()=>a(v,I))})}),l("div",{className:"sign-up-form__phone-error-text",children:e.errors.phone?e.errors.phone:null})]}),l(te,{xs:12,children:l(Oe,{id:"password",name:"password",margin:"normal",type:"password",variant:"outlined",label:g.t("sign-up-module.password"),autoComplete:g.t("sign-up-module.password"),required:!0,fullWidth:!0,error:!!e.errors.password,helperText:e.errors.password?e.errors.password:null,value:e.values.password,onChange:v=>n("password",v.target.value,o,"passwordConfirm")})}),l(te,{xs:12,children:l(Oe,{id:"passwordConfirm",name:"passwordConfirm",margin:"normal",type:"password",variant:"outlined",label:g.t("sign-up-module.repeat_password"),autoComplete:g.t("sign-up-module.repeat_password"),required:!0,fullWidth:!0,error:!!e.errors.passwordConfirm,helperText:e.errors.passwordConfirm?e.errors.passwordConfirm:null,value:e.values.passwordConfirm,onChange:i})})]})})}),Mc="_signUpArea_cdoex_1",Lc="_signUpForm_cdoex_6",Dc="_title_cdoex_18",xc="_signInArea_cdoex_22",Uc="_secondaryButton_cdoex_30",Pc="_footerButtonArea_cdoex_37",Zc="_loadingButton_cdoex_47",ct={signUpArea:Mc,signUpForm:Lc,title:Dc,signInArea:xc,secondaryButton:Uc,footerButtonArea:Pc,loadingButton:Zc},bs=[g.t("sign-up.main_step"),g.t("sign-up.choose_avatar_step")],$c={values:{firstName:"",thirdName:"",email:"",phone:"",password:"",passwordConfirm:"",avatarUrl:""},errors:{firstName:"",thirdName:"",email:"",phone:"",password:"",passwordConfirm:"",avatarUrl:""}};function qc(){const[r,e]=E.useState(0),[t,n]=E.useState($c),[i,h]=E.useState(null),u=Fe(w=>w.signUpErrors),a=Fe(w=>w.signUpLoading),o=ut(),v=Re();E.useEffect(()=>{o.removeProfile()},[]),E.useEffect(()=>{u&&I(u)},[u]);const I=({status:w,field:U,message:V,fields:B})=>{let q={};if(w===p.HTTPStatuses.Conflict&&U&&(q={[U]:V}),w===p.HTTPStatuses.BadRequest&&B)for(const ne of B)q={...q,[ne]:g.t("sign-up.error.required_field")};e(0),n({...t,errors:{...t.errors,...q}})},y=()=>{r+1===bs.length?N():e(w=>w+1)},b=()=>{e(w=>w-1)},C=w=>{switch(w){case 0:return Object.values(t.errors).some(Boolean)||Object.values(t.values).map((U,V)=>U===""&&V!==6).some(Boolean);default:return!1}},O=(w,U,V,B)=>{let q="";V&&(q=V(U),q&&n(B?{values:{...t.values,[w]:U},errors:{...t.errors,[w]:q,[B]:q}}:{values:{...t.values,[w]:U},errors:{...t.errors,[w]:q}})),q||n(B?{values:{...t.values,[w]:U},errors:{...t.errors,[w]:q,[B]:""}}:{values:{...t.values,[w]:U},errors:{...t.errors,[w]:""}})},T=(w,U)=>{const{newAvatar:V,newPhoto:B}=U;O(w,V.path),h(B.path)},N=()=>{t.values.phone="+"+t.values.phone.replace(/\s/g,"").replace("(","").replace(")","");const w={firstName:t.values.firstName,thirdName:t.values.thirdName,email:t.values.email,phone:t.values.phone,password:t.values.password,avatarUrl:t.values.avatarUrl,photoUrl:i};o.mainApi.signUp(w)},M=w=>{switch(w){case 0:return l(Ac,{formValues:t,setFormValues:n,onChange:O});case 1:return l(Oc,{username:t.values.firstName+" "+t.values.thirdName,avatarUrl:t.values.avatarUrl,onChange:O,onChangeAvatar:T});default:X.getState().setError(g.t("sign-up.error.step_unknowed",{step:w}));return}};return F(Se,{className:ct.signUpArea,children:[F(Se,{component:"form",noValidate:!0,className:ct.signUpForm,children:[l(Ln,{children:l(Mn,{size:25})}),l(Ie,{className:ct.title,component:"h1",variant:"h5",children:g.t("sign-up.sign_up")}),l(te,{container:!0,className:ct.signInArea,children:l(te,{className:"toSignIn",children:l(wt,{variant:"body2",className:ct.secondaryButton,onClick:()=>v(Y.signIn),component:"p",children:g.t("sign-up.enter")})})}),l(wc,{steps:bs,activeStep:r}),M(r),F(Se,{className:ct.footerButtonArea,children:[l(ot,{fullWidth:!0,className:ct.backButton,disabled:r===0,onClick:b,children:g.t("sign-up.back")}),l(ot,{fullWidth:!0,variant:"contained",className:ct.loadingButton,loading:a,color:"primary",disabled:C(r),onClick:y,children:r===bs.length-1?g.t("sign-up.register"):g.t("sign-up.further")})]})]}),l(Dn,{})]})}const jc=E.memo(function({isAuth:e}){const t=lt(i=>i.redirectTo),n=Re();return E.useEffect(()=>{const i=window.location.pathname,h=t===Y.signIn&&i===Y.signUp;t&&!h&&i!==t&&n(t)},[t]),e?F(ar,{children:[l(Je,{path:Y.profileUser,element:l(fc,{})}),l(Je,{path:Y.edit,element:l(ba,{})}),l(Je,{path:Y.messages,element:l("div",{children:"228"})}),l(Je,{path:Y.friendsUser,element:l(rc,{})}),l(Je,{path:Y.photosUser,element:l(ac,{})}),l(Je,{path:Y.notExists,element:l(ir,{to:Y.profile})})]}):F(ar,{children:[l(Je,{path:Y.signIn,element:l(kc,{})}),l(Je,{path:Y.signUp,element:l(qc,{})}),l(Je,{path:Y.notExists,element:l(ir,{to:Y.signIn})})]})});function Bc({className:r,onClick:e,size:t=24}){const n=typeof t=="number"?`${t}px`:t;return l("svg",{"data-testid":"arrow-left-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:n,height:n,className:r,onClick:e,children:l("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z",fill:"currentColor",stroke:"currentColor",strokeWidth:"0",strokeLinecap:"round",strokeLinejoin:"round"})})}function zc({className:r,onClick:e,size:t=24}){const n=typeof t=="number"?`${t}px`:t;return l("svg",{"data-testid":"arrow-right-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:n,height:n,className:r,onClick:e,children:l("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z",fill:"currentColor",stroke:"currentColor",strokeWidth:"0",strokeLinecap:"round",strokeLinejoin:"round"})})}const Fr={isAvatar:!1,photoIndex:null},Et=dt(r=>({...Fr,setAvatar:e=>r({isAvatar:e}),setIndex:e=>r({photoIndex:e}),changeIndex:e=>r(t=>({photoIndex:t.photoIndex+e})),reset:()=>r({...Fr})})),Rr=E.memo(function({isNext:e,isDisabled:t}){return l(we,{onClick:()=>{Et.getState().changeIndex(e?1:-1)},disabled:t,children:e?F(Ue,{children:[g.t("images-carousel-module.further")," ",l(zc,{})]}):F(Ue,{children:[l(Bc,{})," ",g.t("images-carousel-module.back")]})})}),xn=E.memo(({image:r,activeKey:e,allCount:t})=>l("div",{className:"carousel",children:F("div",{className:"carousel__photo",children:[l(Jt,{src:r.src,alt:r.alt,showDeleteIcon:!1}),t>1?l(ci,{className:"carousel__photo__stepper",variant:"text",position:"static",steps:t,activeStep:e,nextButton:l(Rr,{isNext:!0,isDisabled:e===t-1}),backButton:l(Rr,{isDisabled:!e})}):null]})})),Gc=E.memo(function(){const[e,t]=E.useState(null),n=Ps(),i=Me(n);return E.useEffect(()=>{t({src:i.avatarUrl,alt:i.id,authorName:i.fullName,authorAvatarUrl:i.avatarUrl,dateTime:i.avatarCreateDate})},[i]),e?l(xn,{image:e,activeKey:0,allCount:1}):null}),Vc=5,Wc=E.memo(function(){const[e,t]=E.useState(null),n=Et(a=>a.photoIndex),i=Ps(),h=Me(i),u=h.photosService;return E.useEffect(()=>{if(n!==null){const a=u.photos[n];if(!a){t(null);return}t({src:a.path,alt:a.id,authorName:h.fullName,authorAvatarUrl:h.avatarUrl,dateTime:a.createdAt}),u.photos.length-n-1<=Vc&&u.getAllPhotos()}},[n,h,u]),!e||n===null?null:l(xn,{image:e,activeKey:n,allCount:u.count})}),Hc=E.memo(function({children:e,containerId:t}){return E.useEffect(()=>{if(t&&!document.getElementById(t)){const n=document.createElement("div");n.id=t,document.body.appendChild(n)}},[]),li.createPortal(e,(t?document.getElementById(t):null)??document.body)}),Kc="Escape",ls=E.memo(function({open:e,onClose:t,children:n,className:i="",title:h,description:u,extraContent:a,disableEscapeKeyDown:o=!1}){if(!e)return null;E.useEffect(()=>(document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)),[e,o]);const v=y=>{y.key===Kc&&t?.()},I=y=>{y.stopPropagation()};return l(Hc,{containerId:"modal-root",children:F("div",{className:`modal-overlay ${i}`,onClick:t,role:"dialog","aria-labelledby":h,"aria-describedby":u,children:[a&&l("div",{className:"modal-extra",children:a}),F("div",{className:"modal-content",onClick:I,children:[l(Fn,{size:"24",className:"modal-close",onClick:t}),n]})]})})}),Qc="modal-carousel-title",Yc="modal-carousel-description";function Jc(){const{isAvatar:r,photoIndex:e}=Et(n=>n),t=()=>{Et.getState().reset()};return!r&&(e===null||e<0)?null:F(ls,{open:!0,onClose:t,title:Qc,description:Yc,children:[r&&l(Gc,{}),e!==null&&e>-1&&l(Wc,{})]})}const Ar="modal-confirm-title",Mr="modal-confirm-description";function Xc(){const r=X(n=>n.confirmModal),e=()=>{r&&r.cb&&r.cb(),t()},t=()=>{X.getState().setConfirmModal(null)};return r?l(ls,{open:!0,onClose:t,title:Ar,description:Mr,children:F(Se,{className:"modal-confirm-container",children:[l(Ie,{id:Ar,variant:"subtitle1",component:"h2",children:r.text}),F(Ie,{id:Mr,className:"modal-confirm-container__buttons",children:[l(we,{variant:"outlined",color:"primary",onClick:e,children:r.btnActionTitle}),l(we,{variant:"outlined",color:"error",onClick:t,children:g.t("modals.cancel")})]})]})}):null}const Un=E.memo(function({anchor:e,message:t,open:n,handleClose:i,children:h}){return l(di,{anchorOrigin:e,open:n,onClose:i,message:t,autoHideDuration:zi,children:h},t+e.toString()+n)}),el="modal-error-title",tl="modal-error-description",sl={vertical:"bottom",horizontal:"left"};function rl(){const r=X(v=>v.error),[e,t]=E.useState(!1),n=ut(),i=Re(),h=()=>{r&&navigator.clipboard.writeText(r).then(()=>t(!0)).catch(v=>{X.getState().setError(g.t("modals.error.copy")+v)})},u=()=>{X.getState().setError(null)},a=()=>{n.downloadLogFile()},o=()=>{i(0)};return r?F(Ue,{children:[l(Un,{anchor:sl,open:e,message:g.t("modals.copy_successfull"),handleClose:()=>t(!1)}),l(ls,{open:!0,onClose:u,title:el,description:tl,disableEscapeKeyDown:!0,children:F(Se,{className:"modal-error-container",children:[l(Ie,{variant:"h6",component:"h2",children:g.t("modals.error.server")}),l(Ie,{className:"modal-error-container__text",children:g.t("modals.copy_the_message_and_send_to_email",{email:Li})}),l("div",{className:"modal-error-container__error",onClick:h,children:r}),F("div",{className:"modal-error-container__buttons",children:[l(ot,{variant:"contained",startIcon:l(ui,{}),onClick:a,children:g.t("modals.download")}),l(ot,{variant:"outlined",startIcon:l(hi,{}),onClick:o,children:g.t("modals.reset_page")})]})]})})]}):null}const Es=E.memo(function({name:e,checked:t,onChange:n}){return l(mi,{name:e,checked:t,onChange:n})}),nl=E.memo(function({form:e,onChange:t}){const n=i=>{t(i.target.name,i.target.checked)};return F(fi,{className:"settings-form",children:[l(ps,{control:l(Es,{checked:e.soundEnabled,onChange:n,name:"soundEnabled"}),label:g.t("modals.soundEnabled")}),l(ps,{control:l(Es,{checked:e.messageSound,onChange:n,name:"messageSound"}),label:g.t("modals.messageSound")}),l(ps,{control:l(Es,{checked:e.friendRequestSound,onChange:n,name:"friendRequestSound"}),label:g.t("modals.friendRequestSound")})]})}),Lr="modal-settings-title",ol="modal-settings-description";function il(){const[r,e]=E.useState(null),t=pe(y=>y.isDeleteAccountLoading),n=X(y=>y.settingsModal),i=X(y=>y.saveSettingsModal),h=Te(),u=Me().settingsService;E.useEffect(()=>{e(n&&u?{soundEnabled:u.soundEnabled,messageSound:u.messageSound,friendRequestSound:u.friendRequestSound}:null)},[n,u]);const a=(y,b)=>{e(C=>({...C,[y]:b}))},o=()=>{X.getState().setConfirmModal({text:g.t("ui.sure_delete_account"),btnActionTitle:g.t("ui.delete"),cb:()=>h.deleteAccount()})},v=()=>{u&&r&&u.changeSoundNotifications(r)},I=()=>{X.getState().setSettingsModal(!1)};return!n||!r?null:l(ls,{open:!0,onClose:I,title:Lr,description:ol,children:F(Se,{className:"modal-settings-container",children:[l("div",{className:"modal-settings-container__header",children:l(Ie,{id:Lr,variant:"subtitle1",component:"h2",children:g.t("modals.settings")})}),F("div",{className:"modal-settings-container__content",children:[l(nl,{form:r,onChange:a}),F("div",{className:"modal-settings-container__content__delete-account",children:[l(Ie,{variant:"body1",component:"h2",children:g.t("modals.delete-account-title")}),l(Ie,{variant:"body2",component:"h4",children:g.t("modals.delete-account-text")}),l(we,{variant:"outlined",color:"error",loading:t,onClick:o,children:g.t("modals.delete-account")})]})]}),F("div",{className:"modal-settings-container__buttons",children:[l(we,{variant:"outlined",color:"primary",loading:i,onClick:v,children:g.t("modals.save")}),l(we,{variant:"outlined",color:"error",onClick:I,children:g.t("modals.cancel")})]})]})})}const al={vertical:"bottom",horizontal:"left"};function cl(){const r=X(t=>t.snackbarError),e=()=>{X.getState().setSnackbarError(null)};return r?l(Un,{anchor:al,open:!0,handleClose:e,children:l(gn,{severity:"error",children:r})}):null}const ll=E.memo(function({isAuth:e}){return F(Ue,{children:[l(rl,{}),l(Xc,{}),l(cl,{}),e?F(Ue,{children:[l(Jc,{}),l(il,{})]}):null]})});function dl(){const r=me(t=>t.isUserLoading),e=me(t=>t.user);return F("div",{className:"root",children:[l(ll,{isAuth:!!e}),r?l(Ae,{}):F(Ue,{children:[e?l(Ji,{}):null,l("div",{className:`root__wrapper ${e?"":"root__no-auth"}`,children:F("div",{className:"root__wrapper__container",children:[e?l(ea,{}):null,l(Ci,{children:l(jc,{isAuth:!!e})})]})})]})]})}const Pn=()=>{me.getState().reset(),lt.getState().reset(),X.getState().reset(),Et.getState().reset(),Fe.getState().reset(),pe.getState().reset(),Ce.getState().reset(),A.getState().reset()},Dr=ge.init("CatchErrors"),Cs=g.t("core.catch-errors.error"),ul=g.t("core.catch-errors.error.timeout"),hl=g.t("core.catch-errors.error.network"),ml=g.t("core.catch-errors.error.bad_request"),fl=g.t("core.catch-errors.error.canceled"),_l=g.t("core.catch-errors.error.unknown");class pl{_errorText;_axiosError;_response;constructor(){Dr.debug("init")}catchAxios(e){this._axiosError=e;const{response:t,code:n,message:i=Cs}=this._axiosError;if(t){switch(this._response=t,this._errorText=t.data.message||Cs,t.status){case p.HTTPStatuses.PermanentRedirect:{this._permanentRedirect();break}case p.HTTPStatuses.BadRequest:{this._badRequest();break}case p.HTTPStatuses.Unauthorized:{this._unAuthorized();break}case p.HTTPStatuses.Forbidden:{this._forbidden();break}case p.HTTPStatuses.NotFound:{this._notFound();break}case p.HTTPStatuses.Conflict:{this._conflict();break}case p.HTTPStatuses.PayloadTooLarge:{this._payloadTooLarge();break}case p.HTTPStatuses.TooManyRequests:{this._tooManyRequests();break}case p.HTTPStatuses.ServerError:case p.HTTPStatuses.ServiceUnavailable:default:this._serverError()}return}if(n){this._errorHandler();return}this._errorText=i,this._handleError()}_errorHandler(){const{code:e,message:t}=this._axiosError;let n;switch(e){case Kt.ERR_NETWORK:{n=ul;break}case Kt.ERR_TIMEOUT:{n=hl;break}case Kt.ERR_BAD_REQUEST:{n=ml;break}case Kt.ERR_CANCELED:{n=fl;break}default:n=_l+t}this._errorText=n,this._handleError()}_permanentRedirect(){lt.getState().setRedirectTo(Y.profile)}_badRequest(){const{type:e,fields:t,field:n}=this._response.data.options;switch(e){case p.HTTPErrorTypes.SIGN_UP:{Fe.getState().setSignUpErrors({status:this._response.status,fields:t});break}case p.HTTPErrorTypes.EDIT_INFO:{pe.getState().setEditErrors({field:n,fields:t});break}default:this._handleError()}}_unAuthorized(){switch(this._response.data.options.type){case p.HTTPErrorTypes.SIGN_IN:{Fe.getState().setSignInErrors(!0);break}default:this._redirect()}}_forbidden(){this._redirect()}_notFound(){this._handleError()}_conflict(){const{message:e=Cs,options:t}=this._response.data,{type:n,field:i}=t;switch(n){case p.HTTPErrorTypes.SIGN_UP:{Fe.getState().setSignUpErrors({status:this._response.status,field:i,message:e});break}default:this._handleError()}}_payloadTooLarge(){this._systemError()}_tooManyRequests(){this._systemError()}_serverError(){this._handleError()}_redirect(){Pn()}_systemError(){X.getState().setSnackbarError(this._response.data.message)}_handleError(){Dr.error(this._errorText),X.getState().setError(this._errorText)}}let gl=class{constructor(e,t,n,i,h,u,a,o){this._myFriends=e,this._onlineFriends=t,this._followers=n,this._outgoingRequests=i,this._incomingRequests=h,this._searchFriends=u,this._blockedUsers=a,this._commonFriends=o}get myFriends(){return this._myFriends}get onlineFriends(){return this._onlineFriends}get followers(){return this._followers}get outgoingRequests(){return this._outgoingRequests}get incomingRequests(){return this._incomingRequests}get searchFriends(){return this._searchFriends}get blockedUsers(){return this._blockedUsers}get commonFriends(){return this._commonFriends}getFriends(e){switch(e){case p.FriendsTab.MY:this._myFriends.getAll();break;case p.FriendsTab.ONLINE:this._onlineFriends.getAll();break;case p.FriendsTab.FOLLOWERS:this._followers.getAll();break;case p.FriendsTab.OUTGOING_REQUESTS:this._outgoingRequests.getAll();break;case p.FriendsTab.INCOMING_REQUESTS:this._incomingRequests.getAll();break;case p.FriendsTab.SEARCH:this._searchFriends.getAll();break;case p.FriendsTab.BLOCKED:this._blockedUsers.getAll();break;case p.FriendsTab.COMMON:this._commonFriends.getAll();break;default:X.getState().setError(g.t("friends-module.error.unknown_tab",{tab:e}))}}loadMore(e,t){switch(e){case p.FriendsTab.MY:this._myFriends.loadMore(t);break;case p.FriendsTab.ONLINE:this._onlineFriends.loadMore(t);break;case p.FriendsTab.FOLLOWERS:this._followers.loadMore(t);break;case p.FriendsTab.OUTGOING_REQUESTS:this._outgoingRequests.loadMore(t);break;case p.FriendsTab.INCOMING_REQUESTS:this._incomingRequests.loadMore(t);break;case p.FriendsTab.SEARCH:this._searchFriends.loadMore(t);break;case p.FriendsTab.BLOCKED:this._blockedUsers.loadMore(t);case p.FriendsTab.COMMON:this._commonFriends.loadMore(t);break;default:X.getState().setError(g.t("friends-module.error.unknown_tab",{tab:e}))}}search(e,t){switch(e){case p.FriendsTab.MY:this._myFriends.search(t);break;case p.FriendsTab.ONLINE:this._onlineFriends.search(t);break;case p.FriendsTab.FOLLOWERS:this._followers.search(t);break;case p.FriendsTab.OUTGOING_REQUESTS:this._outgoingRequests.search(t);break;case p.FriendsTab.INCOMING_REQUESTS:this._incomingRequests.search(t);break;case p.FriendsTab.SEARCH:this._searchFriends.search(t);break;case p.FriendsTab.BLOCKED:this._blockedUsers.search(t);break;case p.FriendsTab.COMMON:this._commonFriends.search(t);break;default:X.getState().setError(g.t("friends-module.error.unknown_tab",{tab:e}))}}};function Ds(r,e){let t=null;return function(...n){t!==null&&clearTimeout(t),t=setTimeout(()=>{r.apply(this,n)},e)}}class Ve{constructor(e,t){this._request=e,this._userId=t,this._debouncedMoreFetch=Ds(Ve.prototype.getAll.bind(this),Ls.LOAD_MORE),this._debouncedSearchFetch=Ds(Ve.prototype.getAll.bind(this),Ls.SEARCH)}items=[];hasMore=!0;count=0;searchValue="";_debouncedMoreFetch;_debouncedSearchFetch;_done=void 0;setCount(e){this.count=e}getAll({route:e,page:t,data:n,setLoading:i,successCb:h}){const u=this.items[this.items.length-1],a=u?.newest?void 0:u?.createdAt;this._request.post({route:e,data:{...n,userId:this._userId,limit:Sn,lastCreatedAt:a,search:this.searchValue,page:t},setLoading:i,successCb:o=>{this.count=o.count,this.hasMore=o.hasMore,h(o),this._done?.()}})}loadMore(e){this._done=e}search(e){e!==this.searchValue&&(this.items=[]),this.searchValue=e}getMoreByDebounce(e){this._debouncedMoreFetch(e)}getByDebounce(e){this._debouncedSearchFetch(e)}add(e){this.find(e.id)||(this.items.unshift({...e,newest:!0}),this.count+=1)}remove(e){this.items=this.items.filter(t=>t.id!==e),this.count=this.count?this.count-1:0}find(e){return this.items.find(t=>t.id===e)}}class vl extends Ve{constructor(e){super(e),this._request=e}get _params(){return{route:p.ApiRoutes.getBlockedFriends,setLoading:e=>{A.getState().setIsLoadingBlockFriends(e)},successCb:e=>{const t=e.blockedFriends.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}getAll(){if(!this.hasMore||this.items.length){this.syncStore();return}super.getAll(this._params)}loadMore(e){super.loadMore(e),this.getMoreByDebounce(this._params)}search(e){super.search(e),A.getState().setSearchBlockedFriends(this.searchValue),this.getByDebounce(this._params)}unblock(e,t){this._request.post({route:p.ApiRoutes.unblockFriend,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingUnblockAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),this.syncStore())}})}syncStore(){A.getState().setBlockedFriends({items:[...this.items],hasMore:this.hasMore,count:this.count})}}class yl extends Ve{constructor(e,t){super(e,t),this._request=e,this._userId=t}get _params(){return{route:p.ApiRoutes.getCommonFriends,setLoading:e=>{A.getState().setIsLoadingCommonFriends(e)},successCb:e=>{const t=e.commonFriends.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}getAll(){if(!this.hasMore||this.items.length){this.syncStore();return}super.getAll(this._params)}loadMore(e){super.loadMore(e),this.getMoreByDebounce(this._params)}search(e){super.search(e),A.getState().setSearchCommonFriends(this.searchValue),this.getByDebounce(this._params)}syncStore(){A.getState().setCommonFriends({items:[...this.items],hasMore:this.hasMore,count:this.count})}}class Sl extends Ve{constructor(e,t){super(e,t),this._request=e,this._userId=t}get _params(){return{route:p.ApiRoutes.getFollowers,setLoading:e=>{A.getState().setIsLoadingFollowers(e)},successCb:e=>{const t=e.followers.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}getAll(){if(!this.hasMore||this.items.length){this.syncStore();return}super.getAll(this._params)}loadMore(e){super.loadMore(e),this.getMoreByDebounce(this._params)}search(e){super.search(e),A.getState().setSearchFollowers(this.searchValue),this.getByDebounce(this._params)}addFriend(e,t){this._request.post({route:p.ApiRoutes.addFriend,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingAddFriendAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),this.syncStore())}})}syncStore(){A.getState().setFollowers({items:[...this.items],hasMore:this.hasMore,count:this.count})}}class bl extends Ve{constructor(e){super(e),this._request=e}get _params(){return{route:p.ApiRoutes.getIncomingRequests,setLoading:e=>{A.getState().setIsLoadingIncomingRequests(e)},successCb:e=>{const t=e.incomingRequests.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}getAll(){if(!this.hasMore||this.items.length){this.syncStore();return}super.getAll(this._params)}loadMore(e){super.loadMore(e),this.getMoreByDebounce(this._params)}search(e){super.search(e),A.getState().setSearchIncomingRequests(this.searchValue),this.getByDebounce(this._params)}accept(e,t){this._request.post({route:p.ApiRoutes.acceptFriendRequest,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingAcceptAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),A.getState().removeFriendsNotification(),this.syncStore())}})}leftInFollowers(e,t){this._request.post({route:p.ApiRoutes.leftInFollowers,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingLeftInFollowersAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),A.getState().removeFriendsNotification(),this.syncStore())}})}syncStore(){A.getState().setIncomingRequests({items:[...this.items],hasMore:this.hasMore,count:this.count})}}class El extends Ve{constructor(e,t){super(e,t),this._request=e,this._userId=t}get _params(){return{route:p.ApiRoutes.getMyFriends,setLoading:e=>{A.getState().setIsLoadingMyFriends(e)},successCb:e=>{const t=e.myFriends.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}getAll(){const e=A.getState().isLoadingMyFriends;if(!this.hasMore||this.items.length||e){this.syncStore();return}super.getAll(this._params)}loadMore(e){super.loadMore(e),this.getMoreByDebounce(this._params)}search(e){super.search(e),A.getState().setSearchMyFriends(this.searchValue),this.getByDebounce(this._params)}writeMessage(e){console.log("writeMessage",e)}deleteFriend(e,t){this._request.post({route:p.ApiRoutes.deleteFriend,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingDeleteFriendAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),this.syncStore())}})}blockFriend(e,t){this._request.post({route:p.ApiRoutes.blockFriend,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingBlockFriendAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),this.syncStore())}})}syncStore(){A.getState().setMyFriends({items:[...this.items],hasMore:this.hasMore,count:this.count})}}class Gs extends Ve{constructor(e,t){super(e,t),this._request=e,this._userId=t,this._debouncedSearch=Ds(Gs.prototype._prepareSearch.bind(this),Ls.SEARCH)}_userIds=[];_debouncedSearch;get _params(){return{route:p.ApiRoutes.checkOnlineUser,data:{ids:this._userIds},setLoading:e=>{A.getState().setIsLoadingOnlineFriends(e)},successCb:e=>{const t=e.onlineFriends.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}checkUsers(e){e&&e.length?(this._userIds=e.map(t=>t.id),super.getAll(this._params)):this._userIds=[]}removeUser(e){this.remove(e),this.syncStore()}getAll(){this.syncStore()}loadMore(e){this.syncStore(),e()}search(e){super.search(e),A.getState().setSearchMyFriends(this.searchValue),this._debouncedSearch()}_prepareSearch(){const e=this.items.filter(t=>t.fullName.toLowerCase().includes(this.searchValue.toLowerCase()));A.getState().setOnlineFriends({items:[...e],hasMore:this.hasMore,count:this.count})}syncStore(){A.getState().setOnlineFriends({items:[...this.items],hasMore:this.hasMore,count:this.count})}}class Cl extends Ve{constructor(e){super(e),this._request=e}get _params(){return{route:p.ApiRoutes.getOutgoingRequests,setLoading:e=>{A.getState().setIsLoadingOutgoingRequests(e)},successCb:e=>{const t=e.outgoingRequests.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}getAll(){if(!this.hasMore||this.items.length){this.syncStore();return}super.getAll(this._params)}loadMore(e){super.loadMore(e),this.getMoreByDebounce(this._params)}search(e){super.search(e),A.getState().setSearchOutgoingRequests(this.searchValue),this.getByDebounce(this._params)}unfollow(e,t){this._request.post({route:p.ApiRoutes.unfollow,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingUnfollowAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),this.syncStore())}})}syncStore(){A.getState().setOutgoingRequests({items:[...this.items],hasMore:this.hasMore,count:this.count})}}class Il extends Ve{constructor(e){super(e),this._request=e}_page=0;get _params(){return{route:p.ApiRoutes.getPossibleFriends,page:this._page,setLoading:e=>{A.getState().setIsLoadingPossibleFriends(e)},successCb:e=>{const t=e.possibleFriends.map(oe).filter(n=>!this.items.some(i=>i.id===n.id));this.items.push(...t),this.syncStore()}}}_get(){super.getAll(this._params)}getAll(){if(!this.hasMore||this.items.length){this.syncStore();return}this._get()}loadMore(e){this._page+=1,super.loadMore(e),this._get()}search(e){e!==this.searchValue&&(this._page=0),super.search(e),A.getState().setSearchPossibleFriends(this.searchValue),this.getByDebounce(this._params)}follow(e,t){this._request.post({route:p.ApiRoutes.followFriend,data:{friendId:e},setLoading:n=>{A.getState().setIsLoadingFollowAction(n)},successCb:()=>{const n=this.find(e);n&&(this.remove(e),t(n),this.syncStore())}})}syncStore(){A.getState().setPossibleFriends({items:[...this.items],count:this.count,hasMore:this.hasMore})}}class Tl{constructor(e,t){this._request=e,this._userId=t}createFriendsManager(){return new El(this._request,this._userId)}createOnlineFriendsManager(){return new Gs(this._request,this._userId)}createFollowersManager(){return new Sl(this._request,this._userId)}createOutgoingRequestsManager(){return new Cl(this._request)}createIncomingRequestsManager(){return new bl(this._request)}createSearchService(){return new Il(this._request)}createBlockedUsersManager(){return new vl(this._request)}createCommonFriendsManager(){return new yl(this._request,this._userId)}}class Nl{constructor(e,t){this._request=e,this._userId=t,this._factory=new Tl(this._request,this._userId),this._friendsController=new gl(this._factory.createFriendsManager(),this._factory.createOnlineFriendsManager(),this._factory.createFollowersManager(),this._factory.createOutgoingRequestsManager(),this._factory.createIncomingRequestsManager(),this._factory.createSearchService(),this._factory.createBlockedUsersManager(),this._factory.createCommonFriendsManager()),this._getAllCounts()}_friendsController;_factory;get friendsController(){return this._friendsController}_getAllCounts(){this._request.post({route:p.ApiRoutes.getAllCounts,data:{userId:this._userId},successCb:e=>{this._friendsController.myFriends.setCount(e.countMyFriends),this._friendsController.followers.setCount(e.countFollowers),this._friendsController.outgoingRequests.setCount(e.countOutgoingRequests),this._friendsController.incomingRequests.setCount(e.countIncomingRequests),this._friendsController.searchFriends.setCount(e.countSearchFriends),this._friendsController.blockedUsers.setCount(e.countBlockedFriends),this._friendsController.commonFriends.setCount(e.countCommonFriends),A.getState().setAllCounts(e)}})}checkOnlineUsers(e){this._friendsController.onlineFriends.checkUsers(e)}removeOnlineUser(e){this._friendsController.onlineFriends.removeUser(e)}getFriends(e){this._friendsController.getFriends(e)}loadMore(e,t){this._friendsController.loadMore(e,t)}search(e,t){this._friendsController.search(e,t)}followFriend(e){this._friendsController.searchFriends.follow(e,t=>{this._friendsController.outgoingRequests.add(t),this._friendsController.outgoingRequests.syncStore()})}writeMessage(e){this._friendsController.myFriends.writeMessage(e)}deleteFriend(e){this._friendsController.myFriends.deleteFriend(e,t=>{this._friendsController.followers.add(t),this._friendsController.followers.syncStore(),this._friendsController.onlineFriends.removeUser(t.id)})}blockFriend(e){this._friendsController.myFriends.blockFriend(e,t=>{this._friendsController.blockedUsers.add(t),this._friendsController.blockedUsers.syncStore(),this._friendsController.onlineFriends.removeUser(t.id)})}unblock(e){this._friendsController.blockedUsers.unblock(e,t=>{this._friendsController.searchFriends.add(t),this._friendsController.searchFriends.syncStore()})}addFriend(e){this._friendsController.followers.addFriend(e,t=>{this._friendsController.myFriends.add(t),this._friendsController.myFriends.syncStore()})}accept(e){this._friendsController.incomingRequests.accept(e,t=>{this._friendsController.myFriends.add(t),this._friendsController.myFriends.syncStore()})}leftInFollowers(e){this._friendsController.incomingRequests.leftInFollowers(e,t=>{this._friendsController.followers.add(t),this._friendsController.followers.syncStore()})}unfollow(e){this._friendsController.outgoingRequests.unfollow(e,t=>{this._friendsController.searchFriends.add(t),this._friendsController.searchFriends.syncStore()})}}const kl=ge.init("NotificationSettings");class wl{constructor(e,t){this._request=e,this._settings=t,kl.debug("init")}get soundEnabled(){return!!this._settings.soundEnabled}get messageSound(){return!!this._settings.messageSound}get friendRequestSound(){return!!this._settings.friendRequestSound}changeSoundNotifications(e){this._request.put({route:p.ApiRoutes.soundNotifications,data:{...e,userId:this._settings.userId},setLoading:t=>{X.getState().setSaveSettingsModal(t)},successCb:()=>{this._settings={userId:this._settings.userId,...e},X.getState().setSaveSettingsModal(!1),X.getState().setSettingsModal(!1)}})}}const xr=ge.init("PhotosService");class Ol{constructor(e,t){this._request=e,this._userId=t,xr.debug("init")}_photos=[];_hasMore=!0;_count=0;get photos(){return this._photos}get count(){return this._count}getAllPhotos(e){if(!this._hasMore){this._syncStorePhotos();return}const t=this._photos[this._photos.length-1]?this._photos[this._photos.length-1].createdAt:null;this._request.post({route:p.ApiRoutes.getPhotos,data:{userId:this._userId,lastCreatedDate:t,limit:Ms},setLoading:n=>{Ce.getState().setPhotosLoading(n)},successCb:({photos:n,count:i})=>{this._count=i,this._photos.push(...n),this._hasMore=this._photos.length<i,xr.debug(`get all photos [current count: ${this._photos.length}, all count: ${i}]`),this._syncStorePhotos(),e?.()}})}onClickPhoto(e){const t=this._photos.findIndex(n=>n.id===e);this._photos&&this._photos.length&&t>-1&&Et.getState().setIndex(t)}addPhotoFromAvatar(e){this._photos.unshift(e),this._count+=1,this._syncStorePhotos()}addPhotos(e){this._request.post({route:p.ApiRoutes.savePhotos,data:e,setLoading:t=>{Ce.getState().setAddPhotosLoading(t)},successCb:({photos:t})=>{this._photos=t.concat(this._photos),this._count+=t.length,this._syncStorePhotos()},config:{headers:{"Content-Type":"multipart/form-data"}}})}deletePhoto(e,t=!1){this._request.post({route:p.ApiRoutes.deletePhoto,data:e,successCb:()=>{if(this._photos.findIndex(i=>i.id===e.photoId)===-1){X.getState().setError("Произошла ошибка при удалении фотографии. Фотография не найдена.");return}this._photos=this._photos.filter(i=>i.id!==e.photoId),this._count-=1,this._photos.length<Ms&&this._hasMore&&t?this.getAllPhotos():this._syncStorePhotos()}})}_syncStorePhotos(){Ce.getState().syncPhotos({photos:this._photos,count:this._count,hasMore:this._hasMore})}}const Ur=ge.init("UserDetails"),ss=g.t("profile-module.not_complete");class Fl{constructor(e){this._userDetails=e,Ur.debug("init UserDetailsService"),this._updateDetails(this._userDetails)}_details;get _userId(){return this._details.userId}get _sex(){return this._details?.sex||ss}get _birthday(){return this._transformBirthday()}get _city(){return this._details?.city||ss}get _work(){return this._details?.work||ss}get _lastSeen(){return this._details?.lastSeen||""}get _editSex(){return this._details?.sex||""}get _editBirthday(){return this._transformBirthday(!0)}get _editCity(){return this._details?.city||""}get _editWork(){return this._details?.work||""}updateDetails(e){Ur.debug(`editDetails [detailsUserId=${e.userId}]`),this._updateDetails({...this._details,...e})}syncUserDetails(){this._updateDetails(this._details)}getFriendsText(e){return this._getText(e,[g.t("profile-module.friends_count_0"),g.t("profile-module.friends_count_1"),g.t("profile-module.friends_count_2")])}getSubscribersText(e){return this._getText(e,[g.t("profile-module.subscribers_count_0"),g.t("profile-module.subscribers_count_1"),g.t("profile-module.subscribers_count_2")])}getPhotosText(e){return this._getText(e,[g.t("profile-module.photos_count_0"),g.t("profile-module.photos_count_1"),g.t("profile-module.photos_count_2")])}getAudiosText(e){return this._getText(e,[g.t("profile-module.audios_count_0"),g.t("profile-module.audios_count_1"),g.t("profile-module.audios_count_2")])}getVideosText(e){return this._getText(e,[g.t("profile-module.videos_count_0"),g.t("profile-module.videos_count_1"),g.t("profile-module.videos_count_2")])}_updateDetails(e){this._details=e,me.getState().setUserDetails({userDetails:{userId:this._userId,sex:this._sex,birthday:this._birthday,city:this._city,work:this._work,lastSeen:this._lastSeen},editUserDetails:{sex:this._editSex,birthday:this._editBirthday,city:this._editCity,work:this._editWork}})}_transformBirthday(e=!1){if(!this._details||!this._details.birthday)return e?"":ss;const t=this._details.birthday.split("-");return e?this._details.birthday:t[2]+fa(+t[1]-1)+". "+t[0]}_getText(...e){return Wi(...e)}}const Is=ge.init("User");class Rl{constructor(e,t){this._request=e,this._userData=t,Is.debug("init");const{user:n,userDetails:i,notificationSettings:h}=this._userData;this._updateUser(n),this._updateMyAvatar(),this._userDetails=new Fl(i),this._userData.isMe&&h&&(this._notificationSettings=new wl(this._request,h)),this._photos=new Ol(this._request,this._user.id),this._friends=new Nl(this._request,this._user.id)}_user;_userDetails;_notificationSettings;_photos;_friends;get friendsService(){return this._friends}get photosService(){return this._photos}get detailsService(){return this._userDetails}get settingsService(){return this._notificationSettings}get id(){return this._user.id}get firstName(){return this._user.firstName}get secondName(){return this._user.secondName||""}get thirdName(){return this._user.thirdName}get phone(){return this._user.phone}get email(){return this._user.email}get fullName(){return this._user.firstName+" "+this._user.thirdName}get avatarUrl(){return this._user.avatarUrl||""}get avatarCreateDate(){return this._user.avatarCreateDate||""}updateUser({user:e,userDetails:t}){Is.debug("updateUser"),this._updateUser({...this._user,...e}),this._userDetails.updateDetails(t)}syncInfo(){this._updateUser(this._user),this._userDetails.syncUserDetails()}changeAvatar(e){Is.debug(`changeAvatar [value=${e?.path}]`),this._updateUser({...this._user,avatarUrl:e?.path||null,avatarCreateDate:e?.createdAt||null})}_updateUser(e){this._user=e,me.getState().setUser({id:this.id,firstName:this.firstName,secondName:this.secondName,thirdName:this.thirdName,phone:this.phone,email:this.email,fullName:this.fullName,avatarUrl:this.avatarUrl,avatarCreateDate:this.avatarCreateDate})}_updateMyAvatar(){this._userData.isMe&&me.getState().setMyAvatar({src:this.avatarUrl,alt:this.fullName,userId:this.id})}}const Pr=ge.init("Profile");class Al{constructor(e,t){this._request=e,this._userData=t,Pr.debug("init"),this._isMe=!!this._userData.isMe,this._user=new Rl(this._request,this._userData)}_user;_isMe;get isMe(){return this._isMe}get userService(){return this._user}get photosService(){return this._user.photosService}deleteAccount(){this._request.get({route:p.ApiRoutes.deleteAccount,setLoading:e=>{pe.getState().setDeleteAccountLoading(e)},successCb:()=>{pe.getState().setDeleteAccountLoading(!1),X.getState().setSettingsModal(!1)}})}onSetAvatar({newAvatar:e,newPhoto:t}){Pr.debug(`onSetAvatar [newAvatar=${e.path}]`),this._user.changeAvatar(e),this._user.photosService.addPhotoFromAvatar(t)}onDeleteAvatar(){this._request.post({route:p.ApiRoutes.deletePhoto,data:{imageUrl:this._user.avatarUrl},setLoading:e=>{pe.getState().setDeleteAvatarLoading(e)},successCb:()=>{this._user.changeAvatar()}})}onClickAvatar(){Et.getState().setAvatar(!0)}getFriendsAndFollowers(){this.userService.friendsService.getFriends(p.FriendsTab.MY),this.userService.friendsService.getFriends(p.FriendsTab.FOLLOWERS)}getOnlineFriends(){}editInfo(e){this._request.put({route:p.ApiRoutes.editInfo,data:{...e,userId:this._user.id},setLoading:t=>{pe.getState().setEditLoading(t)},successCb:t=>{this._user.updateUser(t),pe.getState().setShowEditAlert(!0)}})}}const Ts=ge.init("ProfilesController");class Ml{constructor(e){this._request=e,Ts.debug("init")}_profiles=new Map;get profiles(){return this._profiles}getProfile(e){if(!e&&(e=this.getMyProfileId(),!e)){X.getState().setError(g.t("core.profiles-controller.error.my_profile_not_exists"));return}const t=this.checkProfile(e);if(!t){X.getState().setError(g.t("core.profiles-controller.error.profile_not_exists",{id:e}));return}return t}createProfile(e){const t=e.user.id;if(Ts.debug(`createProfile [userId=${t}]`),this.checkProfile(t)){X.getState().setError(g.t("core.profiles-controller.error.profile_exists",{id:t}));return}const i=new Al(this._request,e);this._profiles.set(t,i),i.isMe||pe.getState().setPrepareAnotherUser(!1)}removeProfile(){Ts.debug("removeProfile");const e=this.getMyProfileId();if(!e){X.getState().setError(g.t("core.profiles-controller.error.my_profile_not_exists"));return}this._profiles.delete(e)}checkProfile(e){return e||(e=this.getMyProfileId()),!e||!this._profiles.has(e)?null:this._profiles.get(e)}getMyProfileId(){let e;for(const[t,n]of this._profiles.entries())if(n.isMe){e=t;break}return e}}const qt=ge.init("MainApi");class Ll{constructor(e,t,n){this._request=e,this._profilesController=t,this._socket=n,qt.debug("init"),this._getMe()}getAnotherUser(e){this._request.post({route:p.ApiRoutes.getUser,data:{id:e},successCb:({user:t,userDetails:n})=>{qt.info(`get info about another user: ${JSON.stringify(t)}`),this._initNewUser({user:t,userDetails:n})}})}signIn(e){this._request.post({route:p.ApiRoutes.signIn,data:e,setLoading:t=>{Fe.getState().setSignInLoading(t)},successCb:t=>{qt.debug(`successfully sign in: ${JSON.stringify(t.user)}`),this._initNewUser({...t,isMe:!0})}})}signUp(e){this._request.post({route:p.ApiRoutes.signUp,data:e,setLoading:t=>{Fe.getState().setSignUpLoading(t)},successCb:t=>{qt.debug(`successfully sing up: ${JSON.stringify(t.user)}`),this._initNewUser({...t,isMe:!0})}})}logout(){this._request.get({route:p.ApiRoutes.logout})}uploadAvatarAuth(e,t,n,i){this._request.post({route:e,data:t,setLoading:n,successCb:i,config:{headers:{"Content-Type":"multipart/form-data"}}})}getFriendsNotification(){this._request.get({route:p.ApiRoutes.getFriendsNotification,successCb:e=>{A.getState().setFriendsNotification(e.friendsNotification)}})}getMessageNotification(){}openFile(e){this._request.post({route:p.ApiRoutes.openFile,data:e})}_getMe(){this._request.get({route:p.ApiRoutes.getMe,setLoading:e=>{me.getState().setLoadingUser(e)},successCb:e=>{qt.info(`get info about yourself: ${JSON.stringify(e.user)}`),this._initNewUser({...e,isMe:!0})}})}_initNewUser(e){this._profilesController.createProfile(e),e.isMe&&this._socket.init(e.user.id)}}const jt=ge.init("Request");class Dl{constructor(e){this._catchErrors=e,jt.debug("init"),this._instance=Si.create({baseURL:As,withCredentials:!0,timeout:xi,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":As,"Access-Control-Allow-Methods":"GET,PUT,POST,DELETE"},responseEncoding:Di})}_instance;_errorHandler(e){this._catchErrors.catchAxios(e)}get({route:e,setLoading:t,successCb:n}){jt.debug(`get [route=${e}]`),t&&t(!0),this._instance.get(e).then(i=>{this._handleSuccessStatuses(i,n)}).catch(i=>{this._errorHandler(i)}).finally(()=>{t&&t(!1)})}downloadFile({params:e,extra:t}){jt.debug(`downloadFile [params=${e}, extra.name=${t.name}]`),this._instance.get(`${p.ApiRoutes.downloadFile}?${e}`,{responseType:"blob"}).then(n=>{const i=n.data,h=window.URL.createObjectURL(i),u=document.createElement("a");u.href=h,u.download=t.name,document.body.appendChild(u),u.click(),u.remove()}).catch(n=>{this._errorHandler(n)})}post({route:e,data:t,setLoading:n,successCb:i,config:h}){const u=h?`, config=${JSON.stringify(h)}`:"";jt.debug(`post [route=${e}, data=${JSON.stringify(t)}${u}]`),n&&n(!0),this._instance.post(e,t,h).then(a=>{this._handleSuccessStatuses(a,i)}).catch(a=>{this._errorHandler(a)}).finally(()=>{n&&n(!1)})}put({route:e,data:t,setLoading:n,successCb:i}){jt.debug(`put [route=${e}, data=${JSON.stringify(t)}]`),n&&n(!0),this._instance.put(e,t).then(h=>{this._handleSuccessStatuses(h,i)}).catch(h=>{this._errorHandler(h)}).finally(()=>{n&&n(!1)})}_handleSuccessStatuses(e,t){const{data:n,status:i}=e;switch(i){case p.HTTPStatuses.OK:case p.HTTPStatuses.Created:{n.success&&t&&t(n);break}case p.HTTPStatuses.NoContent:{t&&t();break}default:X.getState().setError(g.t("core.request.unknown_status",{status:i}))}}}var _t={},Ns={},Xe={},je={},pt={},et={},rs={},tt={},ks={},Zr;function ds(){return Zr||(Zr=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getParsedType=r.ZodParsedType=r.objectUtil=r.util=void 0;var e;(function(i){i.assertEqual=o=>{};function h(o){}i.assertIs=h;function u(o){throw new Error}i.assertNever=u,i.arrayToEnum=o=>{const v={};for(const I of o)v[I]=I;return v},i.getValidEnumValues=o=>{const v=i.objectKeys(o).filter(y=>typeof o[o[y]]!="number"),I={};for(const y of v)I[y]=o[y];return i.objectValues(I)},i.objectValues=o=>i.objectKeys(o).map(function(v){return o[v]}),i.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const v=[];for(const I in o)Object.prototype.hasOwnProperty.call(o,I)&&v.push(I);return v},i.find=(o,v)=>{for(const I of o)if(v(I))return I},i.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function a(o,v=" | "){return o.map(I=>typeof I=="string"?`'${I}'`:I).join(v)}i.joinValues=a,i.jsonStringifyReplacer=(o,v)=>typeof v=="bigint"?v.toString():v})(e||(r.util=e={}));var t;(function(i){i.mergeShapes=(h,u)=>({...h,...u})})(t||(r.objectUtil=t={})),r.ZodParsedType=e.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);const n=i=>{switch(typeof i){case"undefined":return r.ZodParsedType.undefined;case"string":return r.ZodParsedType.string;case"number":return Number.isNaN(i)?r.ZodParsedType.nan:r.ZodParsedType.number;case"boolean":return r.ZodParsedType.boolean;case"function":return r.ZodParsedType.function;case"bigint":return r.ZodParsedType.bigint;case"symbol":return r.ZodParsedType.symbol;case"object":return Array.isArray(i)?r.ZodParsedType.array:i===null?r.ZodParsedType.null:i.then&&typeof i.then=="function"&&i.catch&&typeof i.catch=="function"?r.ZodParsedType.promise:typeof Map<"u"&&i instanceof Map?r.ZodParsedType.map:typeof Set<"u"&&i instanceof Set?r.ZodParsedType.set:typeof Date<"u"&&i instanceof Date?r.ZodParsedType.date:r.ZodParsedType.object;default:return r.ZodParsedType.unknown}};r.getParsedType=n}(ks)),ks}var $r;function Vs(){if($r)return tt;$r=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.ZodError=tt.quotelessJson=tt.ZodIssueCode=void 0;const r=ds();tt.ZodIssueCode=r.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);const e=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");tt.quotelessJson=e;let t=class Zn extends Error{get errors(){return this.issues}constructor(i){super(),this.issues=[],this.addIssue=u=>{this.issues=[...this.issues,u]},this.addIssues=(u=[])=>{this.issues=[...this.issues,...u]};const h=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,h):this.__proto__=h,this.name="ZodError",this.issues=i}format(i){const h=i||function(o){return o.message},u={_errors:[]},a=o=>{for(const v of o.issues)if(v.code==="invalid_union")v.unionErrors.map(a);else if(v.code==="invalid_return_type")a(v.returnTypeError);else if(v.code==="invalid_arguments")a(v.argumentsError);else if(v.path.length===0)u._errors.push(h(v));else{let I=u,y=0;for(;y<v.path.length;){const b=v.path[y];y===v.path.length-1?(I[b]=I[b]||{_errors:[]},I[b]._errors.push(h(v))):I[b]=I[b]||{_errors:[]},I=I[b],y++}}};return a(this),u}static assert(i){if(!(i instanceof Zn))throw new Error(`Not a ZodError: ${i}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,r.util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(i=h=>h.message){const h={},u=[];for(const a of this.issues)a.path.length>0?(h[a.path[0]]=h[a.path[0]]||[],h[a.path[0]].push(i(a))):u.push(i(a));return{formErrors:u,fieldErrors:h}}get formErrors(){return this.flatten()}};return tt.ZodError=t,t.create=n=>new t(n),tt}var qr;function $n(){if(qr)return rs;qr=1,Object.defineProperty(rs,"__esModule",{value:!0});const r=Vs(),e=ds(),t=(n,i)=>{let h;switch(n.code){case r.ZodIssueCode.invalid_type:n.received===e.ZodParsedType.undefined?h="Required":h=`Expected ${n.expected}, received ${n.received}`;break;case r.ZodIssueCode.invalid_literal:h=`Invalid literal value, expected ${JSON.stringify(n.expected,e.util.jsonStringifyReplacer)}`;break;case r.ZodIssueCode.unrecognized_keys:h=`Unrecognized key(s) in object: ${e.util.joinValues(n.keys,", ")}`;break;case r.ZodIssueCode.invalid_union:h="Invalid input";break;case r.ZodIssueCode.invalid_union_discriminator:h=`Invalid discriminator value. Expected ${e.util.joinValues(n.options)}`;break;case r.ZodIssueCode.invalid_enum_value:h=`Invalid enum value. Expected ${e.util.joinValues(n.options)}, received '${n.received}'`;break;case r.ZodIssueCode.invalid_arguments:h="Invalid function arguments";break;case r.ZodIssueCode.invalid_return_type:h="Invalid function return type";break;case r.ZodIssueCode.invalid_date:h="Invalid date";break;case r.ZodIssueCode.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(h=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(h=`${h} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?h=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?h=`Invalid input: must end with "${n.validation.endsWith}"`:e.util.assertNever(n.validation):n.validation!=="regex"?h=`Invalid ${n.validation}`:h="Invalid";break;case r.ZodIssueCode.too_small:n.type==="array"?h=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?h=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?h=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?h=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:h="Invalid input";break;case r.ZodIssueCode.too_big:n.type==="array"?h=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?h=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?h=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?h=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?h=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:h="Invalid input";break;case r.ZodIssueCode.custom:h="Invalid input";break;case r.ZodIssueCode.invalid_intersection_types:h="Intersection results could not be merged";break;case r.ZodIssueCode.not_multiple_of:h=`Number must be a multiple of ${n.multipleOf}`;break;case r.ZodIssueCode.not_finite:h="Number must be finite";break;default:h=i.defaultError,e.util.assertNever(n)}return{message:h}};return rs.default=t,rs}var jr;function Ws(){if(jr)return et;jr=1;var r=et&&et.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(et,"__esModule",{value:!0}),et.defaultErrorMap=void 0,et.setErrorMap=n,et.getErrorMap=i;const e=r($n());et.defaultErrorMap=e.default;let t=e.default;function n(h){t=h}function i(){return t}return et}var Bt={},Br;function qn(){return Br||(Br=1,function(r){var e=Bt&&Bt.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(r,"__esModule",{value:!0}),r.isAsync=r.isValid=r.isDirty=r.isAborted=r.OK=r.DIRTY=r.INVALID=r.ParseStatus=r.EMPTY_PATH=r.makeIssue=void 0,r.addIssueToContext=h;const t=Ws(),n=e($n()),i=C=>{const{data:O,path:T,errorMaps:N,issueData:M}=C,w=[...T,...M.path||[]],U={...M,path:w};if(M.message!==void 0)return{...M,path:w,message:M.message};let V="";const B=N.filter(q=>!!q).slice().reverse();for(const q of B)V=q(U,{data:O,defaultError:V}).message;return{...M,path:w,message:V}};r.makeIssue=i,r.EMPTY_PATH=[];function h(C,O){const T=(0,t.getErrorMap)(),N=(0,r.makeIssue)({issueData:O,data:C.data,path:C.path,errorMaps:[C.common.contextualErrorMap,C.schemaErrorMap,T,T===n.default?void 0:n.default].filter(M=>!!M)});C.common.issues.push(N)}class u{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(O,T){const N=[];for(const M of T){if(M.status==="aborted")return r.INVALID;M.status==="dirty"&&O.dirty(),N.push(M.value)}return{status:O.value,value:N}}static async mergeObjectAsync(O,T){const N=[];for(const M of T){const w=await M.key,U=await M.value;N.push({key:w,value:U})}return u.mergeObjectSync(O,N)}static mergeObjectSync(O,T){const N={};for(const M of T){const{key:w,value:U}=M;if(w.status==="aborted"||U.status==="aborted")return r.INVALID;w.status==="dirty"&&O.dirty(),U.status==="dirty"&&O.dirty(),w.value!=="__proto__"&&(typeof U.value<"u"||M.alwaysSet)&&(N[w.value]=U.value)}return{status:O.value,value:N}}}r.ParseStatus=u,r.INVALID=Object.freeze({status:"aborted"});const a=C=>({status:"dirty",value:C});r.DIRTY=a;const o=C=>({status:"valid",value:C});r.OK=o;const v=C=>C.status==="aborted";r.isAborted=v;const I=C=>C.status==="dirty";r.isDirty=I;const y=C=>C.status==="valid";r.isValid=y;const b=C=>typeof Promise<"u"&&C instanceof Promise;r.isAsync=b}(Bt)),Bt}var ws={},zr;function xl(){return zr||(zr=1,Object.defineProperty(ws,"__esModule",{value:!0})),ws}var S={},zt={},Gr;function Ul(){if(Gr)return zt;Gr=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.errorUtil=void 0;var r;return function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message}(r||(zt.errorUtil=r={})),zt}var Vr;function Pl(){if(Vr)return S;Vr=1;var r=S&&S.__classPrivateFieldGet||function(m,s,c,d){if(c==="a"&&!d)throw new TypeError("Private accessor was defined without a getter");if(typeof s=="function"?m!==s||!d:!s.has(m))throw new TypeError("Cannot read private member from an object whose class did not declare it");return c==="m"?d:c==="a"?d.call(m):d?d.value:s.get(m)},e=S&&S.__classPrivateFieldSet||function(m,s,c,d,f){if(d==="m")throw new TypeError("Private method is not writable");if(d==="a"&&!f)throw new TypeError("Private accessor was defined without a setter");if(typeof s=="function"?m!==s||!f:!s.has(m))throw new TypeError("Cannot write private member to an object whose class did not declare it");return d==="a"?f.call(m,c):f?f.value=c:s.set(m,c),c},t,n;Object.defineProperty(S,"__esModule",{value:!0}),S.discriminatedUnion=S.date=S.boolean=S.bigint=S.array=S.any=S.coerce=S.ZodFirstPartyTypeKind=S.late=S.ZodSchema=S.Schema=S.ZodReadonly=S.ZodPipeline=S.ZodBranded=S.BRAND=S.ZodNaN=S.ZodCatch=S.ZodDefault=S.ZodNullable=S.ZodOptional=S.ZodTransformer=S.ZodEffects=S.ZodPromise=S.ZodNativeEnum=S.ZodEnum=S.ZodLiteral=S.ZodLazy=S.ZodFunction=S.ZodSet=S.ZodMap=S.ZodRecord=S.ZodTuple=S.ZodIntersection=S.ZodDiscriminatedUnion=S.ZodUnion=S.ZodObject=S.ZodArray=S.ZodVoid=S.ZodNever=S.ZodUnknown=S.ZodAny=S.ZodNull=S.ZodUndefined=S.ZodSymbol=S.ZodDate=S.ZodBoolean=S.ZodBigInt=S.ZodNumber=S.ZodString=S.ZodType=void 0,S.NEVER=S.void=S.unknown=S.union=S.undefined=S.tuple=S.transformer=S.symbol=S.string=S.strictObject=S.set=S.record=S.promise=S.preprocess=S.pipeline=S.ostring=S.optional=S.onumber=S.oboolean=S.object=S.number=S.nullable=S.null=S.never=S.nativeEnum=S.nan=S.map=S.literal=S.lazy=S.intersection=S.instanceof=S.function=S.enum=S.effect=void 0,S.datetimeRegex=Z,S.custom=Xs;const i=Vs(),h=Ws(),u=Ul(),a=qn(),o=ds();class v{constructor(s,c,d,f){this._cachedPath=[],this.parent=s,this.data=c,this._path=d,this._key=f}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const I=(m,s)=>{if((0,a.isValid)(s))return{success:!0,data:s.value};if(!m.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const c=new i.ZodError(m.common.issues);return this._error=c,this._error}}};function y(m){if(!m)return{};const{errorMap:s,invalid_type_error:c,required_error:d,description:f}=m;if(s&&(c||d))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return s?{errorMap:s,description:f}:{errorMap:(R,k)=>{const{message:$}=m;return R.code==="invalid_enum_value"?{message:$??k.defaultError}:typeof k.data>"u"?{message:$??d??k.defaultError}:R.code!=="invalid_type"?{message:k.defaultError}:{message:$??c??k.defaultError}},description:f}}class b{get description(){return this._def.description}_getType(s){return(0,o.getParsedType)(s.data)}_getOrReturnCtx(s,c){return c||{common:s.parent.common,data:s.data,parsedType:(0,o.getParsedType)(s.data),schemaErrorMap:this._def.errorMap,path:s.path,parent:s.parent}}_processInputParams(s){return{status:new a.ParseStatus,ctx:{common:s.parent.common,data:s.data,parsedType:(0,o.getParsedType)(s.data),schemaErrorMap:this._def.errorMap,path:s.path,parent:s.parent}}}_parseSync(s){const c=this._parse(s);if((0,a.isAsync)(c))throw new Error("Synchronous parse encountered promise.");return c}_parseAsync(s){const c=this._parse(s);return Promise.resolve(c)}parse(s,c){const d=this.safeParse(s,c);if(d.success)return d.data;throw d.error}safeParse(s,c){const d={common:{issues:[],async:c?.async??!1,contextualErrorMap:c?.errorMap},path:c?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:s,parsedType:(0,o.getParsedType)(s)},f=this._parseSync({data:s,path:d.path,parent:d});return I(d,f)}"~validate"(s){const c={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:s,parsedType:(0,o.getParsedType)(s)};if(!this["~standard"].async)try{const d=this._parseSync({data:s,path:[],parent:c});return(0,a.isValid)(d)?{value:d.value}:{issues:c.common.issues}}catch(d){d?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),c.common={issues:[],async:!0}}return this._parseAsync({data:s,path:[],parent:c}).then(d=>(0,a.isValid)(d)?{value:d.value}:{issues:c.common.issues})}async parseAsync(s,c){const d=await this.safeParseAsync(s,c);if(d.success)return d.data;throw d.error}async safeParseAsync(s,c){const d={common:{issues:[],contextualErrorMap:c?.errorMap,async:!0},path:c?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:s,parsedType:(0,o.getParsedType)(s)},f=this._parse({data:s,path:d.path,parent:d}),_=await((0,a.isAsync)(f)?f:Promise.resolve(f));return I(d,_)}refine(s,c){const d=f=>typeof c=="string"||typeof c>"u"?{message:c}:typeof c=="function"?c(f):c;return this._refinement((f,_)=>{const R=s(f),k=()=>_.addIssue({code:i.ZodIssueCode.custom,...d(f)});return typeof Promise<"u"&&R instanceof Promise?R.then($=>$?!0:(k(),!1)):R?!0:(k(),!1)})}refinement(s,c){return this._refinement((d,f)=>s(d)?!0:(f.addIssue(typeof c=="function"?c(d,f):c),!1))}_refinement(s){return new qe({schema:this,typeName:G.ZodEffects,effect:{type:"refinement",refinement:s}})}superRefine(s){return this._refinement(s)}constructor(s){this.spa=this.safeParseAsync,this._def=s,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:c=>this["~validate"](c)}}optional(){return He.create(this,this._def)}nullable(){return at.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return $e.create(this)}promise(){return Tt.create(this,this._def)}or(s){return Ft.create([this,s],this._def)}and(s){return Rt.create(this,s,this._def)}transform(s){return new qe({...y(this._def),schema:this,typeName:G.ZodEffects,effect:{type:"transform",transform:s}})}default(s){const c=typeof s=="function"?s:()=>s;return new xt({...y(this._def),innerType:this,defaultValue:c,typeName:G.ZodDefault})}brand(){return new fs({typeName:G.ZodBranded,type:this,...y(this._def)})}catch(s){const c=typeof s=="function"?s:()=>s;return new Ut({...y(this._def),innerType:this,catchValue:c,typeName:G.ZodCatch})}describe(s){const c=this.constructor;return new c({...this._def,description:s})}pipe(s){return Pt.create(this,s)}readonly(){return Zt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}S.ZodType=b,S.Schema=b,S.ZodSchema=b;const C=/^c[^\s-]{8,}$/i,O=/^[0-9a-z]+$/,T=/^[0-9A-HJKMNP-TV-Z]{26}$/i,N=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,M=/^[a-z0-9_-]{21}$/i,w=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,U=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,V=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,B="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let q;const ne=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,de=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,P=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,K=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,W=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,be=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ht="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",z=new RegExp(`^${ht}$`);function x(m){let s="[0-5]\\d";m.precision?s=`${s}\\.\\d{${m.precision}}`:m.precision==null&&(s=`${s}(\\.\\d+)?`);const c=m.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${s})${c}`}function L(m){return new RegExp(`^${x(m)}$`)}function Z(m){let s=`${ht}T${x(m)}`;const c=[];return c.push(m.local?"Z?":"Z"),m.offset&&c.push("([+-]\\d{2}:?\\d{2})"),s=`${s}(${c.join("|")})`,new RegExp(`^${s}$`)}function D(m,s){return!!((s==="v4"||!s)&&ne.test(m)||(s==="v6"||!s)&&P.test(m))}function Q(m,s){if(!w.test(m))return!1;try{const[c]=m.split("."),d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),f=JSON.parse(atob(d));return!(typeof f!="object"||f===null||"typ"in f&&f?.typ!=="JWT"||!f.alg||s&&f.alg!==s)}catch{return!1}}function H(m,s){return!!((s==="v4"||!s)&&de.test(m)||(s==="v6"||!s)&&K.test(m))}class J extends b{_parse(s){if(this._def.coerce&&(s.data=String(s.data)),this._getType(s)!==o.ZodParsedType.string){const _=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.string,received:_.parsedType}),a.INVALID}const d=new a.ParseStatus;let f;for(const _ of this._def.checks)if(_.kind==="min")s.data.length<_.value&&(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.too_small,minimum:_.value,type:"string",inclusive:!0,exact:!1,message:_.message}),d.dirty());else if(_.kind==="max")s.data.length>_.value&&(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.too_big,maximum:_.value,type:"string",inclusive:!0,exact:!1,message:_.message}),d.dirty());else if(_.kind==="length"){const R=s.data.length>_.value,k=s.data.length<_.value;(R||k)&&(f=this._getOrReturnCtx(s,f),R?(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.too_big,maximum:_.value,type:"string",inclusive:!0,exact:!0,message:_.message}):k&&(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.too_small,minimum:_.value,type:"string",inclusive:!0,exact:!0,message:_.message}),d.dirty())}else if(_.kind==="email")V.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"email",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty());else if(_.kind==="emoji")q||(q=new RegExp(B,"u")),q.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"emoji",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty());else if(_.kind==="uuid")N.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"uuid",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty());else if(_.kind==="nanoid")M.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"nanoid",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty());else if(_.kind==="cuid")C.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"cuid",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty());else if(_.kind==="cuid2")O.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"cuid2",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty());else if(_.kind==="ulid")T.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"ulid",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty());else if(_.kind==="url")try{new URL(s.data)}catch{f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"url",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty()}else _.kind==="regex"?(_.regex.lastIndex=0,_.regex.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"regex",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty())):_.kind==="trim"?s.data=s.data.trim():_.kind==="includes"?s.data.includes(_.value,_.position)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.invalid_string,validation:{includes:_.value,position:_.position},message:_.message}),d.dirty()):_.kind==="toLowerCase"?s.data=s.data.toLowerCase():_.kind==="toUpperCase"?s.data=s.data.toUpperCase():_.kind==="startsWith"?s.data.startsWith(_.value)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.invalid_string,validation:{startsWith:_.value},message:_.message}),d.dirty()):_.kind==="endsWith"?s.data.endsWith(_.value)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.invalid_string,validation:{endsWith:_.value},message:_.message}),d.dirty()):_.kind==="datetime"?Z(_).test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.invalid_string,validation:"datetime",message:_.message}),d.dirty()):_.kind==="date"?z.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.invalid_string,validation:"date",message:_.message}),d.dirty()):_.kind==="time"?L(_).test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.invalid_string,validation:"time",message:_.message}),d.dirty()):_.kind==="duration"?U.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"duration",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty()):_.kind==="ip"?D(s.data,_.version)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"ip",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty()):_.kind==="jwt"?Q(s.data,_.alg)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"jwt",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty()):_.kind==="cidr"?H(s.data,_.version)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"cidr",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty()):_.kind==="base64"?W.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"base64",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty()):_.kind==="base64url"?be.test(s.data)||(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{validation:"base64url",code:i.ZodIssueCode.invalid_string,message:_.message}),d.dirty()):o.util.assertNever(_);return{status:d.value,value:s.data}}_regex(s,c,d){return this.refinement(f=>s.test(f),{validation:c,code:i.ZodIssueCode.invalid_string,...u.errorUtil.errToObj(d)})}_addCheck(s){return new J({...this._def,checks:[...this._def.checks,s]})}email(s){return this._addCheck({kind:"email",...u.errorUtil.errToObj(s)})}url(s){return this._addCheck({kind:"url",...u.errorUtil.errToObj(s)})}emoji(s){return this._addCheck({kind:"emoji",...u.errorUtil.errToObj(s)})}uuid(s){return this._addCheck({kind:"uuid",...u.errorUtil.errToObj(s)})}nanoid(s){return this._addCheck({kind:"nanoid",...u.errorUtil.errToObj(s)})}cuid(s){return this._addCheck({kind:"cuid",...u.errorUtil.errToObj(s)})}cuid2(s){return this._addCheck({kind:"cuid2",...u.errorUtil.errToObj(s)})}ulid(s){return this._addCheck({kind:"ulid",...u.errorUtil.errToObj(s)})}base64(s){return this._addCheck({kind:"base64",...u.errorUtil.errToObj(s)})}base64url(s){return this._addCheck({kind:"base64url",...u.errorUtil.errToObj(s)})}jwt(s){return this._addCheck({kind:"jwt",...u.errorUtil.errToObj(s)})}ip(s){return this._addCheck({kind:"ip",...u.errorUtil.errToObj(s)})}cidr(s){return this._addCheck({kind:"cidr",...u.errorUtil.errToObj(s)})}datetime(s){return typeof s=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:s}):this._addCheck({kind:"datetime",precision:typeof s?.precision>"u"?null:s?.precision,offset:s?.offset??!1,local:s?.local??!1,...u.errorUtil.errToObj(s?.message)})}date(s){return this._addCheck({kind:"date",message:s})}time(s){return typeof s=="string"?this._addCheck({kind:"time",precision:null,message:s}):this._addCheck({kind:"time",precision:typeof s?.precision>"u"?null:s?.precision,...u.errorUtil.errToObj(s?.message)})}duration(s){return this._addCheck({kind:"duration",...u.errorUtil.errToObj(s)})}regex(s,c){return this._addCheck({kind:"regex",regex:s,...u.errorUtil.errToObj(c)})}includes(s,c){return this._addCheck({kind:"includes",value:s,position:c?.position,...u.errorUtil.errToObj(c?.message)})}startsWith(s,c){return this._addCheck({kind:"startsWith",value:s,...u.errorUtil.errToObj(c)})}endsWith(s,c){return this._addCheck({kind:"endsWith",value:s,...u.errorUtil.errToObj(c)})}min(s,c){return this._addCheck({kind:"min",value:s,...u.errorUtil.errToObj(c)})}max(s,c){return this._addCheck({kind:"max",value:s,...u.errorUtil.errToObj(c)})}length(s,c){return this._addCheck({kind:"length",value:s,...u.errorUtil.errToObj(c)})}nonempty(s){return this.min(1,u.errorUtil.errToObj(s))}trim(){return new J({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new J({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new J({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(s=>s.kind==="datetime")}get isDate(){return!!this._def.checks.find(s=>s.kind==="date")}get isTime(){return!!this._def.checks.find(s=>s.kind==="time")}get isDuration(){return!!this._def.checks.find(s=>s.kind==="duration")}get isEmail(){return!!this._def.checks.find(s=>s.kind==="email")}get isURL(){return!!this._def.checks.find(s=>s.kind==="url")}get isEmoji(){return!!this._def.checks.find(s=>s.kind==="emoji")}get isUUID(){return!!this._def.checks.find(s=>s.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(s=>s.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(s=>s.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(s=>s.kind==="cuid2")}get isULID(){return!!this._def.checks.find(s=>s.kind==="ulid")}get isIP(){return!!this._def.checks.find(s=>s.kind==="ip")}get isCIDR(){return!!this._def.checks.find(s=>s.kind==="cidr")}get isBase64(){return!!this._def.checks.find(s=>s.kind==="base64")}get isBase64url(){return!!this._def.checks.find(s=>s.kind==="base64url")}get minLength(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s}get maxLength(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s}}S.ZodString=J,J.create=m=>new J({checks:[],typeName:G.ZodString,coerce:m?.coerce??!1,...y(m)});function ce(m,s){const c=(m.toString().split(".")[1]||"").length,d=(s.toString().split(".")[1]||"").length,f=c>d?c:d,_=Number.parseInt(m.toFixed(f).replace(".","")),R=Number.parseInt(s.toFixed(f).replace(".",""));return _%R/10**f}class re extends b{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(s){if(this._def.coerce&&(s.data=Number(s.data)),this._getType(s)!==o.ZodParsedType.number){const _=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.number,received:_.parsedType}),a.INVALID}let d;const f=new a.ParseStatus;for(const _ of this._def.checks)_.kind==="int"?o.util.isInteger(s.data)||(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:_.message}),f.dirty()):_.kind==="min"?(_.inclusive?s.data<_.value:s.data<=_.value)&&(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_small,minimum:_.value,type:"number",inclusive:_.inclusive,exact:!1,message:_.message}),f.dirty()):_.kind==="max"?(_.inclusive?s.data>_.value:s.data>=_.value)&&(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_big,maximum:_.value,type:"number",inclusive:_.inclusive,exact:!1,message:_.message}),f.dirty()):_.kind==="multipleOf"?ce(s.data,_.value)!==0&&(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.not_multiple_of,multipleOf:_.value,message:_.message}),f.dirty()):_.kind==="finite"?Number.isFinite(s.data)||(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.not_finite,message:_.message}),f.dirty()):o.util.assertNever(_);return{status:f.value,value:s.data}}gte(s,c){return this.setLimit("min",s,!0,u.errorUtil.toString(c))}gt(s,c){return this.setLimit("min",s,!1,u.errorUtil.toString(c))}lte(s,c){return this.setLimit("max",s,!0,u.errorUtil.toString(c))}lt(s,c){return this.setLimit("max",s,!1,u.errorUtil.toString(c))}setLimit(s,c,d,f){return new re({...this._def,checks:[...this._def.checks,{kind:s,value:c,inclusive:d,message:u.errorUtil.toString(f)}]})}_addCheck(s){return new re({...this._def,checks:[...this._def.checks,s]})}int(s){return this._addCheck({kind:"int",message:u.errorUtil.toString(s)})}positive(s){return this._addCheck({kind:"min",value:0,inclusive:!1,message:u.errorUtil.toString(s)})}negative(s){return this._addCheck({kind:"max",value:0,inclusive:!1,message:u.errorUtil.toString(s)})}nonpositive(s){return this._addCheck({kind:"max",value:0,inclusive:!0,message:u.errorUtil.toString(s)})}nonnegative(s){return this._addCheck({kind:"min",value:0,inclusive:!0,message:u.errorUtil.toString(s)})}multipleOf(s,c){return this._addCheck({kind:"multipleOf",value:s,message:u.errorUtil.toString(c)})}finite(s){return this._addCheck({kind:"finite",message:u.errorUtil.toString(s)})}safe(s){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:u.errorUtil.toString(s)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:u.errorUtil.toString(s)})}get minValue(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s}get maxValue(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s}get isInt(){return!!this._def.checks.find(s=>s.kind==="int"||s.kind==="multipleOf"&&o.util.isInteger(s.value))}get isFinite(){let s=null,c=null;for(const d of this._def.checks){if(d.kind==="finite"||d.kind==="int"||d.kind==="multipleOf")return!0;d.kind==="min"?(c===null||d.value>c)&&(c=d.value):d.kind==="max"&&(s===null||d.value<s)&&(s=d.value)}return Number.isFinite(c)&&Number.isFinite(s)}}S.ZodNumber=re,re.create=m=>new re({checks:[],typeName:G.ZodNumber,coerce:m?.coerce||!1,...y(m)});class se extends b{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(s){if(this._def.coerce)try{s.data=BigInt(s.data)}catch{return this._getInvalidInput(s)}if(this._getType(s)!==o.ZodParsedType.bigint)return this._getInvalidInput(s);let d;const f=new a.ParseStatus;for(const _ of this._def.checks)_.kind==="min"?(_.inclusive?s.data<_.value:s.data<=_.value)&&(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_small,type:"bigint",minimum:_.value,inclusive:_.inclusive,message:_.message}),f.dirty()):_.kind==="max"?(_.inclusive?s.data>_.value:s.data>=_.value)&&(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_big,type:"bigint",maximum:_.value,inclusive:_.inclusive,message:_.message}),f.dirty()):_.kind==="multipleOf"?s.data%_.value!==BigInt(0)&&(d=this._getOrReturnCtx(s,d),(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.not_multiple_of,multipleOf:_.value,message:_.message}),f.dirty()):o.util.assertNever(_);return{status:f.value,value:s.data}}_getInvalidInput(s){const c=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.bigint,received:c.parsedType}),a.INVALID}gte(s,c){return this.setLimit("min",s,!0,u.errorUtil.toString(c))}gt(s,c){return this.setLimit("min",s,!1,u.errorUtil.toString(c))}lte(s,c){return this.setLimit("max",s,!0,u.errorUtil.toString(c))}lt(s,c){return this.setLimit("max",s,!1,u.errorUtil.toString(c))}setLimit(s,c,d,f){return new se({...this._def,checks:[...this._def.checks,{kind:s,value:c,inclusive:d,message:u.errorUtil.toString(f)}]})}_addCheck(s){return new se({...this._def,checks:[...this._def.checks,s]})}positive(s){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:u.errorUtil.toString(s)})}negative(s){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:u.errorUtil.toString(s)})}nonpositive(s){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:u.errorUtil.toString(s)})}nonnegative(s){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:u.errorUtil.toString(s)})}multipleOf(s,c){return this._addCheck({kind:"multipleOf",value:s,message:u.errorUtil.toString(c)})}get minValue(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s}get maxValue(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s}}S.ZodBigInt=se,se.create=m=>new se({checks:[],typeName:G.ZodBigInt,coerce:m?.coerce??!1,...y(m)});class ue extends b{_parse(s){if(this._def.coerce&&(s.data=!!s.data),this._getType(s)!==o.ZodParsedType.boolean){const d=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.boolean,received:d.parsedType}),a.INVALID}return(0,a.OK)(s.data)}}S.ZodBoolean=ue,ue.create=m=>new ue({typeName:G.ZodBoolean,coerce:m?.coerce||!1,...y(m)});class Ne extends b{_parse(s){if(this._def.coerce&&(s.data=new Date(s.data)),this._getType(s)!==o.ZodParsedType.date){const _=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.date,received:_.parsedType}),a.INVALID}if(Number.isNaN(s.data.getTime())){const _=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_date}),a.INVALID}const d=new a.ParseStatus;let f;for(const _ of this._def.checks)_.kind==="min"?s.data.getTime()<_.value&&(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.too_small,message:_.message,inclusive:!0,exact:!1,minimum:_.value,type:"date"}),d.dirty()):_.kind==="max"?s.data.getTime()>_.value&&(f=this._getOrReturnCtx(s,f),(0,a.addIssueToContext)(f,{code:i.ZodIssueCode.too_big,message:_.message,inclusive:!0,exact:!1,maximum:_.value,type:"date"}),d.dirty()):o.util.assertNever(_);return{status:d.value,value:new Date(s.data.getTime())}}_addCheck(s){return new Ne({...this._def,checks:[...this._def.checks,s]})}min(s,c){return this._addCheck({kind:"min",value:s.getTime(),message:u.errorUtil.toString(c)})}max(s,c){return this._addCheck({kind:"max",value:s.getTime(),message:u.errorUtil.toString(c)})}get minDate(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s!=null?new Date(s):null}get maxDate(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s!=null?new Date(s):null}}S.ZodDate=Ne,Ne.create=m=>new Ne({checks:[],coerce:m?.coerce||!1,typeName:G.ZodDate,...y(m)});class Le extends b{_parse(s){if(this._getType(s)!==o.ZodParsedType.symbol){const d=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.symbol,received:d.parsedType}),a.INVALID}return(0,a.OK)(s.data)}}S.ZodSymbol=Le,Le.create=m=>new Le({typeName:G.ZodSymbol,...y(m)});class Ze extends b{_parse(s){if(this._getType(s)!==o.ZodParsedType.undefined){const d=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.undefined,received:d.parsedType}),a.INVALID}return(0,a.OK)(s.data)}}S.ZodUndefined=Ze,Ze.create=m=>new Ze({typeName:G.ZodUndefined,...y(m)});class ke extends b{_parse(s){if(this._getType(s)!==o.ZodParsedType.null){const d=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.null,received:d.parsedType}),a.INVALID}return(0,a.OK)(s.data)}}S.ZodNull=ke,ke.create=m=>new ke({typeName:G.ZodNull,...y(m)});class he extends b{constructor(){super(...arguments),this._any=!0}_parse(s){return(0,a.OK)(s.data)}}S.ZodAny=he,he.create=m=>new he({typeName:G.ZodAny,...y(m)});class ve extends b{constructor(){super(...arguments),this._unknown=!0}_parse(s){return(0,a.OK)(s.data)}}S.ZodUnknown=ve,ve.create=m=>new ve({typeName:G.ZodUnknown,...y(m)});class Ee extends b{_parse(s){const c=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.never,received:c.parsedType}),a.INVALID}}S.ZodNever=Ee,Ee.create=m=>new Ee({typeName:G.ZodNever,...y(m)});class Qe extends b{_parse(s){if(this._getType(s)!==o.ZodParsedType.undefined){const d=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.void,received:d.parsedType}),a.INVALID}return(0,a.OK)(s.data)}}S.ZodVoid=Qe,Qe.create=m=>new Qe({typeName:G.ZodVoid,...y(m)});class $e extends b{_parse(s){const{ctx:c,status:d}=this._processInputParams(s),f=this._def;if(c.parsedType!==o.ZodParsedType.array)return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.array,received:c.parsedType}),a.INVALID;if(f.exactLength!==null){const R=c.data.length>f.exactLength.value,k=c.data.length<f.exactLength.value;(R||k)&&((0,a.addIssueToContext)(c,{code:R?i.ZodIssueCode.too_big:i.ZodIssueCode.too_small,minimum:k?f.exactLength.value:void 0,maximum:R?f.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:f.exactLength.message}),d.dirty())}if(f.minLength!==null&&c.data.length<f.minLength.value&&((0,a.addIssueToContext)(c,{code:i.ZodIssueCode.too_small,minimum:f.minLength.value,type:"array",inclusive:!0,exact:!1,message:f.minLength.message}),d.dirty()),f.maxLength!==null&&c.data.length>f.maxLength.value&&((0,a.addIssueToContext)(c,{code:i.ZodIssueCode.too_big,maximum:f.maxLength.value,type:"array",inclusive:!0,exact:!1,message:f.maxLength.message}),d.dirty()),c.common.async)return Promise.all([...c.data].map((R,k)=>f.type._parseAsync(new v(c,R,c.path,k)))).then(R=>a.ParseStatus.mergeArray(d,R));const _=[...c.data].map((R,k)=>f.type._parseSync(new v(c,R,c.path,k)));return a.ParseStatus.mergeArray(d,_)}get element(){return this._def.type}min(s,c){return new $e({...this._def,minLength:{value:s,message:u.errorUtil.toString(c)}})}max(s,c){return new $e({...this._def,maxLength:{value:s,message:u.errorUtil.toString(c)}})}length(s,c){return new $e({...this._def,exactLength:{value:s,message:u.errorUtil.toString(c)}})}nonempty(s){return this.min(1,s)}}S.ZodArray=$e,$e.create=(m,s)=>new $e({type:m,minLength:null,maxLength:null,exactLength:null,typeName:G.ZodArray,...y(s)});function Ct(m){if(m instanceof le){const s={};for(const c in m.shape){const d=m.shape[c];s[c]=He.create(Ct(d))}return new le({...m._def,shape:()=>s})}else return m instanceof $e?new $e({...m._def,type:Ct(m.element)}):m instanceof He?He.create(Ct(m.unwrap())):m instanceof at?at.create(Ct(m.unwrap())):m instanceof We?We.create(m.items.map(s=>Ct(s))):m}class le extends b{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const s=this._def.shape(),c=o.util.objectKeys(s);return this._cached={shape:s,keys:c},this._cached}_parse(s){if(this._getType(s)!==o.ZodParsedType.object){const j=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(j,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.object,received:j.parsedType}),a.INVALID}const{status:d,ctx:f}=this._processInputParams(s),{shape:_,keys:R}=this._getCached(),k=[];if(!(this._def.catchall instanceof Ee&&this._def.unknownKeys==="strip"))for(const j in f.data)R.includes(j)||k.push(j);const $=[];for(const j of R){const ee=_[j],De=f.data[j];$.push({key:{status:"valid",value:j},value:ee._parse(new v(f,De,f.path,j)),alwaysSet:j in f.data})}if(this._def.catchall instanceof Ee){const j=this._def.unknownKeys;if(j==="passthrough")for(const ee of k)$.push({key:{status:"valid",value:ee},value:{status:"valid",value:f.data[ee]}});else if(j==="strict")k.length>0&&((0,a.addIssueToContext)(f,{code:i.ZodIssueCode.unrecognized_keys,keys:k}),d.dirty());else if(j!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const j=this._def.catchall;for(const ee of k){const De=f.data[ee];$.push({key:{status:"valid",value:ee},value:j._parse(new v(f,De,f.path,ee)),alwaysSet:ee in f.data})}}return f.common.async?Promise.resolve().then(async()=>{const j=[];for(const ee of $){const De=await ee.key,nr=await ee.value;j.push({key:De,value:nr,alwaysSet:ee.alwaysSet})}return j}).then(j=>a.ParseStatus.mergeObjectSync(d,j)):a.ParseStatus.mergeObjectSync(d,$)}get shape(){return this._def.shape()}strict(s){return u.errorUtil.errToObj,new le({...this._def,unknownKeys:"strict",...s!==void 0?{errorMap:(c,d)=>{const f=this._def.errorMap?.(c,d).message??d.defaultError;return c.code==="unrecognized_keys"?{message:u.errorUtil.errToObj(s).message??f}:{message:f}}}:{}})}strip(){return new le({...this._def,unknownKeys:"strip"})}passthrough(){return new le({...this._def,unknownKeys:"passthrough"})}extend(s){return new le({...this._def,shape:()=>({...this._def.shape(),...s})})}merge(s){return new le({unknownKeys:s._def.unknownKeys,catchall:s._def.catchall,shape:()=>({...this._def.shape(),...s._def.shape()}),typeName:G.ZodObject})}setKey(s,c){return this.augment({[s]:c})}catchall(s){return new le({...this._def,catchall:s})}pick(s){const c={};for(const d of o.util.objectKeys(s))s[d]&&this.shape[d]&&(c[d]=this.shape[d]);return new le({...this._def,shape:()=>c})}omit(s){const c={};for(const d of o.util.objectKeys(this.shape))s[d]||(c[d]=this.shape[d]);return new le({...this._def,shape:()=>c})}deepPartial(){return Ct(this)}partial(s){const c={};for(const d of o.util.objectKeys(this.shape)){const f=this.shape[d];s&&!s[d]?c[d]=f:c[d]=f.optional()}return new le({...this._def,shape:()=>c})}required(s){const c={};for(const d of o.util.objectKeys(this.shape))if(s&&!s[d])c[d]=this.shape[d];else{let _=this.shape[d];for(;_ instanceof He;)_=_._def.innerType;c[d]=_}return new le({...this._def,shape:()=>c})}keyof(){return Ys(o.util.objectKeys(this.shape))}}S.ZodObject=le,le.create=(m,s)=>new le({shape:()=>m,unknownKeys:"strip",catchall:Ee.create(),typeName:G.ZodObject,...y(s)}),le.strictCreate=(m,s)=>new le({shape:()=>m,unknownKeys:"strict",catchall:Ee.create(),typeName:G.ZodObject,...y(s)}),le.lazycreate=(m,s)=>new le({shape:m,unknownKeys:"strip",catchall:Ee.create(),typeName:G.ZodObject,...y(s)});class Ft extends b{_parse(s){const{ctx:c}=this._processInputParams(s),d=this._def.options;function f(_){for(const k of _)if(k.result.status==="valid")return k.result;for(const k of _)if(k.result.status==="dirty")return c.common.issues.push(...k.ctx.common.issues),k.result;const R=_.map(k=>new i.ZodError(k.ctx.common.issues));return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_union,unionErrors:R}),a.INVALID}if(c.common.async)return Promise.all(d.map(async _=>{const R={...c,common:{...c.common,issues:[]},parent:null};return{result:await _._parseAsync({data:c.data,path:c.path,parent:R}),ctx:R}})).then(f);{let _;const R=[];for(const $ of d){const j={...c,common:{...c.common,issues:[]},parent:null},ee=$._parseSync({data:c.data,path:c.path,parent:j});if(ee.status==="valid")return ee;ee.status==="dirty"&&!_&&(_={result:ee,ctx:j}),j.common.issues.length&&R.push(j.common.issues)}if(_)return c.common.issues.push(..._.ctx.common.issues),_.result;const k=R.map($=>new i.ZodError($));return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_union,unionErrors:k}),a.INVALID}}get options(){return this._def.options}}S.ZodUnion=Ft,Ft.create=(m,s)=>new Ft({options:m,typeName:G.ZodUnion,...y(s)});const Ye=m=>m instanceof Mt?Ye(m.schema):m instanceof qe?Ye(m.innerType()):m instanceof Lt?[m.value]:m instanceof it?m.options:m instanceof Dt?o.util.objectValues(m.enum):m instanceof xt?Ye(m._def.innerType):m instanceof Ze?[void 0]:m instanceof ke?[null]:m instanceof He?[void 0,...Ye(m.unwrap())]:m instanceof at?[null,...Ye(m.unwrap())]:m instanceof fs||m instanceof Zt?Ye(m.unwrap()):m instanceof Ut?Ye(m._def.innerType):[];class Xt extends b{_parse(s){const{ctx:c}=this._processInputParams(s);if(c.parsedType!==o.ZodParsedType.object)return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.object,received:c.parsedType}),a.INVALID;const d=this.discriminator,f=c.data[d],_=this.optionsMap.get(f);return _?c.common.async?_._parseAsync({data:c.data,path:c.path,parent:c}):_._parseSync({data:c.data,path:c.path,parent:c}):((0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[d]}),a.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(s,c,d){const f=new Map;for(const _ of c){const R=Ye(_.shape[s]);if(!R.length)throw new Error(`A discriminator value for key \`${s}\` could not be extracted from all schema options`);for(const k of R){if(f.has(k))throw new Error(`Discriminator property ${String(s)} has duplicate value ${String(k)}`);f.set(k,_)}}return new Xt({typeName:G.ZodDiscriminatedUnion,discriminator:s,options:c,optionsMap:f,...y(d)})}}S.ZodDiscriminatedUnion=Xt;function ms(m,s){const c=(0,o.getParsedType)(m),d=(0,o.getParsedType)(s);if(m===s)return{valid:!0,data:m};if(c===o.ZodParsedType.object&&d===o.ZodParsedType.object){const f=o.util.objectKeys(s),_=o.util.objectKeys(m).filter(k=>f.indexOf(k)!==-1),R={...m,...s};for(const k of _){const $=ms(m[k],s[k]);if(!$.valid)return{valid:!1};R[k]=$.data}return{valid:!0,data:R}}else if(c===o.ZodParsedType.array&&d===o.ZodParsedType.array){if(m.length!==s.length)return{valid:!1};const f=[];for(let _=0;_<m.length;_++){const R=m[_],k=s[_],$=ms(R,k);if(!$.valid)return{valid:!1};f.push($.data)}return{valid:!0,data:f}}else return c===o.ZodParsedType.date&&d===o.ZodParsedType.date&&+m==+s?{valid:!0,data:m}:{valid:!1}}class Rt extends b{_parse(s){const{status:c,ctx:d}=this._processInputParams(s),f=(_,R)=>{if((0,a.isAborted)(_)||(0,a.isAborted)(R))return a.INVALID;const k=ms(_.value,R.value);return k.valid?(((0,a.isDirty)(_)||(0,a.isDirty)(R))&&c.dirty(),{status:c.value,value:k.data}):((0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_intersection_types}),a.INVALID)};return d.common.async?Promise.all([this._def.left._parseAsync({data:d.data,path:d.path,parent:d}),this._def.right._parseAsync({data:d.data,path:d.path,parent:d})]).then(([_,R])=>f(_,R)):f(this._def.left._parseSync({data:d.data,path:d.path,parent:d}),this._def.right._parseSync({data:d.data,path:d.path,parent:d}))}}S.ZodIntersection=Rt,Rt.create=(m,s,c)=>new Rt({left:m,right:s,typeName:G.ZodIntersection,...y(c)});class We extends b{_parse(s){const{status:c,ctx:d}=this._processInputParams(s);if(d.parsedType!==o.ZodParsedType.array)return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.array,received:d.parsedType}),a.INVALID;if(d.data.length<this._def.items.length)return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.INVALID;!this._def.rest&&d.data.length>this._def.items.length&&((0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.dirty());const _=[...d.data].map((R,k)=>{const $=this._def.items[k]||this._def.rest;return $?$._parse(new v(d,R,d.path,k)):null}).filter(R=>!!R);return d.common.async?Promise.all(_).then(R=>a.ParseStatus.mergeArray(c,R)):a.ParseStatus.mergeArray(c,_)}get items(){return this._def.items}rest(s){return new We({...this._def,rest:s})}}S.ZodTuple=We,We.create=(m,s)=>{if(!Array.isArray(m))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new We({items:m,typeName:G.ZodTuple,rest:null,...y(s)})};class At extends b{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(s){const{status:c,ctx:d}=this._processInputParams(s);if(d.parsedType!==o.ZodParsedType.object)return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.object,received:d.parsedType}),a.INVALID;const f=[],_=this._def.keyType,R=this._def.valueType;for(const k in d.data)f.push({key:_._parse(new v(d,k,d.path,k)),value:R._parse(new v(d,d.data[k],d.path,k)),alwaysSet:k in d.data});return d.common.async?a.ParseStatus.mergeObjectAsync(c,f):a.ParseStatus.mergeObjectSync(c,f)}get element(){return this._def.valueType}static create(s,c,d){return c instanceof b?new At({keyType:s,valueType:c,typeName:G.ZodRecord,...y(d)}):new At({keyType:J.create(),valueType:s,typeName:G.ZodRecord,...y(c)})}}S.ZodRecord=At;class es extends b{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(s){const{status:c,ctx:d}=this._processInputParams(s);if(d.parsedType!==o.ZodParsedType.map)return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.map,received:d.parsedType}),a.INVALID;const f=this._def.keyType,_=this._def.valueType,R=[...d.data.entries()].map(([k,$],j)=>({key:f._parse(new v(d,k,d.path,[j,"key"])),value:_._parse(new v(d,$,d.path,[j,"value"]))}));if(d.common.async){const k=new Map;return Promise.resolve().then(async()=>{for(const $ of R){const j=await $.key,ee=await $.value;if(j.status==="aborted"||ee.status==="aborted")return a.INVALID;(j.status==="dirty"||ee.status==="dirty")&&c.dirty(),k.set(j.value,ee.value)}return{status:c.value,value:k}})}else{const k=new Map;for(const $ of R){const j=$.key,ee=$.value;if(j.status==="aborted"||ee.status==="aborted")return a.INVALID;(j.status==="dirty"||ee.status==="dirty")&&c.dirty(),k.set(j.value,ee.value)}return{status:c.value,value:k}}}}S.ZodMap=es,es.create=(m,s,c)=>new es({valueType:s,keyType:m,typeName:G.ZodMap,...y(c)});class mt extends b{_parse(s){const{status:c,ctx:d}=this._processInputParams(s);if(d.parsedType!==o.ZodParsedType.set)return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.set,received:d.parsedType}),a.INVALID;const f=this._def;f.minSize!==null&&d.data.size<f.minSize.value&&((0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_small,minimum:f.minSize.value,type:"set",inclusive:!0,exact:!1,message:f.minSize.message}),c.dirty()),f.maxSize!==null&&d.data.size>f.maxSize.value&&((0,a.addIssueToContext)(d,{code:i.ZodIssueCode.too_big,maximum:f.maxSize.value,type:"set",inclusive:!0,exact:!1,message:f.maxSize.message}),c.dirty());const _=this._def.valueType;function R($){const j=new Set;for(const ee of $){if(ee.status==="aborted")return a.INVALID;ee.status==="dirty"&&c.dirty(),j.add(ee.value)}return{status:c.value,value:j}}const k=[...d.data.values()].map(($,j)=>_._parse(new v(d,$,d.path,j)));return d.common.async?Promise.all(k).then($=>R($)):R(k)}min(s,c){return new mt({...this._def,minSize:{value:s,message:u.errorUtil.toString(c)}})}max(s,c){return new mt({...this._def,maxSize:{value:s,message:u.errorUtil.toString(c)}})}size(s,c){return this.min(s,c).max(s,c)}nonempty(s){return this.min(1,s)}}S.ZodSet=mt,mt.create=(m,s)=>new mt({valueType:m,minSize:null,maxSize:null,typeName:G.ZodSet,...y(s)});class It extends b{constructor(){super(...arguments),this.validate=this.implement}_parse(s){const{ctx:c}=this._processInputParams(s);if(c.parsedType!==o.ZodParsedType.function)return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.function,received:c.parsedType}),a.INVALID;function d(k,$){return(0,a.makeIssue)({data:k,path:c.path,errorMaps:[c.common.contextualErrorMap,c.schemaErrorMap,(0,h.getErrorMap)(),h.defaultErrorMap].filter(j=>!!j),issueData:{code:i.ZodIssueCode.invalid_arguments,argumentsError:$}})}function f(k,$){return(0,a.makeIssue)({data:k,path:c.path,errorMaps:[c.common.contextualErrorMap,c.schemaErrorMap,(0,h.getErrorMap)(),h.defaultErrorMap].filter(j=>!!j),issueData:{code:i.ZodIssueCode.invalid_return_type,returnTypeError:$}})}const _={errorMap:c.common.contextualErrorMap},R=c.data;if(this._def.returns instanceof Tt){const k=this;return(0,a.OK)(async function(...$){const j=new i.ZodError([]),ee=await k._def.args.parseAsync($,_).catch(_s=>{throw j.addIssue(d($,_s)),j}),De=await Reflect.apply(R,this,ee);return await k._def.returns._def.type.parseAsync(De,_).catch(_s=>{throw j.addIssue(f(De,_s)),j})})}else{const k=this;return(0,a.OK)(function(...$){const j=k._def.args.safeParse($,_);if(!j.success)throw new i.ZodError([d($,j.error)]);const ee=Reflect.apply(R,this,j.data),De=k._def.returns.safeParse(ee,_);if(!De.success)throw new i.ZodError([f(ee,De.error)]);return De.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...s){return new It({...this._def,args:We.create(s).rest(ve.create())})}returns(s){return new It({...this._def,returns:s})}implement(s){return this.parse(s)}strictImplement(s){return this.parse(s)}static create(s,c,d){return new It({args:s||We.create([]).rest(ve.create()),returns:c||ve.create(),typeName:G.ZodFunction,...y(d)})}}S.ZodFunction=It;class Mt extends b{get schema(){return this._def.getter()}_parse(s){const{ctx:c}=this._processInputParams(s);return this._def.getter()._parse({data:c.data,path:c.path,parent:c})}}S.ZodLazy=Mt,Mt.create=(m,s)=>new Mt({getter:m,typeName:G.ZodLazy,...y(s)});class Lt extends b{_parse(s){if(s.data!==this._def.value){const c=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(c,{received:c.data,code:i.ZodIssueCode.invalid_literal,expected:this._def.value}),a.INVALID}return{status:"valid",value:s.data}}get value(){return this._def.value}}S.ZodLiteral=Lt,Lt.create=(m,s)=>new Lt({value:m,typeName:G.ZodLiteral,...y(s)});function Ys(m,s){return new it({values:m,typeName:G.ZodEnum,...y(s)})}class it extends b{constructor(){super(...arguments),t.set(this,void 0)}_parse(s){if(typeof s.data!="string"){const c=this._getOrReturnCtx(s),d=this._def.values;return(0,a.addIssueToContext)(c,{expected:o.util.joinValues(d),received:c.parsedType,code:i.ZodIssueCode.invalid_type}),a.INVALID}if(r(this,t,"f")||e(this,t,new Set(this._def.values),"f"),!r(this,t,"f").has(s.data)){const c=this._getOrReturnCtx(s),d=this._def.values;return(0,a.addIssueToContext)(c,{received:c.data,code:i.ZodIssueCode.invalid_enum_value,options:d}),a.INVALID}return(0,a.OK)(s.data)}get options(){return this._def.values}get enum(){const s={};for(const c of this._def.values)s[c]=c;return s}get Values(){const s={};for(const c of this._def.values)s[c]=c;return s}get Enum(){const s={};for(const c of this._def.values)s[c]=c;return s}extract(s,c=this._def){return it.create(s,{...this._def,...c})}exclude(s,c=this._def){return it.create(this.options.filter(d=>!s.includes(d)),{...this._def,...c})}}S.ZodEnum=it,t=new WeakMap,it.create=Ys;class Dt extends b{constructor(){super(...arguments),n.set(this,void 0)}_parse(s){const c=o.util.getValidEnumValues(this._def.values),d=this._getOrReturnCtx(s);if(d.parsedType!==o.ZodParsedType.string&&d.parsedType!==o.ZodParsedType.number){const f=o.util.objectValues(c);return(0,a.addIssueToContext)(d,{expected:o.util.joinValues(f),received:d.parsedType,code:i.ZodIssueCode.invalid_type}),a.INVALID}if(r(this,n,"f")||e(this,n,new Set(o.util.getValidEnumValues(this._def.values)),"f"),!r(this,n,"f").has(s.data)){const f=o.util.objectValues(c);return(0,a.addIssueToContext)(d,{received:d.data,code:i.ZodIssueCode.invalid_enum_value,options:f}),a.INVALID}return(0,a.OK)(s.data)}get enum(){return this._def.values}}S.ZodNativeEnum=Dt,n=new WeakMap,Dt.create=(m,s)=>new Dt({values:m,typeName:G.ZodNativeEnum,...y(s)});class Tt extends b{unwrap(){return this._def.type}_parse(s){const{ctx:c}=this._processInputParams(s);if(c.parsedType!==o.ZodParsedType.promise&&c.common.async===!1)return(0,a.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.promise,received:c.parsedType}),a.INVALID;const d=c.parsedType===o.ZodParsedType.promise?c.data:Promise.resolve(c.data);return(0,a.OK)(d.then(f=>this._def.type.parseAsync(f,{path:c.path,errorMap:c.common.contextualErrorMap})))}}S.ZodPromise=Tt,Tt.create=(m,s)=>new Tt({type:m,typeName:G.ZodPromise,...y(s)});class qe extends b{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===G.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(s){const{status:c,ctx:d}=this._processInputParams(s),f=this._def.effect||null,_={addIssue:R=>{(0,a.addIssueToContext)(d,R),R.fatal?c.abort():c.dirty()},get path(){return d.path}};if(_.addIssue=_.addIssue.bind(_),f.type==="preprocess"){const R=f.transform(d.data,_);if(d.common.async)return Promise.resolve(R).then(async k=>{if(c.value==="aborted")return a.INVALID;const $=await this._def.schema._parseAsync({data:k,path:d.path,parent:d});return $.status==="aborted"?a.INVALID:$.status==="dirty"||c.value==="dirty"?(0,a.DIRTY)($.value):$});{if(c.value==="aborted")return a.INVALID;const k=this._def.schema._parseSync({data:R,path:d.path,parent:d});return k.status==="aborted"?a.INVALID:k.status==="dirty"||c.value==="dirty"?(0,a.DIRTY)(k.value):k}}if(f.type==="refinement"){const R=k=>{const $=f.refinement(k,_);if(d.common.async)return Promise.resolve($);if($ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return k};if(d.common.async===!1){const k=this._def.schema._parseSync({data:d.data,path:d.path,parent:d});return k.status==="aborted"?a.INVALID:(k.status==="dirty"&&c.dirty(),R(k.value),{status:c.value,value:k.value})}else return this._def.schema._parseAsync({data:d.data,path:d.path,parent:d}).then(k=>k.status==="aborted"?a.INVALID:(k.status==="dirty"&&c.dirty(),R(k.value).then(()=>({status:c.value,value:k.value}))))}if(f.type==="transform")if(d.common.async===!1){const R=this._def.schema._parseSync({data:d.data,path:d.path,parent:d});if(!(0,a.isValid)(R))return R;const k=f.transform(R.value,_);if(k instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:c.value,value:k}}else return this._def.schema._parseAsync({data:d.data,path:d.path,parent:d}).then(R=>(0,a.isValid)(R)?Promise.resolve(f.transform(R.value,_)).then(k=>({status:c.value,value:k})):R);o.util.assertNever(f)}}S.ZodEffects=qe,S.ZodTransformer=qe,qe.create=(m,s,c)=>new qe({schema:m,typeName:G.ZodEffects,effect:s,...y(c)}),qe.createWithPreprocess=(m,s,c)=>new qe({schema:s,effect:{type:"preprocess",transform:m},typeName:G.ZodEffects,...y(c)});class He extends b{_parse(s){return this._getType(s)===o.ZodParsedType.undefined?(0,a.OK)(void 0):this._def.innerType._parse(s)}unwrap(){return this._def.innerType}}S.ZodOptional=He,He.create=(m,s)=>new He({innerType:m,typeName:G.ZodOptional,...y(s)});class at extends b{_parse(s){return this._getType(s)===o.ZodParsedType.null?(0,a.OK)(null):this._def.innerType._parse(s)}unwrap(){return this._def.innerType}}S.ZodNullable=at,at.create=(m,s)=>new at({innerType:m,typeName:G.ZodNullable,...y(s)});class xt extends b{_parse(s){const{ctx:c}=this._processInputParams(s);let d=c.data;return c.parsedType===o.ZodParsedType.undefined&&(d=this._def.defaultValue()),this._def.innerType._parse({data:d,path:c.path,parent:c})}removeDefault(){return this._def.innerType}}S.ZodDefault=xt,xt.create=(m,s)=>new xt({innerType:m,typeName:G.ZodDefault,defaultValue:typeof s.default=="function"?s.default:()=>s.default,...y(s)});class Ut extends b{_parse(s){const{ctx:c}=this._processInputParams(s),d={...c,common:{...c.common,issues:[]}},f=this._def.innerType._parse({data:d.data,path:d.path,parent:{...d}});return(0,a.isAsync)(f)?f.then(_=>({status:"valid",value:_.status==="valid"?_.value:this._def.catchValue({get error(){return new i.ZodError(d.common.issues)},input:d.data})})):{status:"valid",value:f.status==="valid"?f.value:this._def.catchValue({get error(){return new i.ZodError(d.common.issues)},input:d.data})}}removeCatch(){return this._def.innerType}}S.ZodCatch=Ut,Ut.create=(m,s)=>new Ut({innerType:m,typeName:G.ZodCatch,catchValue:typeof s.catch=="function"?s.catch:()=>s.catch,...y(s)});class ts extends b{_parse(s){if(this._getType(s)!==o.ZodParsedType.nan){const d=this._getOrReturnCtx(s);return(0,a.addIssueToContext)(d,{code:i.ZodIssueCode.invalid_type,expected:o.ZodParsedType.nan,received:d.parsedType}),a.INVALID}return{status:"valid",value:s.data}}}S.ZodNaN=ts,ts.create=m=>new ts({typeName:G.ZodNaN,...y(m)}),S.BRAND=Symbol("zod_brand");class fs extends b{_parse(s){const{ctx:c}=this._processInputParams(s),d=c.data;return this._def.type._parse({data:d,path:c.path,parent:c})}unwrap(){return this._def.type}}S.ZodBranded=fs;class Pt extends b{_parse(s){const{status:c,ctx:d}=this._processInputParams(s);if(d.common.async)return(async()=>{const _=await this._def.in._parseAsync({data:d.data,path:d.path,parent:d});return _.status==="aborted"?a.INVALID:_.status==="dirty"?(c.dirty(),(0,a.DIRTY)(_.value)):this._def.out._parseAsync({data:_.value,path:d.path,parent:d})})();{const f=this._def.in._parseSync({data:d.data,path:d.path,parent:d});return f.status==="aborted"?a.INVALID:f.status==="dirty"?(c.dirty(),{status:"dirty",value:f.value}):this._def.out._parseSync({data:f.value,path:d.path,parent:d})}}static create(s,c){return new Pt({in:s,out:c,typeName:G.ZodPipeline})}}S.ZodPipeline=Pt;class Zt extends b{_parse(s){const c=this._def.innerType._parse(s),d=f=>((0,a.isValid)(f)&&(f.value=Object.freeze(f.value)),f);return(0,a.isAsync)(c)?c.then(f=>d(f)):d(c)}unwrap(){return this._def.innerType}}S.ZodReadonly=Zt,Zt.create=(m,s)=>new Zt({innerType:m,typeName:G.ZodReadonly,...y(s)});function Js(m,s){const c=typeof m=="function"?m(s):typeof m=="string"?{message:m}:m;return typeof c=="string"?{message:c}:c}function Xs(m,s={},c){return m?he.create().superRefine((d,f)=>{const _=m(d);if(_ instanceof Promise)return _.then(R=>{if(!R){const k=Js(s,d),$=k.fatal??c??!0;f.addIssue({code:"custom",...k,fatal:$})}});if(!_){const R=Js(s,d),k=R.fatal??c??!0;f.addIssue({code:"custom",...R,fatal:k})}}):he.create()}S.late={object:le.lazycreate};var G;(function(m){m.ZodString="ZodString",m.ZodNumber="ZodNumber",m.ZodNaN="ZodNaN",m.ZodBigInt="ZodBigInt",m.ZodBoolean="ZodBoolean",m.ZodDate="ZodDate",m.ZodSymbol="ZodSymbol",m.ZodUndefined="ZodUndefined",m.ZodNull="ZodNull",m.ZodAny="ZodAny",m.ZodUnknown="ZodUnknown",m.ZodNever="ZodNever",m.ZodVoid="ZodVoid",m.ZodArray="ZodArray",m.ZodObject="ZodObject",m.ZodUnion="ZodUnion",m.ZodDiscriminatedUnion="ZodDiscriminatedUnion",m.ZodIntersection="ZodIntersection",m.ZodTuple="ZodTuple",m.ZodRecord="ZodRecord",m.ZodMap="ZodMap",m.ZodSet="ZodSet",m.ZodFunction="ZodFunction",m.ZodLazy="ZodLazy",m.ZodLiteral="ZodLiteral",m.ZodEnum="ZodEnum",m.ZodEffects="ZodEffects",m.ZodNativeEnum="ZodNativeEnum",m.ZodOptional="ZodOptional",m.ZodNullable="ZodNullable",m.ZodDefault="ZodDefault",m.ZodCatch="ZodCatch",m.ZodPromise="ZodPromise",m.ZodBranded="ZodBranded",m.ZodPipeline="ZodPipeline",m.ZodReadonly="ZodReadonly"})(G||(S.ZodFirstPartyTypeKind=G={}));const Kn=(m,s={message:`Input not instance of ${m.name}`})=>Xs(c=>c instanceof m,s);S.instanceof=Kn;const er=J.create;S.string=er;const tr=re.create;S.number=tr;const Qn=ts.create;S.nan=Qn;const Yn=se.create;S.bigint=Yn;const sr=ue.create;S.boolean=sr;const Jn=Ne.create;S.date=Jn;const Xn=Le.create;S.symbol=Xn;const eo=Ze.create;S.undefined=eo;const to=ke.create;S.null=to;const so=he.create;S.any=so;const ro=ve.create;S.unknown=ro;const no=Ee.create;S.never=no;const oo=Qe.create;S.void=oo;const io=$e.create;S.array=io;const ao=le.create;S.object=ao;const co=le.strictCreate;S.strictObject=co;const lo=Ft.create;S.union=lo;const uo=Xt.create;S.discriminatedUnion=uo;const ho=Rt.create;S.intersection=ho;const mo=We.create;S.tuple=mo;const fo=At.create;S.record=fo;const _o=es.create;S.map=_o;const po=mt.create;S.set=po;const go=It.create;S.function=go;const vo=Mt.create;S.lazy=vo;const yo=Lt.create;S.literal=yo;const So=it.create;S.enum=So;const bo=Dt.create;S.nativeEnum=bo;const Eo=Tt.create;S.promise=Eo;const rr=qe.create;S.effect=rr,S.transformer=rr;const Co=He.create;S.optional=Co;const Io=at.create;S.nullable=Io;const To=qe.createWithPreprocess;S.preprocess=To;const No=Pt.create;S.pipeline=No;const ko=()=>er().optional();S.ostring=ko;const wo=()=>tr().optional();S.onumber=wo;const Oo=()=>sr().optional();return S.oboolean=Oo,S.coerce={string:m=>J.create({...m,coerce:!0}),number:m=>re.create({...m,coerce:!0}),boolean:m=>ue.create({...m,coerce:!0}),bigint:m=>se.create({...m,coerce:!0}),date:m=>Ne.create({...m,coerce:!0})},S.NEVER=a.INVALID,S}var Wr;function Hr(){return Wr||(Wr=1,function(r){var e=pt&&pt.__createBinding||(Object.create?function(n,i,h,u){u===void 0&&(u=h);var a=Object.getOwnPropertyDescriptor(i,h);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[h]}}),Object.defineProperty(n,u,a)}:function(n,i,h,u){u===void 0&&(u=h),n[u]=i[h]}),t=pt&&pt.__exportStar||function(n,i){for(var h in n)h!=="default"&&!Object.prototype.hasOwnProperty.call(i,h)&&e(i,n,h)};Object.defineProperty(r,"__esModule",{value:!0}),t(Ws(),r),t(qn(),r),t(xl(),r),t(ds(),r),t(Pl(),r),t(Vs(),r)}(pt)),pt}var Kr;function Qr(){return Kr||(Kr=1,function(r){var e=je&&je.__createBinding||(Object.create?function(u,a,o,v){v===void 0&&(v=o);var I=Object.getOwnPropertyDescriptor(a,o);(!I||("get"in I?!a.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(u,v,I)}:function(u,a,o,v){v===void 0&&(v=o),u[v]=a[o]}),t=je&&je.__setModuleDefault||(Object.create?function(u,a){Object.defineProperty(u,"default",{enumerable:!0,value:a})}:function(u,a){u.default=a}),n=je&&je.__importStar||function(u){if(u&&u.__esModule)return u;var a={};if(u!=null)for(var o in u)o!=="default"&&Object.prototype.hasOwnProperty.call(u,o)&&e(a,u,o);return t(a,u),a},i=je&&je.__exportStar||function(u,a){for(var o in u)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,u,o)};Object.defineProperty(r,"__esModule",{value:!0}),r.z=void 0;const h=n(Hr());r.z=h,i(Hr(),r),r.default=h}(je)),je}var Yr;function Ot(){return Yr||(Yr=1,function(r){var e=Xe&&Xe.__createBinding||(Object.create?function(h,u,a,o){o===void 0&&(o=a);var v=Object.getOwnPropertyDescriptor(u,a);(!v||("get"in v?!u.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return u[a]}}),Object.defineProperty(h,o,v)}:function(h,u,a,o){o===void 0&&(o=a),h[o]=u[a]}),t=Xe&&Xe.__exportStar||function(h,u){for(var a in h)a!=="default"&&!Object.prototype.hasOwnProperty.call(u,a)&&e(u,h,a)},n=Xe&&Xe.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(r,"__esModule",{value:!0});const i=n(Qr());t(Qr(),r),r.default=i.default}(Xe)),Xe}var Jr;function us(){return Jr||(Jr=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SocketUserSchema=r.PartialUserSchema=r.UserSchema=void 0;const e=Ot();r.UserSchema=e.z.object({id:e.z.string().uuid(),firstName:e.z.string().min(1),secondName:e.z.string().nullable(),thirdName:e.z.string().min(1),email:e.z.string().email().min(1),phone:e.z.string().min(1),avatarUrl:e.z.string().optional(),avatarCreateDate:e.z.union([e.z.string(),e.z.date()]).optional(),isDeleted:e.z.boolean()}),r.PartialUserSchema=r.UserSchema.pick({id:!0,firstName:!0,thirdName:!0,avatarUrl:!0}),r.SocketUserSchema=r.UserSchema.extend({sockets:e.z.any().optional()})}(Ns)),Ns}var Os={},Xr;function jn(){return Xr||(Xr=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NotifyWriteSchema=r.EditMessageSchema=r.MessageSchema=void 0;const e=Ot();r.MessageSchema=e.z.object({id:e.z.string().uuid(),userId:e.z.string().min(1),chatId:e.z.string().min(1),files:e.z.string().array().optional(),type:e.z.string().min(1),createDate:e.z.date().min(new Date("1980-01-01")),message:e.z.string().min(1),isRead:e.z.number().gte(0)}),r.EditMessageSchema=r.MessageSchema.pick({id:!0,type:!0,message:!0,files:!0}),r.NotifyWriteSchema=e.z.object({isWrite:e.z.boolean(),chatId:e.z.string().min(1),userName:e.z.string().min(1)})}(Os)),Os}var gt={},vt={},_e={},en;function Zl(){if(en)return _e;en=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.FileVarieties=_e.MessageReadStatus=_e.MessageTypes=_e.FriendsTab=_e.SocketActions=_e.HTTPErrorTypes=_e.HTTPStatuses=_e.ApiRoutes=void 0;var r;(function(o){o.checkHealth="/check-health",o.soundNotifications="/sound-notifications",o.deleteAccount="/delete-account",o.signUp="/sign-up",o.signIn="/sign-in",o.logout="/logout",o.getMe="/get-me",o.getUser="/get-user",o.editInfo="/edit-info",o.uploadAvatar="/upload-avatar",o.changeAvatar="/change-avatar",o.getPhotos="/get-photos",o.savePhotos="/save-photos",o.deletePhoto="/delete-photo",o.saveFiles="/save-files",o.openFile="/open-file",o.downloadFile="/download-file",o.deleteFiles="/delete-files",o.getAllCounts="/get-all-counts",o.getMyFriends="/get-my-friends",o.checkOnlineUser="/check-online-user",o.getFollowers="/get-followers",o.getBlockedFriends="/get-blocked-friends",o.getCommonFriends="/get-common-friends",o.getFriendInfo="/get-friend-info",o.getPossibleFriends="/get-possible-friends",o.followFriend="/follow-friend",o.getIncomingRequests="/get-incoming-requests",o.getOutgoingRequests="/get-outgoing-requests",o.unfollow="/unfollow",o.addFriend="/add-friend",o.leftInFollowers="/left-in-followers",o.acceptFriendRequest="/accept-friend-request",o.deleteFriend="/delete-friend",o.getFriendsNotification="/get-friends-notification",o.blockFriend="/block-friend",o.unblockFriend="/unblock-friend",o.checkBlockStatus="/check-block-status",o.getDialogs="/get-dialogs",o.deleteChat="/delete-chat",o.getMessages="/get-messages",o.saveMessage="/save-message",o.updateMessage="/update-message",o.deleteMessage="/delete-message",o.readMessage="/read-message",o.getChatId="/get-chat-id",o.getMessageNotification="/get-message-notification",o.getChatInfo="/get-chat-info",o.getUsersInChat="/get-users-in-chat",o.getLastSeen="/get-last-seen",o.getChatSoundStatus="/get-chat-sound-status",o.setChatSoundStatus="/set-chat-sound-status"})(r||(_e.ApiRoutes=r={}));var e;(function(o){o[o.OK=200]="OK",o[o.Created=201]="Created",o[o.NoContent=204]="NoContent",o[o.PermanentRedirect=308]="PermanentRedirect",o[o.BadRequest=400]="BadRequest",o[o.Unauthorized=401]="Unauthorized",o[o.Forbidden=403]="Forbidden",o[o.NotFound=404]="NotFound",o[o.Conflict=409]="Conflict",o[o.PayloadTooLarge=413]="PayloadTooLarge",o[o.TooManyRequests=429]="TooManyRequests",o[o.ServerError=500]="ServerError",o[o.ServiceUnavailable=503]="ServiceUnavailable"})(e||(_e.HTTPStatuses=e={}));var t;(function(o){o[o.SIGN_UP=1]="SIGN_UP",o[o.SIGN_IN=2]="SIGN_IN",o[o.EDIT_INFO=3]="EDIT_INFO"})(t||(_e.HTTPErrorTypes=t={}));var n;(function(o){o.GET_ALL_USERS="GET_ALL_USERS",o.GET_NEW_USER="GET_NEW_USER",o.USER_DISCONNECT="USER_DISCONNECT",o.LOG_OUT="LOG_OUT",o.ACCEPT_FRIEND="ACCEPT_FRIEND",o.FOLLOW_FRIEND="FOLLOW_FRIEND",o.ADD_OUTGOING_REQUEST="ADD_OUTGOING_REQUEST",o.UNFOLLOW_FRIEND="UNFOLLOW_FRIEND",o.REMOVE_OUTGOING_REQUEST="REMOVE_OUTGOING_REQUEST",o.ADD_TO_FRIEND="ADD_TO_FRIEND",o.REMOVE_FOLLOWER="REMOVE_FOLLOWER",o.ADD_FRIEND_REQUEST="ADD_FRIEND_REQUEST",o.REMOVE_FRIEND_REQUEST="REMOVE_FRIEND_REQUEST",o.REJECT_FRIEND_REQUEST="REJECT_FRIEND_REQUEST",o.ADD_TO_FOLLOWER="ADD_TO_FOLLOWER",o.DELETE_FRIEND="DELETE_FRIEND",o.DELETING_FRIEND="DELETING_FRIEND",o.BLOCK_FRIEND="BLOCK_FRIEND",o.BLOCKING_FRIEND="BLOCKING_FRIEND",o.UNBLOCK_FRIEND="UNBLOCK_FRIEND",o.UNBLOCKING_FRIEND="UNBLOCKING_FRIEND",o.MESSAGE="MESSAGE",o.SEND_MESSAGE="SEND_MESSAGE",o.EDIT_MESSAGE="EDIT_MESSAGE",o.SET_TEMP_CHAT="SET_TEMP_CHAT",o.GET_NEW_MESSAGE_ON_SERVER="GET_NEW_MESSAGE_ON_SERVER",o.ADD_NEW_MESSAGE="ADD_NEW_MESSAGE",o.NOTIFY_WRITE="NOTIFY_WRITE",o.CHANGE_READ_STATUS="CHANGE_READ_STATUS",o.ACCEPT_CHANGE_READ_STATUS="ACCEPT_CHANGE_READ_STATUS",o.DELETE_MESSAGE="DELETE_MESSAGE",o.DELETE_CHAT="DELETE_CHAT",o.SOCKET_CHANNEL_ERROR="SOCKET_CHANNEL_ERROR"})(n||(_e.SocketActions=n={}));var i;(function(o){o[o.ALL=0]="ALL",o[o.MY=1]="MY",o[o.ONLINE=2]="ONLINE",o[o.FOLLOWERS=3]="FOLLOWERS",o[o.OUTGOING_REQUESTS=4]="OUTGOING_REQUESTS",o[o.INCOMING_REQUESTS=5]="INCOMING_REQUESTS",o[o.SEARCH=6]="SEARCH",o[o.BLOCKED=7]="BLOCKED",o[o.COMMON=8]="COMMON"})(i||(_e.FriendsTab=i={}));var h;(function(o){o[o.MESSAGE=1]="MESSAGE",o[o.WITH_FILE=2]="WITH_FILE",o[o.VOICE=3]="VOICE",o[o.CALL=4]="CALL",o[o.FEW_FILES=5]="FEW_FILES"})(h||(_e.MessageTypes=h={}));var u;(function(o){o[o.NOT_READ=0]="NOT_READ",o[o.READ=1]="READ"})(u||(_e.MessageReadStatus=u={}));var a;return function(o){o.IMAGES="IMAGES",o.FILES="FILES"}(a||(_e.FileVarieties=a={})),_e}var Fs={},tn;function $l(){return tn||(tn=1,Object.defineProperty(Fs,"__esModule",{value:!0})),Fs}var sn;function hs(){return sn||(sn=1,function(r){var e=vt&&vt.__createBinding||(Object.create?function(n,i,h,u){u===void 0&&(u=h);var a=Object.getOwnPropertyDescriptor(i,h);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[h]}}),Object.defineProperty(n,u,a)}:function(n,i,h,u){u===void 0&&(u=h),n[u]=i[h]}),t=vt&&vt.__exportStar||function(n,i){for(var h in n)h!=="default"&&!Object.prototype.hasOwnProperty.call(i,h)&&e(i,n,h)};Object.defineProperty(r,"__esModule",{value:!0}),t(Zl(),r),t($l(),r)}(vt)),vt}var rn;function as(){if(rn)return gt;rn=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.serverToClientMessagesSchema=gt.clientToServerMessagesSchema=void 0;const r=hs(),e=Ot(),t=jn(),n=us();return gt.clientToServerMessagesSchema={[r.SocketActions.MESSAGE]:e.z.object({data:t.MessageSchema,usersInChat:e.z.array(n.PartialUserSchema)}),[r.SocketActions.DELETE_MESSAGE]:e.z.object({companionId:e.z.string().min(1),messageId:e.z.string().min(1)}),[r.SocketActions.DELETE_CHAT]:e.z.object({chatId:e.z.string().min(1),companionId:e.z.string().min(1)}),[r.SocketActions.EDIT_MESSAGE]:e.z.object({data:t.EditMessageSchema,usersInChat:e.z.array(n.PartialUserSchema)}),[r.SocketActions.CHANGE_READ_STATUS]:e.z.object({isRead:e.z.number().gte(0),messages:e.z.array(t.MessageSchema)}),[r.SocketActions.NOTIFY_WRITE]:e.z.object({isWrite:e.z.boolean(),chatId:e.z.string().min(1),usersInChat:e.z.array(n.PartialUserSchema)})},gt.serverToClientMessagesSchema={[r.SocketActions.SEND_MESSAGE]:e.z.object({message:t.MessageSchema}),[r.SocketActions.DELETE_MESSAGE]:e.z.object({messageId:e.z.string().min(1)}),[r.SocketActions.DELETE_CHAT]:e.z.object({chatId:e.z.string().min(1)}),[r.SocketActions.EDIT_MESSAGE]:e.z.object({data:t.EditMessageSchema}),[r.SocketActions.ACCEPT_CHANGE_READ_STATUS]:e.z.object({message:t.MessageSchema}),[r.SocketActions.NOTIFY_WRITE]:t.NotifyWriteSchema},gt}var Gt={},nn;function Hs(){if(nn)return Gt;nn=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.serverToClientUsersSchema=void 0;const r=hs(),e=Ot(),t=us();return Gt.serverToClientUsersSchema={[r.SocketActions.GET_ALL_USERS]:e.z.object({users:e.z.array(t.SocketUserSchema)}),[r.SocketActions.GET_NEW_USER]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.USER_DISCONNECT]:e.z.object({userId:e.z.string().min(1)}),[r.SocketActions.LOG_OUT]:e.z.object({}).optional()},Gt}var Vt={},on;function Ks(){if(on)return Vt;on=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.serverToClientFriendsSchema=void 0;const r=hs(),e=Ot(),t=us();return Vt.serverToClientFriendsSchema={[r.SocketActions.FOLLOW_FRIEND]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.ADD_OUTGOING_REQUEST]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.UNFOLLOW_FRIEND]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.REMOVE_OUTGOING_REQUEST]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.ADD_TO_FRIEND]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.REMOVE_FOLLOWER]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.ADD_FRIEND_REQUEST]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.REMOVE_FRIEND_REQUEST]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.REJECT_FRIEND_REQUEST]:e.z.object({userId:e.z.string()}),[r.SocketActions.ADD_TO_FOLLOWER]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.DELETE_FRIEND]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.DELETING_FRIEND]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.BLOCK_FRIEND]:e.z.object({userId:e.z.string()}),[r.SocketActions.BLOCKING_FRIEND]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.UNBLOCK_FRIEND]:e.z.object({user:t.SocketUserSchema}),[r.SocketActions.UNBLOCKING_FRIEND]:e.z.object({user:t.SocketUserSchema})},Vt}var Wt={},an;function Qs(){if(an)return Wt;an=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.serverToClientMainSchema=void 0;const r=hs(),e=Ot();return Wt.serverToClientMainSchema={[r.SocketActions.SOCKET_CHANNEL_ERROR]:e.z.object({message:e.z.string().min(1)})},Wt}var Be={},yt={},cn;function Bn(){if(cn)return yt;cn=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.handleServerEventSchemas=yt.emitServerEventSchemas=void 0;const r=Ks(),e=Qs(),t=as(),n=Hs(),i=as();return yt.emitServerEventSchemas={...e.serverToClientMainSchema,...n.serverToClientUsersSchema,...r.serverToClientFriendsSchema,...t.serverToClientMessagesSchema},yt.handleServerEventSchemas={...i.clientToServerMessagesSchema},yt}var St={},ln;function zn(){if(ln)return St;ln=1,Object.defineProperty(St,"__esModule",{value:!0}),St.handleClientEventSchemas=St.emitClientEventSchemas=void 0;const r=Ks(),e=Qs(),t=as(),n=Hs();return St.emitClientEventSchemas={...t.clientToServerMessagesSchema},St.handleClientEventSchemas={...n.serverToClientUsersSchema,...e.serverToClientMainSchema,...r.serverToClientFriendsSchema,...t.serverToClientMessagesSchema},St}var dn;function ql(){if(dn)return Be;dn=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.validateClientHandleEvent=Be.validateServerHandleEvent=Be.validateClientEmitEvent=Be.validateServerEmitEvent=void 0;const r=Bn(),e=zn(),t=(o,v)=>i(o,v,r.emitServerEventSchemas);Be.validateServerEmitEvent=t;const n=(o,v)=>(console.log(o,v,e.emitClientEventSchemas),i(o,v,e.emitClientEventSchemas));Be.validateClientEmitEvent=n;const i=(o,v,I)=>{const b=I[o].safeParse(v);if(!b.success)throw b.error.errors.map(C=>`${C.path.join(".")}: ${C.message}`).join(". ");return b.data},h=(o,v)=>a(o,v,r.handleServerEventSchemas);Be.validateServerHandleEvent=h;const u=(o,v)=>a(o,v,e.handleClientEventSchemas);Be.validateClientHandleEvent=u;const a=(o,v,I)=>{try{const b=I[o].safeParse(v);if(!b.success)throw b.error.errors.map(C=>`${C.path.join(".")}: ${C.message}`).join(". ");return{success:!0}}catch(y){return{success:!1,message:(y instanceof Error?y:new Error(y)).message}}};return Be}var un;function jl(){return un||(un=1,function(r){var e=_t&&_t.__createBinding||(Object.create?function(n,i,h,u){u===void 0&&(u=h);var a=Object.getOwnPropertyDescriptor(i,h);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[h]}}),Object.defineProperty(n,u,a)}:function(n,i,h,u){u===void 0&&(u=h),n[u]=i[h]}),t=_t&&_t.__exportStar||function(n,i){for(var h in n)h!=="default"&&!Object.prototype.hasOwnProperty.call(i,h)&&e(i,n,h)};Object.defineProperty(r,"__esModule",{value:!0}),t(us(),r),t(jn(),r),t(as(),r),t(Hs(),r),t(Ks(),r),t(Qs(),r),t(ql(),r),t(Bn(),r),t(zn(),r)}(_t)),_t}var Gn=jl();const Bl=(r,e)=>{try{return Gn.validateClientEmitEvent(r,e)}catch(t){throw(t instanceof Error?t:new Error(t)).message}},ie=(r,e)=>Gn.validateClientHandleEvent(r,e);function ae(r,e,t){const n=r.success?{success:!0,timestamp:Date.now()}:{success:!1,message:r.message};e(n),t&&t()}const ye=ge.init("Socket:FriendsController");class zl{constructor(e,t){this._socket=e,this._profilesController=t,this._friendsController=this._profilesController.getProfile().userService.friendsService.friendsController,this._init()}_friendsController;_init(){this._socket.on(p.SocketActions.FOLLOW_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.FOLLOW_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.FOLLOW_FRIEND"),this._friendsController.incomingRequests.add(oe(e)),this._friendsController.incomingRequests.syncStore(),A.getState().addFriendsNotification(),this._friendsController.searchFriends.remove(e.id),this._friendsController.searchFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.ADD_OUTGOING_REQUEST,({user:e},t)=>{const n=ie(p.SocketActions.ADD_OUTGOING_REQUEST,{user:e});n.success&&(ye.debug("SocketActions.ADD_OUTGOING_REQUEST"),this._friendsController.outgoingRequests.add(oe(e)),this._friendsController.outgoingRequests.syncStore(),this._friendsController.searchFriends.remove(e.id),this._friendsController.searchFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.UNFOLLOW_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.UNFOLLOW_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.UNFOLLOW_FRIEND"),this._friendsController.incomingRequests.remove(e.id),this._friendsController.incomingRequests.syncStore(),this._friendsController.followers.remove(e.id),this._friendsController.followers.syncStore(),A.getState().removeFriendsNotification(),this._friendsController.searchFriends.add(oe(e)),this._friendsController.searchFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.REMOVE_OUTGOING_REQUEST,({user:e},t)=>{const n=ie(p.SocketActions.REMOVE_OUTGOING_REQUEST,{user:e});n.success&&(ye.debug("SocketActions.REMOVE_OUTGOING_REQUEST"),this._friendsController.outgoingRequests.remove(e.id),this._friendsController.outgoingRequests.syncStore(),this._friendsController.searchFriends.add(oe(e)),this._friendsController.searchFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.ADD_TO_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.ADD_TO_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.ADD_TO_FRIEND"),this._friendsController.outgoingRequests.remove(e.id),this._friendsController.outgoingRequests.syncStore(),this._friendsController.myFriends.add(oe(e)),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.add(oe(e)),this._friendsController.onlineFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.REMOVE_FOLLOWER,({user:e},t)=>{const n=ie(p.SocketActions.REMOVE_FOLLOWER,{user:e});n.success&&(ye.debug("SocketActions.REMOVE_FOLLOWER"),this._friendsController.followers.remove(e.id),this._friendsController.followers.syncStore(),this._friendsController.myFriends.add(oe(e)),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.add(oe(e)),this._friendsController.onlineFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.ADD_FRIEND_REQUEST,({user:e},t)=>{const n=ie(p.SocketActions.ADD_FRIEND_REQUEST,{user:e});n.success&&(ye.debug("SocketActions.ADD_FRIEND_REQUEST"),this._friendsController.outgoingRequests.remove(e.id),this._friendsController.outgoingRequests.syncStore(),this._friendsController.myFriends.add(oe(e)),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.add(oe(e)),this._friendsController.onlineFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.REMOVE_FRIEND_REQUEST,({user:e},t)=>{const n=ie(p.SocketActions.REMOVE_FRIEND_REQUEST,{user:e});n.success&&(ye.debug("SocketActions.REMOVE_FRIEND_REQUEST"),this._friendsController.incomingRequests.remove(e.id),this._friendsController.incomingRequests.syncStore(),A.getState().removeFriendsNotification(),this._friendsController.myFriends.add(oe(e)),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.add(oe(e)),this._friendsController.onlineFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.REJECT_FRIEND_REQUEST,({userId:e},t)=>{const n=ie(p.SocketActions.REJECT_FRIEND_REQUEST,{userId:e});n.success&&(ye.debug("SocketActions.REJECT_FRIEND_REQUEST"),X.getState().setSnackbarError("Ваша заявка в друзья была отклонена пользователем"+e)),ae(n,t)}),this._socket.on(p.SocketActions.ADD_TO_FOLLOWER,({user:e},t)=>{const n=ie(p.SocketActions.ADD_TO_FOLLOWER,{user:e});n.success&&(ye.debug("SocketActions.ADD_TO_FOLLOWER"),this._friendsController.incomingRequests.remove(e.id),this._friendsController.incomingRequests.syncStore(),A.getState().removeFriendsNotification(),this._friendsController.followers.add(oe(e)),this._friendsController.followers.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.DELETE_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.DELETE_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.DELETE_FRIEND"),this._friendsController.myFriends.remove(e.id),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.remove(e.id),this._friendsController.onlineFriends.syncStore(),this._friendsController.outgoingRequests.add(oe(e)),this._friendsController.outgoingRequests.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.DELETING_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.DELETING_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.DELETING_FRIEND"),this._friendsController.myFriends.remove(e.id),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.remove(e.id),this._friendsController.onlineFriends.syncStore(),this._friendsController.followers.add(oe(e)),this._friendsController.followers.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.BLOCK_FRIEND,({userId:e},t)=>{const n=ie(p.SocketActions.BLOCK_FRIEND,{userId:e});n.success&&(ye.debug("SocketActions.BLOCK_FRIEND"),this._friendsController.myFriends.remove(e),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.remove(e),this._friendsController.onlineFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.BLOCKING_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.BLOCKING_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.BLOCKING_FRIEND"),this._friendsController.myFriends.remove(e.id),this._friendsController.myFriends.syncStore(),this._friendsController.onlineFriends.remove(e.id),this._friendsController.onlineFriends.syncStore(),this._friendsController.blockedUsers.add(oe(e)),this._friendsController.blockedUsers.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.UNBLOCK_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.UNBLOCK_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.UNBLOCK_FRIEND"),this._friendsController.searchFriends.add(oe(e)),this._friendsController.searchFriends.syncStore()),ae(n,t)}),this._socket.on(p.SocketActions.UNBLOCKING_FRIEND,({user:e},t)=>{const n=ie(p.SocketActions.UNBLOCKING_FRIEND,{user:e});n.success&&(ye.debug("SocketActions.UNBLOCKING_FRIEND"),this._friendsController.blockedUsers.remove(e.id),this._friendsController.blockedUsers.syncStore(),this._friendsController.searchFriends.add(oe(e)),this._friendsController.searchFriends.syncStore()),ae(n,t)})}}const kt=ge.init("Socket:MessagesController");class Gl{constructor(e){this._socket=e,this._init()}_init(){this._socket.on(p.SocketActions.SEND_MESSAGE,({message:e},t)=>{const n=ie(p.SocketActions.SEND_MESSAGE,{message:e});n.success&&(kt.debug(`SocketActions.SEND_MESSAGE [messageId=${e.id}]`),e&&(window.location.pathname.toLowerCase(),Y.messages+""+e.chatId.toLowerCase())),ae(n,t)}),this._socket.on(p.SocketActions.ACCEPT_CHANGE_READ_STATUS,({message:e},t)=>{const n=ie(p.SocketActions.ACCEPT_CHANGE_READ_STATUS,{message:e});n.success&&(kt.debug(`SocketActions.ACCEPT_CHANGE_READ_STATUS [messageId=${e.id}]`),e&&(window.location.pathname.toLowerCase(),Y.messages+""+e.chatId.toLowerCase())),ae(n,t)}),this._socket.on(p.SocketActions.DELETE_MESSAGE,({messageId:e},t)=>{const n=ie(p.SocketActions.DELETE_MESSAGE,{messageId:e});n.success&&kt.debug(`SocketActions.DELETE_MESSAGE [messageId=${e}]`),ae(n,t)}),this._socket.on(p.SocketActions.DELETE_CHAT,({chatId:e},t)=>{const n=ie(p.SocketActions.DELETE_CHAT,{chatId:e});n.success&&(kt.debug(`SocketActions.DELETE_CHAT [chatId=${e}]`),window.location.pathname.toLowerCase()===Y.messages+"/"+e.toLowerCase()&&lt.getState().setRedirectTo(Y.messages)),ae(n,t)}),this._socket.on(p.SocketActions.EDIT_MESSAGE,({data:e},t)=>{const n=ie(p.SocketActions.EDIT_MESSAGE,{data:e});n.success&&kt.debug(`SocketActions.EDIT_MESSAGE [data=${e}]`),ae(n,t)}),this._socket.on(p.SocketActions.NOTIFY_WRITE,({isWrite:e,chatId:t,userName:n},i)=>{const h=ie(p.SocketActions.NOTIFY_WRITE,{isWrite:e,chatId:t,userName:n});h.success&&kt.debug(`SocketActions.NOTIFY_WRITE [isWrite=${e}, chatId=${t}, userName=${n}]`),ae(h,i)})}}const Ht=ge.init("Socket:UsersController");class Vl{constructor(e,t,n){this._socket=e,this._myId=t,this._profilesController=n,this._init()}_init(){this._socket.on(p.SocketActions.GET_ALL_USERS,({users:e},t)=>{const n=ie(p.SocketActions.GET_ALL_USERS,{users:e});if(n.success){Ht.info(`${g.t("core.socket.online_users")} [users=${JSON.stringify(e)}]`);const i=e.filter(h=>h&&h.id!==this._myId);i.length&&(lt.getState().setOnlineUsers(i),this._profilesController.getProfile().userService.friendsService.checkOnlineUsers(i))}ae(n,t)}),this._socket.on(p.SocketActions.GET_NEW_USER,({user:e},t)=>{const n=ie(p.SocketActions.GET_NEW_USER,{user:e});n.success&&(Ht.info(`${g.t("core.socket.new_user_connected")} [user=${JSON.stringify(e)}]`),lt.getState().addOnlineUsers(e),this._profilesController.getProfile().userService.friendsService.checkOnlineUsers([e])),ae(n,t)}),this._socket.on(p.SocketActions.USER_DISCONNECT,({userId:e},t)=>{const n=ie(p.SocketActions.USER_DISCONNECT,{userId:e});n.success&&(Ht.info(`${g.t("core.socket.user_disconnected")} [userId=${e}]`),lt.getState().deleteOnlineUser(e),this._profilesController.getProfile().userService.friendsService.removeOnlineUser(e)),ae(n,t)}),this._socket.on(p.SocketActions.LOG_OUT,(e,t)=>{const n=ie(p.SocketActions.LOG_OUT);n.success&&(Ht.debug(g.t("core.socket.user_disconnected")),Pn(),this._profilesController.removeProfile()),ae(n,t,()=>{n.success&&this._disconnect()})})}_disconnect(){Ht.debug("disconnect"),this._socket.disconnect()}}const st=ge.init("SocketController"),Wl="io server disconnect";class Hl{constructor(e,t,n){this._socket=e,this._myId=t,this._profilesController=n,this._init(),this._socketManagerListeners(),new Vl(this._socket,this._myId,this._profilesController),new zl(this._socket,this._profilesController),new Gl(this._socket)}_init(){this._socket.on("connect",()=>{this._socket.recovered?st.info(g.t("core.socket.connection_successfully_recovered",{socketId:this._socket.id})):st.info(g.t("core.socket.connection_established",{socketId:this._socket.id}))}),this._socket.on(p.SocketActions.SOCKET_CHANNEL_ERROR,({message:e},t)=>{X.getState().setSnackbarError(e),t({success:!0,timestamp:Date.now()})}),this._socket.on("connect_error",e=>{const t=this._socket.active;if(st.error(g.t("core.socket.error.connect_error",{isSocketActive:t,message:e.message})),!t&&e.message!==Gi){this._manualReconnect();return}}),this._socket.on("disconnect",e=>{const t=this._socket.active;st.debug(`disconnect [isSocketActive=${t}, reason=${e}]`),!t&&e===Wl&&this._manualReconnect()})}_socketManagerListeners(){this._socket.io.on("error",e=>{X.getState().setError(g.t("core.socket.error.connect_error",{isSocketActive:this._socket.active,message:e.message}))}),this._socket.io.on("ping",()=>{st.debug("pong sent to server")}),this._socket.io.on("reconnect",e=>{st.info(`successfully reconnected after ${e} attempts`)}),this._socket.io.on("reconnect_attempt",e=>{st.info(`reconnecting attempts number: ${e}...`)}),this._socket.io.on("reconnect_error",e=>{st.info(`reconnecting failed with error: ${e}`)}),this._socket.io.on("reconnect_failed",()=>{X.getState().setError(g.t("core.socket.error.reconnect_failed"))})}_manualReconnect(){st.debug("_manualReconnect"),this._socket.auth={userId:this._myId},this._socket.connect()}}const ns=ge.init("Socket");class Kl{constructor(e){this._profilesController=e}_socket;_myId;init(e){if(ns.debug(`init [userId=${e}]`),this._myId=e,!this._myId){X.getState().setError(g.t("core.socket.error.user_not_exists"));return}this._socket=bi(Mi,{transports:["websocket"],autoConnect:!1,reconnection:!0,reconnectionAttempts:Ui,reconnectionDelay:Pi,forceNew:!1,upgrade:!0,closeOnBeforeunload:!0,withCredentials:!0}),ns.debug("_connect"),this._socket.auth={userId:this._myId},this._socket.connect(),new Hl(this._socket,this._myId,this._profilesController)}async send(e,...t){try{if(Bl(e,t[0])){const{success:i,message:h,timestamp:u}=await this._socket.timeout(Zi).emitWithAck(e,...t);if(!i)throw g.t("core.socket.error.emit_event_on_the_server",{message:h,timestamp:u});ns.debug(g.t("core.socket.emit_handled",{type:e,timestamp:u}))}}catch(n){X.getState().setError(g.t("core.socket.error.emit",{type:e,message:n}))}}disconnect(){ns.debug("disconnect"),this._socket.disconnect()}}const hn=ge.init();class Ql{_request;_catchErrors;_profilesController;_mainApi;_socket;constructor(){hn.debug("init"),this._catchErrors=new pl,this._request=new Dl(this._catchErrors),this._profilesController=new Ml(this._request),this._socket=new Kl(this._profilesController),this._mainApi=new Ll(this._request,this._profilesController,this._socket)}get mainApi(){return this._mainApi}getProfile(e){return this._profilesController.getProfile(e)}existProfile(e){return this._profilesController.checkProfile(e)}lifeTimeExpire(){this._profilesController.getMyProfileId()&&this._profilesController.removeProfile()}removeProfile(){this._profilesController.removeProfile()}downloadLogFile(){hn.downloadToFile()}}const Vn=new Ql,Wn=E.createContext(Vn);function Yl(){return l(Wn.Provider,{value:Vn,children:l(dl,{})})}const Hn=document.getElementById("root");if(!Hn)throw new Error("The root element is not found");Ei.createRoot(Hn).render(l(yi,{children:l(Yl,{})}));export{aa as d,oa as r};
